<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>è´ºé¾™é£çš„çŸ¥è¯†åº“</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2018-01-01T07:26:34.237Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>è´ºé¾™é£</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>æ¦‚è¿°</title>
    <link href="http://yoursite.com/1-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/%E6%A6%82%E8%BF%B0/"/>
    <id>http://yoursite.com/1-åŸºç¡€çŸ¥è¯†/æ•°æ®ç»“æ„ä¸ç®—æ³•/æ¦‚è¿°/</id>
    <published>2017-12-31T10:16:00.000Z</published>
    <updated>2018-01-01T07:26:34.237Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h1><blockquote><p>æ•°æ®ç»“æ„æ˜¯ç›¸äº’ä¹‹é—´å­˜åœ¨ä¸€ç§æˆ–å¤šç§å®šå…³ç³»çš„æ•°æ®å…ƒç´ çš„é›†åˆã€‚</p></blockquote><h2 id="ç»„æˆ"><a href="#ç»„æˆ" class="headerlink" title="ç»„æˆ"></a>ç»„æˆ</h2><p><img src="/images/2017/12/31/ç»„æˆ.png" alt="ç»„æˆ"></p><p>æ³¨æ„ï¼š</p><ul><li>æ•°æ®é¡¹æ˜¯æ•°æ®çš„æœ€å°å•å…ƒ</li><li>æ•°æ®å…ƒç´ æ˜¯è®¨è®ºé—®é¢˜æ—¶åœ¨æ•°æ®ç»“æ„ä¸­å»ºç«‹æ•°æ®æ¨¡å‹çš„ç€çœ¼ç‚¹</li></ul><h2 id="åˆ†ç±»"><a href="#åˆ†ç±»" class="headerlink" title="åˆ†ç±»"></a>åˆ†ç±»</h2><h3 id="é€»è¾‘ç»“æ„"><a href="#é€»è¾‘ç»“æ„" class="headerlink" title="é€»è¾‘ç»“æ„"></a>é€»è¾‘ç»“æ„</h3><blockquote><p>é€»è¾‘ç»“æ„ï¼šæ•°æ®å¯¹è±¡ä¸­æ•°æ®å…ƒç´ ä¹‹é—´çš„å…³ç³»ã€‚</p></blockquote><h4 id="é›†åˆç»“æ„"><a href="#é›†åˆç»“æ„" class="headerlink" title="é›†åˆç»“æ„"></a>é›†åˆç»“æ„</h4><p><img src="/images/2017/12/31/é›†åˆç»“æ„.png" alt="é›†åˆç»“æ„"><br>æ•°æ®å…ƒç´ åŒå±äºä¸€ä¸ªé›†åˆï¼Œäº’ç›¸ä¹‹é—´æ²¡æœ‰å…³ç³»ã€‚</p><h4 id="çº¿æ€§ç»“æ„"><a href="#çº¿æ€§ç»“æ„" class="headerlink" title="çº¿æ€§ç»“æ„"></a>çº¿æ€§ç»“æ„</h4><p><img src="/images/2017/12/31/çº¿æ€§ç»“æ„.png" alt="çº¿æ€§ç»“æ„"></p><p>æ•°æ®å…ƒç´ ä¹‹é—´æ˜¯ä¸€å¯¹ä¸€çš„å…³ç³»</p><h4 id="æ ‘æ€§ç»“æ„"><a href="#æ ‘æ€§ç»“æ„" class="headerlink" title="æ ‘æ€§ç»“æ„"></a>æ ‘æ€§ç»“æ„</h4><p><img src="/images/2017/12/31/æ ‘å½¢ç»“æ„.png" alt="æ ‘å½¢ç»“æ„"></p><p>æ•°æ®å…ƒç´ ä¹‹é—´æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»</p><h4 id="å›¾å½¢ç»“æ„"><a href="#å›¾å½¢ç»“æ„" class="headerlink" title="å›¾å½¢ç»“æ„"></a>å›¾å½¢ç»“æ„</h4><p><img src="/images/2017/12/31/å›¾å½¢ç»“æ„.png" alt="å›¾å½¢ç»“æ„"><br>æ•°æ®å…ƒç´ ä¹‹é—´æ˜¯å¤šå¯¹å¤šçš„å…³ç³»</p><h3 id="ç‰©ç†ç»“æ„"><a href="#ç‰©ç†ç»“æ„" class="headerlink" title="ç‰©ç†ç»“æ„"></a>ç‰©ç†ç»“æ„</h3><blockquote><p>ç‰©ç†ç»“æ„ï¼šæ•°æ®çš„é€»è¾‘ç»“æ„åœ¨è®¡ç®—æœºä¸­çš„å­˜å‚¨å½¢å¼ã€‚</p></blockquote><h4 id="é¡ºåºå­˜å‚¨ç»“æ„"><a href="#é¡ºåºå­˜å‚¨ç»“æ„" class="headerlink" title="é¡ºåºå­˜å‚¨ç»“æ„"></a>é¡ºåºå­˜å‚¨ç»“æ„</h4><p><img src="/images/2017/12/31/é¡ºåºå­˜å‚¨ç»“æ„.png" alt="é¡ºåºå­˜å‚¨ç»“æ„"></p><p>æ•°æ®å…ƒç´ æ”¾åœ¨åœ°å€è¿ç»­çš„å­˜å‚¨å•å…ƒé‡Œã€‚</p><h4 id="é“¾å¼å­˜å‚¨ç»“æ„"><a href="#é“¾å¼å­˜å‚¨ç»“æ„" class="headerlink" title="é“¾å¼å­˜å‚¨ç»“æ„"></a>é“¾å¼å­˜å‚¨ç»“æ„</h4><p><img src="/images/2017/12/31/é“¾å¼å­˜å‚¨ç»“æ„.png" alt="é“¾å¼å­˜å‚¨ç»“æ„"><br>æ•°æ®å…ƒç´ æ”¾åœ¨ä»»æ„ä½ç½®çš„å­˜å‚¨å•å…ƒé‡Œï¼›æ¯ä¸ªæ•°æ®å…ƒç´ éœ€è¦ä¸€ä¸ªé¢å¤–çš„æŒ‡å®šåœ°å€ã€‚</p><h1 id="ç®—æ³•"><a href="#ç®—æ³•" class="headerlink" title="ç®—æ³•"></a>ç®—æ³•</h1><blockquote><p>ç®—æ³•æ˜¯è§£å†³ç‰¹å®šé—®é¢˜æ±‚è§£æ­¥éª¤çš„æè¿°ï¼Œåœ¨è®¡ç®—æœºä¸­è¡¨ç°ä¸ºæŒ‡ä»¤çš„æœ‰é™åºåˆ—ï¼Œå¹¶ä¸”æ¯æ¡æŒ‡ä»¤è¡¨ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªæ“ä½œã€‚</p></blockquote><h2 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h2><ul><li>è¾“å…¥ï¼ˆ0ä¸ªæˆ–å¤šä¸ªï¼‰</li><li>è¾“å‡ºï¼ˆè‡³å°‘1ä¸ªï¼‰</li><li>æœ‰ç©·æ€§ï¼ˆåœ¨å¯æ¥å—çš„æ—¶é—´å†…æ‰§è¡Œå®Œæ¯•ï¼‰</li><li>ç¡®å®šæ€§ï¼ˆæ¯ä¸ªç®—æ³•æ­¥éª¤ä¸èƒ½æœ‰äºŒä¹‰æ€§ï¼‰</li><li>å¯è¡Œæ€§ï¼ˆæ¯ä¸ªç®—æ³•æ­¥éª¤éƒ½æ˜¯å®é™…å¯æ‰§è¡Œï¼Œè€Œä¸æ˜¯ç†è®ºå¯è¡Œï¼‰</li></ul><h2 id="è®¾è®¡çš„è¦æ±‚"><a href="#è®¾è®¡çš„è¦æ±‚" class="headerlink" title="è®¾è®¡çš„è¦æ±‚"></a>è®¾è®¡çš„è¦æ±‚</h2><h3 id="æ­£ç¡®æ€§"><a href="#æ­£ç¡®æ€§" class="headerlink" title="æ­£ç¡®æ€§"></a>æ­£ç¡®æ€§</h3><blockquote><p>æ­£ç¡®æ€§ï¼šç®—æ³•è‡³å°‘åº”è¯¥å…·æœ‰è¾“å…¥ã€è¾“å‡ºå’ŒåŠ å·¥å¤„ç†æ— æ­§ä¹‰ã€èƒ½æ­£ç¡®åæ˜ é—®é¢˜çš„éœ€æ±‚ã€èƒ½å¤Ÿå¾—åˆ°é—®é¢˜çš„æ­£ç¡®ç­”æ¡ˆã€‚</p></blockquote><p>ç®—æ³•ç¨‹åºçš„æ­£ç¡®ï¼Œå¤§ä½“åˆ†ä¸ºä»¥ä¸‹å››ä¸ªå±‚æ¬¡ï¼š</p><ol><li>æ²¡æœ‰è¯­æ³•é”™è¯¯</li><li>å¯¹åˆæ³•çš„è¾“å…¥æ•°æ®èƒ½å¤Ÿäº§ç”Ÿæ»¡è¶³è¦æ±‚çš„è¾“å‡ºç»“æœ</li><li>å¯¹éæ³•çš„è¾“å…¥æ•°æ®èƒ½å¤Ÿäº§ç”Ÿæ»¡è¶³è§„æ ¼è¯´æ˜çš„ç»“æœ</li><li>å¯¹ç²¾å¿ƒè®¾è®¡çš„æµ‹è¯•æ•°æ®æœ‰æ»¡è¶³è¦æ±‚çš„è¾“å‡ºç»“æœ</li></ol><p>å› ä¸ºæµ‹è¯•å±‚æ¬¡4çš„ä»£ä»·æ¯”è¾ƒæ˜‚è´µï¼›æ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æŠŠå±‚æ¬¡3ä½œä¸ºä¸€ä¸ªç®—æ³•æ˜¯å¦æ­£ç¡®çš„æ ‡å‡†ã€‚</p><h3 id="å¯è¯»æ€§"><a href="#å¯è¯»æ€§" class="headerlink" title="å¯è¯»æ€§"></a>å¯è¯»æ€§</h3><blockquote><p>å¯è¯»æ€§ï¼šç®—æ³•è®¾è®¡æ˜¯ä¸ºäº†æ–¹ä¾¿é˜…è¯»ã€ç†è§£å’Œäº¤æµã€‚</p></blockquote><h3 id="å¥å£®æ€§"><a href="#å¥å£®æ€§" class="headerlink" title="å¥å£®æ€§"></a>å¥å£®æ€§</h3><blockquote><p>å¥å£®æ€§ï¼šå½“è¾“å…¥æ•°æ®ä¸åˆæ³•æ—¶ï¼Œç®—æ³•ä¹Ÿèƒ½åšå‡ºç›¸å…³å¤„ç†ï¼Œè€Œä¸æ˜¯äº§ç”Ÿå¼‚å¸¸æˆ–è«åçš„ç»“æœã€‚</p></blockquote><h3 id="é«˜æ•ˆç‡ä½å­˜å‚¨"><a href="#é«˜æ•ˆç‡ä½å­˜å‚¨" class="headerlink" title="é«˜æ•ˆç‡ä½å­˜å‚¨"></a>é«˜æ•ˆç‡ä½å­˜å‚¨</h3><p>é«˜æ•ˆç‡ï¼šç®—æ³•çš„æ‰§è¡Œæ—¶é—´çŸ­<br>ä½å‚¨å­˜ï¼šç®—æ³•åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å ç”¨çš„å­˜å‚¨ç©ºé—´ä½</p><h2 id="æ•ˆç‡çš„åº¦é‡æ–¹æ³•"><a href="#æ•ˆç‡çš„åº¦é‡æ–¹æ³•" class="headerlink" title="æ•ˆç‡çš„åº¦é‡æ–¹æ³•"></a>æ•ˆç‡çš„åº¦é‡æ–¹æ³•</h2><h3 id="äº‹åç»Ÿè®¡æ–¹æ³•"><a href="#äº‹åç»Ÿè®¡æ–¹æ³•" class="headerlink" title="äº‹åç»Ÿè®¡æ–¹æ³•"></a>äº‹åç»Ÿè®¡æ–¹æ³•</h3><p>é€šè¿‡å®é™…æµ‹è¯•ä¸åŒç®—æ³•çš„è¿è¡Œæ—¶é—´æ¥æ¯”è¾ƒæ•ˆç‡çš„é«˜ä½ã€‚å› ä¸ºä¼šæœ‰ä¸å‡†ç¡®ï¼Œæˆæœ¬é«˜ç­‰ç¼ºç‚¹ï¼Œæ‰€ä»¥ä¸äºˆé‡‡çº³ã€‚</p><p>ä¸å‡†ç¡®ï¼šç¡¬ä»¶ä¸åŒã€æµ‹è¯•æ•°æ®çš„è§„æ¨¡ä¸åŒ<br>æˆæœ¬é«˜ï¼šéœ€è¦å®ç°å„ç§ç®—æ³•ã€è®¾è®¡æµ‹è¯•æ•°æ®</p><h3 id="äº‹å‰åˆ†æä¼°ç®—æ–¹æ³•"><a href="#äº‹å‰åˆ†æä¼°ç®—æ–¹æ³•" class="headerlink" title="äº‹å‰åˆ†æä¼°ç®—æ–¹æ³•"></a>äº‹å‰åˆ†æä¼°ç®—æ–¹æ³•</h3><p>ç»è¿‡åˆ†æï¼Œä¸€ä¸ªç¨‹åºçš„è¿è¡Œæ—¶é—´ï¼Œä¾èµ–äºç®—æ³•çš„å¥½åå’Œé—®é¢˜çš„è¾“å…¥è§„æ¨¡ã€‚è®¡ç®—å¯¹è¿è¡Œæ—¶é—´æœ‰æ¶ˆè€—çš„åŸºæœ¬æ“ä½œçš„æ‰§è¡Œæ¬¡æ•°ï¼Œå³å¯æµ‹å®šè¿è¡Œæ—¶é—´ã€‚</p><h4 id="ç†è®ºä¾æ®"><a href="#ç†è®ºä¾æ®" class="headerlink" title="ç†è®ºä¾æ®"></a>ç†è®ºä¾æ®</h4><p>é€šè¿‡å¯¹æ¯”ç®—æ³•çš„ã€Œ<strong>å…³é”®æ‰§è¡Œæ¬¡æ•°</strong>ã€çš„å‡½æ•°çš„æ¸è¿›å¢é•¿æ€§ï¼ŒåŸºæœ¬å¯ä»¥åˆ†æå‡ºï¼š<br>æŸä¸ªç®—æ³•ï¼Œéšç€ n çš„å¢å¤§ï¼Œå®ƒä¼šè¶Šæ¥è¶Šä¼˜äºå¦ä¸€ç®—æ³•ï¼Œæˆ–è€…è¶Šæ¥è¶Šå·®äºå¦ä¸€ç®—æ³•ã€‚(å‡½æ•°æ¸è¿›å¢é•¿)</p><h4 id="å¦‚ä½•åˆ¤æ–­ç®—æ³•çš„å¥½åï¼Ÿ"><a href="#å¦‚ä½•åˆ¤æ–­ç®—æ³•çš„å¥½åï¼Ÿ" class="headerlink" title="å¦‚ä½•åˆ¤æ–­ç®—æ³•çš„å¥½åï¼Ÿ"></a>å¦‚ä½•åˆ¤æ–­ç®—æ³•çš„å¥½åï¼Ÿ</h4><p>é€šå¸¸æˆ‘ä»¬ä½¿ç”¨ã€Œæ—¶é—´å¤æ‚åº¦ã€æ¥è€ƒæ ¸ä¸€ä¸ªç®—æ³•çš„å¥½åã€‚</p><h4 id="å¤æ‚åº¦"><a href="#å¤æ‚åº¦" class="headerlink" title="å¤æ‚åº¦"></a>å¤æ‚åº¦</h4><h5 id="æ—¶é—´å¤æ‚åº¦"><a href="#æ—¶é—´å¤æ‚åº¦" class="headerlink" title="æ—¶é—´å¤æ‚åº¦"></a>æ—¶é—´å¤æ‚åº¦</h5><blockquote><p>ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ï¼Œä¹Ÿå°±æ˜¯ç®—æ³•çš„æ—¶é—´é‡åº¦ï¼Œè®¡ç®—å…¬å¼è®°ä½œï¼šT(n) = O(f(n))ï¼Œè¡¨ç¤ºéšç€ n çš„å¢å¤§ï¼Œç®—æ³•æ‰§è¡Œæ—¶é—´çš„å¢é•¿ç‡å’Œ f(n) çš„å¢é•¿ç‡ç›¸åŒï¼›å…¶ä¸­ n è¡¨ç¤ºé—®é¢˜è§„æ¨¡ï¼Œf(n) æ˜¯é—®é¢˜è§„æ¨¡çš„æŸä¸ªå‡½æ•°ã€‚</p></blockquote><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œéšç€ n çš„å¢å¤§ï¼ŒT(n) å¢é•¿æœ€æ…¢çš„ç®—æ³•ä¸ºæœ€ä¼˜ç®—æ³•ã€‚</p><h6 id="å¤æ‚åº¦çš„æ¸è¿›è¡¨ç¤ºæ³•"><a href="#å¤æ‚åº¦çš„æ¸è¿›è¡¨ç¤ºæ³•" class="headerlink" title="å¤æ‚åº¦çš„æ¸è¿›è¡¨ç¤ºæ³•"></a>å¤æ‚åº¦çš„æ¸è¿›è¡¨ç¤ºæ³•</h6><ul><li>T(n) = O(f(n)) è¡¨ç¤ºå­˜åœ¨å¸¸æ•° C&gt;0ï¼ŒN&gt;0 ä½¿å¾—å½“ n&gt;N æ—¶æœ‰ T(n) &lt;= C*f(n)</li><li>T(n) = â„¦(g(n)) è¡¨ç¤ºå­˜åœ¨å¸¸æ•° C&gt;0ï¼ŒN&gt;0 ä½¿å¾—å½“ n&gt;N æ—¶æœ‰ T(n) &gt;= C*g(n)</li><li>T(n) = ğš¯(h(n)) è¡¨ç¤ºåŒæ—¶æœ‰ T(n) = O(h(n)) å’Œ T(n) = â„¦(h(n))</li></ul><p>Oï¼šä¸Šç•Œ<br>â„¦ï¼šä¸‹ç•Œ<br>ğš¯ï¼šå³æ˜¯ä¸Šç•Œä¹Ÿæ˜¯ä¸‹ç•Œ</p><p>æ³¨æ„ï¼š<br>O é€šå¸¸æ˜¯æ‰¾æœ€å°çš„ä¸Šç•Œ<br>â„¦ é€šå¸¸æ˜¯æ‰¾æœ€å¤§çš„ä¸‹ç•Œ</p><h6 id="æ¨å¯¼å¤§-O-é˜¶çš„æ–¹æ³•"><a href="#æ¨å¯¼å¤§-O-é˜¶çš„æ–¹æ³•" class="headerlink" title="æ¨å¯¼å¤§ O é˜¶çš„æ–¹æ³•"></a>æ¨å¯¼å¤§ O é˜¶çš„æ–¹æ³•</h6><p>è·å–å¤§ O é˜¶ï¼š</p><ol><li>ç”¨å¸¸æ•° 1 å–ä»£è¿è¡Œæ—¶é—´ä¸­çš„æ‰€æœ‰åŠ æ³•å¸¸æ•°ã€‚</li><li>è¿è¡Œæ¬¡æ•°å‡½æ•°åªä¿ç•™æœ€é«˜é˜¶é¡¹</li><li>è‹¥æœ€é«˜é˜¶é¡¹å­˜åœ¨ä¸”ä¸æ˜¯1ï¼Œåˆ™å»é™¤ä¸å…¶ç›¸ä¹˜çš„å¸¸æ•°ã€‚</li><li>è‹¥ä¸¤æ®µç®—æ³•åˆ†åˆ«æœ‰å¤æ‚åº¦ T1(n) = O(f1(n)) å’Œ T2(n) = O(f2(n))åˆ™<ul><li>T1(n) + T2(n) = max(O(f1(n)),O(f2(n)))</li><li>T1(n) <em> T2(n) = O(f1(n) </em> f2(n))</li></ul></li><li>è‹¥ T(n) æ˜¯å…³äº n çš„ k é˜¶å¤šé¡¹å¼ï¼Œé‚£ä¹ˆ T(n) = ğš¯(n^k)</li><li>ä¸€ä¸ª for å¾ªç¯çš„æ—¶é—´å¤æ‚åº¦ç­‰äºå¾ªç¯æ¬¡æ•° * å¾ªç¯ä½“ä»£ç çš„å¤æ‚åº¦</li><li>if-else ç»“æ„çš„å¤æ‚åº¦å–å†³äº if çš„æ¡ä»¶åˆ¤æ–­å¤æ‚åº¦å’Œä¸¤ä¸ªåˆ†æ”¯éƒ¨åˆ†çš„å¤æ‚åº¦ï¼Œæ€»ä½“å¤æ‚åº¦å–ä¸‰è€…ä¸­æœ€å¤§</li></ol><p><img src="/images/2017/12/31/å¸¸è§æ—¶é—´å¤æ‚åº¦.png" alt="å¸¸è§æ—¶é—´å¤æ‚åº¦"></p><h6 id="æœ€åæƒ…å†µä¸å¹³å‡æƒ…å†µ"><a href="#æœ€åæƒ…å†µä¸å¹³å‡æƒ…å†µ" class="headerlink" title="æœ€åæƒ…å†µä¸å¹³å‡æƒ…å†µ"></a>æœ€åæƒ…å†µä¸å¹³å‡æƒ…å†µ</h6><p>æœ€åæƒ…å†µï¼šè¿è¡Œæ—¶é—´çš„æœ€åæƒ…å†µã€‚<br>å¹³å‡æƒ…å†µï¼šæœŸæœ›å¾—åˆ°çš„è¿è¡Œæ—¶é—´ï¼›æ— æ³•é€šè¿‡åˆ†æä¼°ç®—ï¼Œä¸€èˆ¬æ˜¯é€šè¿‡è¿è¡Œä¸€å®šæ•°é‡çš„æ•°æ®åä¼°ç®—å‡ºæ¥çš„ã€‚</p><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æåˆ°çš„è¿è¡Œæ—¶é—´éƒ½æ˜¯æŒ‡ï¼šæœ€åæ—¶é—´å¤æ‚åº¦ã€‚</p><h5 id="ç©ºé—´å¤æ‚åº¦"><a href="#ç©ºé—´å¤æ‚åº¦" class="headerlink" title="ç©ºé—´å¤æ‚åº¦"></a>ç©ºé—´å¤æ‚åº¦</h5><blockquote><p>ç®—æ³•çš„ç©ºé—´å¤æ‚åº¦é€šè¿‡è®¡ç®—ç®—æ³•æ‰€éœ€çš„å­˜å‚¨ç©ºé—´å®ç°ï¼Œç®—æ³•ç©ºé—´å¤æ‚åº¦çš„è®¡ç®—å…¬å¼è®°ä½œï¼šS(n) = O(f(n))ï¼Œå…¶ä¸­ n ä¸ºé—®é¢˜çš„è§„æ¨¡ï¼Œf(n) ä¸ºè¯­å¥å…³äº n æ‰€å å­˜å‚¨ç©ºé—´çš„å‡½æ•°ã€‚</p></blockquote><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li>ã€Šå¤§è¯æ•°æ®ç»“æ„ã€‹</li><li>ã€Šæµ™å¤§-æ•°æ®ç»“æ„ã€‹</li></ul><!--ä»¥ä¸‹æ˜¯è„šæ³¨-->]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;æ•°æ®ç»“æ„&quot;&gt;&lt;a href=&quot;#æ•°æ®ç»“æ„&quot; class=&quot;head
      
    
    </summary>
    
      <category term="1-åŸºç¡€çŸ¥è¯†" scheme="http://yoursite.com/categories/1-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
      <category term="æ•°æ®ç»“æ„ä¸ç®—æ³•" scheme="http://yoursite.com/categories/1-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"/>
    
    
      <category term="æ•°æ®ç»“æ„" scheme="http://yoursite.com/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
  </entry>
  
  <entry>
    <title>Lumené¡¹ç›®åˆå§‹åŒ–</title>
    <link href="http://yoursite.com/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E7%A8%8B%E5%BA%8F%E8%AF%AD%E8%A8%80/PHP/%E6%A1%86%E6%9E%B6/lumen%E9%A1%B9%E7%9B%AE%E5%88%9D%E5%A7%8B%E5%8C%96/"/>
    <id>http://yoursite.com/2-å¼€å‘æŠ€èƒ½/ç¨‹åºè¯­è¨€/PHP/æ¡†æ¶/lumené¡¹ç›®åˆå§‹åŒ–/</id>
    <published>2017-12-29T15:23:00.000Z</published>
    <updated>2017-12-29T16:02:30.233Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="å¼€å¯æ—¥å¿—"><a href="#å¼€å¯æ—¥å¿—" class="headerlink" title="å¼€å¯æ—¥å¿—"></a>å¼€å¯æ—¥å¿—</h1><p>åœ¨ <code>bootstrap/app.php</code> å†™å…¥ï¼š<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$app-&gt;configureMonologUsing(<span class="function"><span class="keyword">function</span><span class="params">($monolog)</span> </span>&#123;</span><br><span class="line">     $monolog-&gt;pushHandler(</span><br><span class="line">          <span class="keyword">new</span> \Monolog\Handler\RotatingFileHandler(</span><br><span class="line">               storage_path(<span class="string">'logs/data-entry.log'</span>),</span><br><span class="line">               env(<span class="string">'APP_LOG_MAX_FILES'</span>, <span class="number">30</span>),</span><br><span class="line">               constant(<span class="string">'\\Monolog\\Logger::'</span> . strtoupper(env(<span class="string">'APP_LOG_LEVEL'</span>, <span class="string">'debug'</span>)))</span><br><span class="line">          )</span><br><span class="line">     );</span><br><span class="line">     <span class="keyword">return</span> $monolog;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><h1 id="è°ƒè¯•ã€å¼‚å¸¸ã€é”™è¯¯ç "><a href="#è°ƒè¯•ã€å¼‚å¸¸ã€é”™è¯¯ç " class="headerlink" title="è°ƒè¯•ã€å¼‚å¸¸ã€é”™è¯¯ç "></a>è°ƒè¯•ã€å¼‚å¸¸ã€é”™è¯¯ç </h1><blockquote><p>è§laravelé¡¹ç›®åˆå§‹åŒ–</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;å¼€å¯æ—¥å¿—&quot;&gt;&lt;a href=&quot;#å¼€å¯æ—¥å¿—&quot; class=&quot;head
      
    
    </summary>
    
      <category term="2-å¼€å‘æŠ€èƒ½" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/"/>
    
      <category term="ç¨‹åºè¯­è¨€" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E7%A8%8B%E5%BA%8F%E8%AF%AD%E8%A8%80/"/>
    
      <category term="PHP" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E7%A8%8B%E5%BA%8F%E8%AF%AD%E8%A8%80/PHP/"/>
    
      <category term="æ¡†æ¶" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E7%A8%8B%E5%BA%8F%E8%AF%AD%E8%A8%80/PHP/%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="php" scheme="http://yoursite.com/tags/php/"/>
    
      <category term="Lumen" scheme="http://yoursite.com/tags/Lumen/"/>
    
  </entry>
  
  <entry>
    <title>Laravelé¡¹ç›®åˆå§‹åŒ–</title>
    <link href="http://yoursite.com/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E7%A8%8B%E5%BA%8F%E8%AF%AD%E8%A8%80/PHP/%E6%A1%86%E6%9E%B6/laravel%E9%A1%B9%E7%9B%AE%E5%88%9D%E5%A7%8B%E5%8C%96/"/>
    <id>http://yoursite.com/2-å¼€å‘æŠ€èƒ½/ç¨‹åºè¯­è¨€/PHP/æ¡†æ¶/laravelé¡¹ç›®åˆå§‹åŒ–/</id>
    <published>2017-12-29T15:10:00.000Z</published>
    <updated>2017-12-29T16:57:54.627Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="é…ç½®-PHPSTORM"><a href="#é…ç½®-PHPSTORM" class="headerlink" title="é…ç½® PHPSTORM"></a>é…ç½® PHPSTORM</h1><ol><li>å®‰è£… ide-helper : <a href="https://github.com/barryvdh/laravel-ide-helper" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/barryvdh/laravel-ide-helper</a></li><li>å®‰è£… phpstorm çš„ tools<ol><li>è¿›å…¥è®¾ç½® Preferences | Tools | Command Line Tool Support</li><li>é€‰æ‹© tool bases on Symfony console</li></ol></li></ol><h1 id="ç”Ÿäº§ç¯å¢ƒç›‘æ§"><a href="#ç”Ÿäº§ç¯å¢ƒç›‘æ§" class="headerlink" title="ç”Ÿäº§ç¯å¢ƒç›‘æ§"></a>ç”Ÿäº§ç¯å¢ƒç›‘æ§</h1><p>Sentry ï¼š<a href="https://sentry.io/for/laravel/" rel="external nofollow noopener noreferrer" target="_blank">https://sentry.io/for/laravel/</a></p><h1 id="ä¿®æ”¹æ—¶åŒº"><a href="#ä¿®æ”¹æ—¶åŒº" class="headerlink" title="ä¿®æ”¹æ—¶åŒº"></a>ä¿®æ”¹æ—¶åŒº</h1><p>ä¿®æ”¹ <code>config/app.php</code> ä¸­ <code>&#39;timezone&#39; =&gt; &#39;Asia/Shanghai&#39;,</code></p><h1 id="Web-åº”ç”¨"><a href="#Web-åº”ç”¨" class="headerlink" title="Web åº”ç”¨"></a>Web åº”ç”¨</h1><h2 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h2><p>php-debuger : <a href="https://github.com/barryvdh/laravel-debugbar" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/barryvdh/laravel-debugbar</a></p><h2 id="RBAC"><a href="#RBAC" class="headerlink" title="RBAC"></a>RBAC</h2><p>entrust: <a href="https://github.com/Zizaco/entrust" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/Zizaco/entrust</a></p><h1 id="Api-åº”ç”¨"><a href="#Api-åº”ç”¨" class="headerlink" title="Api åº”ç”¨"></a>Api åº”ç”¨</h1><h2 id="è°ƒè¯•-1"><a href="#è°ƒè¯•-1" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h2><p>clockwork : <a href="https://github.com/itsgoingd/clockwork" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/itsgoingd/clockwork</a></p><h2 id="å¼€å¯-SQL-æ—¥å¿—"><a href="#å¼€å¯-SQL-æ—¥å¿—" class="headerlink" title="å¼€å¯ SQL æ—¥å¿—"></a>å¼€å¯ SQL æ—¥å¿—</h2><p>å†™å…¥ï¼š<code>AppServiceProvider-&gt;boot()</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç›‘å¬è¿è¡Œçš„sql,å†™å…¥åˆ°logä¸­</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;app-&gt;environment() !== <span class="string">'production'</span>) &#123;</span><br><span class="line">    \DB::listen(</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="params">($sql)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">foreach</span> ($sql-&gt;bindings <span class="keyword">as</span> $i =&gt; $binding) &#123;</span><br><span class="line">                <span class="keyword">if</span> ($binding <span class="keyword">instanceof</span> \DateTime) &#123;</span><br><span class="line">                    $sql-&gt;bindings[$i] = $binding-&gt;format(<span class="string">'\'Y-m-d H:i:s\''</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (is_string($binding)) &#123;</span><br><span class="line">                        $sql-&gt;bindings[$i] = <span class="string">"'$binding'"</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// Insert bindings into query</span></span><br><span class="line">            $query = str_replace(<span class="keyword">array</span>(<span class="string">'%'</span>, <span class="string">'?'</span>), <span class="keyword">array</span>(<span class="string">'%%'</span>, <span class="string">'%s'</span>), $sql-&gt;sql);</span><br><span class="line">            $query = vsprintf($query, $sql-&gt;bindings);</span><br><span class="line">            <span class="comment">// Save the query to Log file</span></span><br><span class="line">            \Log::debug(<span class="string">'SQL'</span>, [$query]);</span><br><span class="line">        &#125;</span><br><span class="line">    );</span><br><span class="line">&#125; <span class="comment">// end_if</span></span><br></pre></td></tr></table></figure><h2 id="å…³é—­-Cookie"><a href="#å…³é—­-Cookie" class="headerlink" title="å…³é—­ Cookie"></a>å…³é—­ Cookie</h2><blockquote><p>api åº”ç”¨æ—¶ä½¿ç”¨ã€‚</p></blockquote><p>æ³¨é‡Šä»¥ä¸‹æ–‡ä»¶ä¸­çš„ cookie ç›¸å…³ï¼š</p><ol><li>app/Http/Kernel.php</li><li>config/app.php</li></ol><h2 id="Helper-å‡½æ•°"><a href="#Helper-å‡½æ•°" class="headerlink" title="Helper å‡½æ•°"></a>Helper å‡½æ•°</h2><p><code>app/Common/Helper.php</code>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å“åº”æˆåŠŸ</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> array $data</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> \Illuminate\Http\JsonResponse</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">success</span><span class="params">(array $data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">$json = [</span><br><span class="line"><span class="string">'statusCode'</span> =&gt; \App\Common\Status::Success,</span><br><span class="line"><span class="string">'message'</span>    =&gt; <span class="string">'ok'</span>,</span><br><span class="line"><span class="string">'data'</span>       =&gt; $data,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> response()-&gt;json($json);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å“åº”å¤±è´¥</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> array $errData</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> mixed $detail</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> \Illuminate\Http\JsonResponse</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fail</span><span class="params">(array $errData, $detail = null)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> ( ! <span class="keyword">isset</span>($errData[<span class="string">'errCode'</span>]) <span class="keyword">or</span> ! <span class="keyword">isset</span>($errData[<span class="string">'errMsg'</span>])) &#123;</span><br><span class="line">fail(\App\Common\Status::SystemError[<span class="string">'codeException'</span>]);</span><br><span class="line">&#125;</span><br><span class="line">$json = [</span><br><span class="line"><span class="string">'statusCode'</span> =&gt; $errData[<span class="string">'errCode'</span>],</span><br><span class="line"><span class="string">'message'</span>    =&gt; $errData[<span class="string">'errMsg'</span>],</span><br><span class="line">];</span><br><span class="line"><span class="keyword">if</span> (App::environment() != <span class="string">'production'</span>) &#123;</span><br><span class="line">$json[<span class="string">'detail'</span>] = $detail;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> response()-&gt;json($json);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é”™è¯¯ç "><a href="#é”™è¯¯ç " class="headerlink" title="é”™è¯¯ç "></a>é”™è¯¯ç </h2><p><code>app/Common/Status.php</code>ï¼š<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Common</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Status</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="keyword">const</span> Success = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 100 + 001</span></span><br><span class="line"><span class="keyword">const</span> SystemError = [</span><br><span class="line"><span class="string">'codeException'</span> =&gt; [</span><br><span class="line"><span class="string">'errCode'</span> =&gt; <span class="number">100001</span>,</span><br><span class="line"><span class="string">'errMsg'</span>  =&gt; <span class="string">'The format of errorCode was error'</span></span><br><span class="line">]</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 101 + 001</span></span><br><span class="line"><span class="keyword">const</span> ClientError = [</span><br><span class="line"><span class="string">'paramException'</span> =&gt; [</span><br><span class="line"><span class="string">'errCode'</span> =&gt; <span class="number">101001</span>,</span><br><span class="line"><span class="string">'errMsg'</span>  =&gt; <span class="string">'The given data was invalid'</span></span><br><span class="line">],</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 102 + 001</span></span><br><span class="line"><span class="keyword">const</span> Access = [</span><br><span class="line"><span class="string">'fail'</span>        =&gt; [</span><br><span class="line"><span class="string">'errCode'</span> =&gt; <span class="number">102001</span>,</span><br><span class="line"><span class="string">'errMsg'</span>  =&gt; <span class="string">'No access'</span></span><br><span class="line">],</span><br><span class="line"><span class="string">'noLogin'</span>     =&gt; [</span><br><span class="line"><span class="string">'errCode'</span> =&gt; <span class="number">102002</span>,</span><br><span class="line"><span class="string">'errMsg'</span>  =&gt; <span class="string">'Please login first'</span></span><br><span class="line">],</span><br><span class="line"><span class="string">'unknownUser'</span> =&gt; [</span><br><span class="line"><span class="string">'errCode'</span> =&gt; <span class="number">102003</span>,</span><br><span class="line"><span class="string">'errMsg'</span>  =&gt; <span class="string">'The user is not exist'</span></span><br><span class="line">],</span><br><span class="line">];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h2 id="å¼‚å¸¸å¤„ç†"><a href="#å¼‚å¸¸å¤„ç†" class="headerlink" title="å¼‚å¸¸å¤„ç†"></a>å¼‚å¸¸å¤„ç†</h2><p>æ³¨å†Œä¸¤ä¸ªå¼‚å¸¸ç±»ï¼š</p><ul><li>NormalException # é”™è¯¯ä¿¡æ¯å°è£…ä¸ºjson</li><li>EmailException  # å‘é€é‚®ä»¶</li></ul><p><code>NormalException</code>:<br><code>php artisan make:exception NormalException</code><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Exceptions</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Common</span>\<span class="title">Status</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Exception</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Throwable</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NormalException</span> <span class="keyword">extends</span> <span class="title">Exception</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="keyword">protected</span> $exception;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ResponseException constructor.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> array           $message</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int             $code</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> \Throwable|null $previous</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(array $message, int $code = <span class="number">0</span>, \Throwable $previous = null)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> ( ! <span class="keyword">isset</span>($message[<span class="string">'errMsg'</span>]) <span class="keyword">or</span> ! <span class="keyword">isset</span>($message[<span class="string">'errCode'</span>])) &#123;</span><br><span class="line"><span class="keyword">return</span> fail(Status::SystemError[<span class="string">'codeException'</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">$this</span>-&gt;exception = $message;</span><br><span class="line"></span><br><span class="line"><span class="keyword">parent</span>::__construct(<span class="keyword">$this</span>-&gt;exception[<span class="string">'errMsg'</span>], <span class="keyword">$this</span>-&gt;exception[<span class="string">'errCode'</span>], $previous);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è‡ªå®šä¹‰å¼‚å¸¸å“åº”</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $request</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> \Illuminate\Http\JsonResponse</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span><span class="params">($request)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> fail(<span class="keyword">$this</span>-&gt;exception);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><code>EmailException</code>:<br><code>php artisan make:exception EmailException</code><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Exceptions</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Common</span>\<span class="title">Status</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Exception</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">Facades</span>\<span class="title">Cache</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">Facades</span>\<span class="title">Mail</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">Facades</span>\<span class="title">Redis</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Throwable</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EmailException</span> <span class="keyword">extends</span> <span class="title">Exception</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="keyword">protected</span> $exception;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ResponseException constructor.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> array           $message</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> int             $code</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> \Throwable|null $previous</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(array $message, int $code = <span class="number">0</span>, \Throwable $previous = null)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> ( ! <span class="keyword">isset</span>($message[<span class="string">'errMsg'</span>]) <span class="keyword">or</span> ! <span class="keyword">isset</span>($message[<span class="string">'errCode'</span>])) &#123;</span><br><span class="line"><span class="keyword">return</span> fail(Status::SystemError[<span class="string">'codeException'</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">$this</span>-&gt;exception = $message;</span><br><span class="line"></span><br><span class="line"><span class="keyword">parent</span>::__construct(<span class="keyword">$this</span>-&gt;exception[<span class="string">'errMsg'</span>], <span class="keyword">$this</span>-&gt;exception[<span class="string">'errCode'</span>], $previous);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è‡ªå®šä¹‰å¼‚å¸¸å“åº”</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $request</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> \Illuminate\Http\JsonResponse</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span><span class="params">($request)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> fail(<span class="keyword">$this</span>-&gt;exception);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">report</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">// ç›¸åŒé”™è¯¯ç ä¸€å®šé—´éš”å†…åªå‘é€ä¸€æ¬¡</span></span><br><span class="line"><span class="keyword">if</span> (Cache::lock(<span class="keyword">$this</span>-&gt;getCode(), env(<span class="string">'EXCEPTION_MAIL_INTERVAL'</span>, <span class="number">3600</span>))-&gt;get()) &#123;</span><br><span class="line">$tos = explode(<span class="string">','</span>, env(<span class="string">'MAIL_TOS'</span>));</span><br><span class="line">$message = (<span class="keyword">new</span> \App\Mail\<span class="keyword">Exception</span>(</span><br><span class="line"><span class="keyword">$this</span>-&gt;getCode(),</span><br><span class="line"><span class="keyword">$this</span>-&gt;getMessage(),</span><br><span class="line"><span class="keyword">$this</span>-&gt;getTraceAsString()</span><br><span class="line">))-&gt;onConnection(<span class="string">'redis'</span>)-&gt;onQueue(<span class="string">'email'</span>);</span><br><span class="line">Mail::to($tos)-&gt;queue($message);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><code>Http/Exceptions/Handler.php</code> ä¸­å¢åŠ ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¤„ç†æœªæˆæƒå¸å·</span></span><br><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">unauthenticated</span><span class="params">($request, AuthenticationException $exception)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> fail(Status::Access[<span class="string">'unknownUser'</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤„ç†å‚æ•°æ ¡éªŒå¤±è´¥</span></span><br><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">convertValidationExceptionToResponse</span><span class="params">(ValidationException $e, $request)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">$detail = $e-&gt;validator-&gt;getMessageBag()-&gt;getMessages();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> fail(Status::ClientError[<span class="string">'paramException'</span>], $detail);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¢åŠ é‚®ä»¶æ¨¡æ¿"><a href="#å¢åŠ é‚®ä»¶æ¨¡æ¿" class="headerlink" title="å¢åŠ é‚®ä»¶æ¨¡æ¿"></a>å¢åŠ é‚®ä»¶æ¨¡æ¿</h2><p><code>php artisan make:mail Exception --markdown=emails.exception</code></p><p>ä¿®æ”¹ <code>app/Mail/Exception.php</code>:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Mail</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Bus</span>\<span class="title">Queueable</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Mail</span>\<span class="title">Mailable</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Queue</span>\<span class="title">SerializesModels</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Contracts</span>\<span class="title">Queue</span>\<span class="title">ShouldQueue</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Exception</span> <span class="keyword">extends</span> <span class="title">Mailable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Queueable</span>, <span class="title">SerializesModels</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span> $code;</span><br><span class="line"><span class="keyword">protected</span> $message;</span><br><span class="line"><span class="keyword">protected</span> $trace;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Create a new message instance.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * å‚æ•°ä¸èƒ½æ˜¯å¯¹è±¡ï¼Œå¦åˆ™ä¸èƒ½è®¾ç½®é˜Ÿåˆ—å‘é€</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $code</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $message</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $trace</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($code, $message, $trace)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">$this</span>-&gt;code = $code;</span><br><span class="line"><span class="keyword">$this</span>-&gt;message = $message;</span><br><span class="line"><span class="keyword">$this</span>-&gt;trace = $trace;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Build the message.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> $this</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">build</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">$this</span>-&gt;markdown(<span class="string">'emails.exception'</span>)</span><br><span class="line">-&gt;with([</span><br><span class="line"><span class="string">'errCode'</span> =&gt; <span class="keyword">$this</span>-&gt;code,</span><br><span class="line"><span class="string">'errMsg'</span>  =&gt; <span class="keyword">$this</span>-&gt;message,</span><br><span class="line"><span class="string">'trace'</span>   =&gt; <span class="keyword">$this</span>-&gt;trace,</span><br><span class="line">]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ <code>resources/views/emails/exception.blade.php</code>:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@component(&apos;mail::message&apos;)</span><br><span class="line"># xxxx-æŠ¥è­¦é‚®ä»¶</span><br><span class="line"></span><br><span class="line">é”™è¯¯ç ï¼š&#123;&#123; $errCode &#125;&#125;</span><br><span class="line">é”™è¯¯ä¿¡æ¯ï¼š&#123;&#123; $errMsg &#125;&#125;</span><br><span class="line"></span><br><span class="line">------</span><br><span class="line"></span><br><span class="line">&#123;&#123; $trace &#125;&#125;</span><br><span class="line"></span><br><span class="line">Thanks,&lt;br&gt;</span><br><span class="line">&#123;&#123; config(&apos;app.name&apos;) &#125;&#125;</span><br><span class="line">@endcomponent</span><br></pre></td></tr></table></figure><h2 id="ä¿®æ”¹-env"><a href="#ä¿®æ”¹-env" class="headerlink" title="ä¿®æ”¹.env"></a>ä¿®æ”¹.env</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CACHE_DRIVER=redis</span><br><span class="line">QUEUE_DRIVER=redis</span><br><span class="line"></span><br><span class="line">MAIL_FROM_ADDRESS=</span><br><span class="line">MAIL_FROM_NAME=</span><br><span class="line">MAIL_TOS=</span><br><span class="line">EXCEPTION_MAIL_INTERVAL=3600</span><br></pre></td></tr></table></figure><h2 id="è‡ªå®šä¹‰æƒé™éªŒè¯"><a href="#è‡ªå®šä¹‰æƒé™éªŒè¯" class="headerlink" title="è‡ªå®šä¹‰æƒé™éªŒè¯"></a>è‡ªå®šä¹‰æƒé™éªŒè¯</h2><p>è§ï¼š<a href="http://www.helongfei.com/2017/laravel%E8%87%AA%E5%AE%9A%E4%B9%89%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90%E6%A0%A1%E9%AA%8C/" rel="external nofollow noopener noreferrer" target="_blank">laravelè‡ªå®šä¹‰ç”¨æˆ·æƒé™æ ¡éªŒ</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;é…ç½®-PHPSTORM&quot;&gt;&lt;a href=&quot;#é…ç½®-PHPSTOR
      
    
    </summary>
    
      <category term="2-å¼€å‘æŠ€èƒ½" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/"/>
    
      <category term="ç¨‹åºè¯­è¨€" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E7%A8%8B%E5%BA%8F%E8%AF%AD%E8%A8%80/"/>
    
      <category term="PHP" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E7%A8%8B%E5%BA%8F%E8%AF%AD%E8%A8%80/PHP/"/>
    
      <category term="æ¡†æ¶" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E7%A8%8B%E5%BA%8F%E8%AF%AD%E8%A8%80/PHP/%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="php" scheme="http://yoursite.com/tags/php/"/>
    
      <category term="Laravel" scheme="http://yoursite.com/tags/Laravel/"/>
    
  </entry>
  
  <entry>
    <title>WEB æ”»å‡»æ‰‹æ®µ</title>
    <link href="http://yoursite.com/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E5%AE%89%E5%85%A8/Web%E6%94%BB%E5%87%BB%E6%89%8B%E6%AE%B5/"/>
    <id>http://yoursite.com/2-å¼€å‘æŠ€èƒ½/å®‰å…¨/Webæ”»å‡»æ‰‹æ®µ/</id>
    <published>2017-12-09T07:09:00.000Z</published>
    <updated>2017-12-09T08:01:12.936Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="è·¨ç«™è„šæœ¬æ”»å‡»-XSS"><a href="#è·¨ç«™è„šæœ¬æ”»å‡»-XSS" class="headerlink" title="è·¨ç«™è„šæœ¬æ”»å‡»(XSS)"></a>è·¨ç«™è„šæœ¬æ”»å‡»(XSS)</h1><p><strong>å®šä¹‰:</strong><br>åœ¨ web ç½‘ç«™ä¸Šæ‰§è¡Œéæ³•è¾“å…¥çš„ html æˆ– jsã€‚</p><p><strong>æ”»å‡»:</strong></p><ol><li>åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥ js ä»£ç ã€‚</li><li>åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥ html ä»£ç ã€‚</li></ol><p><strong>å±å®³:</strong></p><ol><li>è·å–ç”¨æˆ·èµ„æ–™ï¼ˆä¿¡æ¯ã€cooikeï¼‰</li><li>åµŒå…¥éæ³•æ•°æ®ç­‰ï¼ˆå›¾ç‰‡ï¼‰</li></ol><p><strong>é˜²èŒƒ:</strong><br>è¿‡æ»¤ç”¨æˆ·è¾“å…¥å­—ç¬¦ï¼›è½¬ä¹‰æ ‡ç­¾ï¼ˆjsï¼Œhtmlï¼‰ã€‚</p><blockquote><p>phpç±»åº“ï¼š<a href="http://htmlpurifier.org/" rel="external nofollow noopener noreferrer" target="_blank">htmlpurifier</a></p></blockquote><h1 id="SQL-æ³¨å…¥"><a href="#SQL-æ³¨å…¥" class="headerlink" title="SQL æ³¨å…¥"></a>SQL æ³¨å…¥</h1><p><strong>å®šä¹‰ï¼š</strong><br>åœ¨ web ç½‘ç«™ä¸Šæ‰§è¡Œéæ³•æ³¨å…¥çš„ SQL</p><p><strong>æ”»å‡»ï¼š</strong><br>url ä¸Šå¢åŠ  sql</p><p><strong>å±å®³ï¼š</strong></p><ol><li>è·å–æ•°æ®åº“æ•°æ®</li><li>ç¯¡æ”¹æ•°æ®åº“æ•°æ®</li></ol><p><strong>é˜²èŒƒï¼š</strong></p><ol><li>è¿‡æ»¤ç”¨æˆ·è¾“å…¥å­—ç¬¦</li><li>ä½¿ç”¨ PDO æ‰§è¡Œ SQL</li></ol><h1 id="OS-å‘½ä»¤æ”»å‡»"><a href="#OS-å‘½ä»¤æ”»å‡»" class="headerlink" title="OS å‘½ä»¤æ”»å‡»"></a>OS å‘½ä»¤æ”»å‡»</h1><p><strong>å®šä¹‰ï¼š</strong><br>åœ¨ Web ä¸Šæ‰§è¡Œéæ³•è¾“å…¥çš„ OS å‘½ä»¤</p><p><strong>æ”»å‡»ï¼š</strong><br>è¾“å…¥æ¡†ä¸­è¾“å…¥ OS å‘½ä»¤</p><p><strong>å±å®³ï¼š</strong><br>è·å–æœåŠ¡å™¨ä¿¡æ¯ï¼ˆ<code>/etc/passwd</code>ï¼‰</p><p><strong>é˜²èŒƒï¼š</strong><br>è¿‡æ»¤ç”¨æˆ·è¾“å…¥å­—ç¬¦</p><h1 id="è·¨ç«™è¯·æ±‚ä¼ªé€ -CSRF"><a href="#è·¨ç«™è¯·æ±‚ä¼ªé€ -CSRF" class="headerlink" title="è·¨ç«™è¯·æ±‚ä¼ªé€ (CSRF)"></a>è·¨ç«™è¯·æ±‚ä¼ªé€ (CSRF)</h1><p><strong>å®šä¹‰ï¼š</strong><br>æ”»å‡»è€…ç›—ç”¨äº†ä½ çš„èº«ä»½ï¼Œä»¥ä½ çš„åä¹‰å‘é€æ¶æ„è¯·æ±‚ã€‚</p><p><strong>æ”»å‡»ï¼š</strong><br>1.å—å®³ç”¨æˆ·ç™»å½•å—ä¿¡ä»»ç½‘ç«™Aï¼Œå¹¶åœ¨æœ¬åœ°ç”ŸæˆCookieã€‚<br>2.å—å®³ç”¨æˆ·åœ¨ä¸ç™»å‡ºAçš„æƒ…å†µä¸‹ï¼Œè®¿é—®å±é™©ç½‘ç«™Bã€‚</p><p><strong>å±å®³ï¼š</strong></p><ol><li>ä»¥ä½ åä¹‰å‘é€é‚®ä»¶ï¼Œå‘æ¶ˆæ¯ï¼ˆä¾‹ï¼šå¾®åšå…³æ³¨æœªçŸ¥ç”¨æˆ·ï¼‰</li><li>ç›—å–ä½ çš„è´¦å·</li></ol><p><strong>é˜²èŒƒï¼š</strong><br>æœåŠ¡ç«¯é¢„å…ˆç”Ÿæˆ tokenï¼Œå­˜åœ¨ session ä¸­ï¼›å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰åœ¨ form è¡¨å•ä¸­å¢åŠ è¯·æ±‚ tokenï¼ŒæœåŠ¡ç«¯æ¥å—åˆ°è¯·æ±‚åéªŒè¯è¯·æ±‚ tokenã€‚ï¼ˆä¿è¯ç”¨æˆ·å‘èµ·çš„è¯·æ±‚æ˜¯åœ¨æœ¬ç«™ï¼Œè€Œä¸æ˜¯åœ¨ç¬¬ä¸‰æ–¹ç½‘ç«™ï¼‰</p><!--ä»¥ä¸‹æ˜¯è„šæ³¨-->]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;è·¨ç«™è„šæœ¬æ”»å‡»-XSS&quot;&gt;&lt;a href=&quot;#è·¨ç«™è„šæœ¬æ”»å‡»-XSS&quot;
      
    
    </summary>
    
      <category term="2-å¼€å‘æŠ€èƒ½" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/"/>
    
      <category term="å®‰å…¨" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E5%AE%89%E5%85%A8/"/>
    
    
  </entry>
  
  <entry>
    <title>Http åè®®</title>
    <link href="http://yoursite.com/1-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/http-%E5%8D%8F%E8%AE%AE/"/>
    <id>http://yoursite.com/1-åŸºç¡€çŸ¥è¯†/è®¡ç®—æœºç½‘ç»œ/http-åè®®/</id>
    <published>2017-12-08T11:04:00.000Z</published>
    <updated>2018-01-01T08:24:57.044Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="Http-å†å²ç‰ˆæœ¬"><a href="#Http-å†å²ç‰ˆæœ¬" class="headerlink" title="Http å†å²ç‰ˆæœ¬"></a>Http å†å²ç‰ˆæœ¬</h1><p>HTTP æ˜¯åŸºäº TCP/IP åè®®çš„åº”ç”¨å±‚åè®®ã€‚ä¸»è¦è§„å®šäº†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡æ ¼å¼ï¼Œé»˜è®¤ä½¿ç”¨80ç«¯å£ã€‚</p><h2 id="Http0-9"><a href="#Http0-9" class="headerlink" title="Http0.9"></a>Http0.9</h2><p>1991å¹´å‘å¸ƒï¼Œåªæœ‰ GETï¼Œåªèƒ½å›åº” html æ ¼å¼çš„å­—ç¬¦ä¸²ã€‚</p><p>è¯·æ±‚ç¤ºä¾‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /index.html</span><br></pre></td></tr></table></figure></p><p>å“åº”ç¤ºä¾‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;body&gt;Hello World&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><h2 id="Http1-0"><a href="#Http1-0" class="headerlink" title="Http1.0"></a>Http1.0</h2><p>1996å¹´5æœˆå‘å¸ƒï¼Œè®°è½½äº <a href="https://www.ietf.org/rfc/rfc1945.txt" rel="external nofollow noopener noreferrer" target="_blank">RFC1945</a>ï¼›å¯ä»¥ä¼ è¾“ä»»ä½•ç±»å‹çš„å†…å®¹ï¼ˆæ–‡æœ¬ã€å›¾åƒã€è§†é¢‘ã€äºŒè¿›åˆ¶æ–‡ä»¶ç­‰ï¼‰</p><p>ç›¸å¯¹æ¯”<code>http0.9</code>å¢åŠ äº†ï¼š</p><ol><li>POSTã€HEAD ç­‰è¯·æ±‚æ–¹æ³•</li><li>çŠ¶æ€ç </li><li>MIME</li><li>é¦–éƒ¨å­—æ®µ</li><li>æƒé™è®¤è¯ï¼ˆBasicï¼‰</li><li>å­—ç¬¦é›†</li><li>ä¼ è¾“å„ç±»å‹å†…å®¹</li></ol><p>è¯¦ç»†å†…å®¹è¯·å‚è€ƒ <a href="https://www.ietf.org/rfc/rfc1945.txt" rel="external nofollow noopener noreferrer" target="_blank">RFC1945</a></p><p>è¯·æ±‚ç¤ºä¾‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GET / HTTP/1.0</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5)</span><br><span class="line">Accept: */*</span><br></pre></td></tr></table></figure></p><p>å“åº”ç¤ºä¾‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.0 200 OK</span><br><span class="line">Content-Type: text/plain</span><br><span class="line">Content-Length: 137582</span><br><span class="line">Expires: Thu, 05 Dec 1997 16:00:00 GMT</span><br><span class="line">Last-Modified: Wed, 5 August 1996 15:55:28 GMT</span><br><span class="line">Server: Apache 0.84</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">  &lt;body&gt;Hello World&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p><strong>ç¼ºç‚¹:</strong><br>æ¯ä¸ªTCPè¿æ¥åªèƒ½å‘é€ä¸€ä¸ªè¯·æ±‚ã€‚</p><h1 id="Http1-1"><a href="#Http1-1" class="headerlink" title="Http1.1"></a>Http1.1</h1><p>1997å¹´1æœˆå‘å¸ƒï¼Œæœ€åˆç‰ˆæ˜¯ <a href="https://www.ietf.org/rfc/rfc2068.txt" rel="external nofollow noopener noreferrer" target="_blank">RFC2068</a>ï¼›1999å¹´6æœˆå‘å¸ƒçš„ä¿®è®¢ç‰ˆ <a href="https://www.ietf.org/rfc/rfc2616.txt" rel="external nofollow noopener noreferrer" target="_blank">RFC2616</a> æ²¿ç”¨è‡³ä»Šã€‚</p><p>å¯¹æ¯”<code>http1.0</code>æœ€å¤§çš„å˜åŒ–æ˜¯ï¼š</p><ol><li>é»˜è®¤æŒä¹…è¿æ¥ï¼ˆ<code>keep-alive</code>ï¼‰</li><li>å¼•å…¥äº† <code>pipelining</code>ï¼ˆåŒä¸€ä¸ªTCPè¿æ¥å‘é€å¤šä¸ªè¯·æ±‚ï¼‰ï¼Œä½†æ˜¯ç”±äºæœåŠ¡å™¨æ˜¯æŒ‰ç…§è¯·æ±‚é¡ºåºè¿›è¡Œå“åº”ï¼Œå®¢æˆ·ç«¯æ— æ³•ç¡®å®šæœ€ä¼˜è¯·æ±‚é¡ºåºï¼Œæ‰€ä»¥æœªæ™®åŠ</li><li>åˆ†å—ä¼ è¾“ç¼–ç (<code>chunked</code>)ï¼Œé’ˆå¯¹å¤§æ•°æ®ä¼ è¾“æ“ä½œï¼ŒæŠŠæ•°æ®åˆ‡åˆ†ä¸ºè‹¥å¹²æ•°æ®å—<sup id="fnref:1"><a href="#fn:1" rel="footnote"><span class="hint--top-right hint--error hint--large" aria-label="æ¯ä¸ªéç©ºçš„æ•°æ®å—ä¹‹å‰ï¼Œä¼šæœ‰ä¸€ä¸ª16è¿›åˆ¶çš„æ•°å€¼ï¼Œè¡¨ç¤ºè¿™ä¸ªå—çš„é•¿åº¦ã€‚æœ€åæ˜¯ä¸€ä¸ªå¤§å°ä¸º0çš„å—ï¼Œå°±è¡¨ç¤ºæœ¬æ¬¡å›åº”çš„æ•°æ®å‘é€å®Œäº†ã€‚">[1]</span></a></sup>è¿›è¡Œä¼ è¾“ï¼ˆæµæ¨¡å¼ï¼‰</li><li>å¢åŠ äº†æ›´å¤šçš„è¯·æ±‚æ–¹æ³•ï¼šOPTIONS,PUT,DELETE,TRACE,CONNECT</li><li>å¢åŠ äº†æ›´å¤šçš„çŠ¶æ€ç </li><li>å¯ä»¥èŒƒå›´å–æ•°æ®,å¯å®ç°æ–­ç‚¹ç»­ä¼ ä¸‹è½½(<code>range</code>,<code>etag</code>)</li><li>å¯è¿½è¸ªæ•°æ®è¯·æ±‚é“¾(<code>via</code>)</li><li>å¢åŠ æƒé™è®¤è¯</li><li>å¢åŠ äº†<code>host</code>é¦–éƒ¨ï¼Œä½¿å¾—ä¸€å°æœåŠ¡å™¨å¯ä»¥æ”¯æŒè™šæ‹Ÿä¸»æœº</li></ol><p><strong>ç¼ºç‚¹ï¼š</strong></p><ol><li>æµè§ˆå™¨å¯¹åŒä¸€åŸŸåä¸‹çš„æŒä¹…è¿æ¥å¹¶å‘æœ‰é™åˆ¶ï¼Œé€šå¸¸æ˜¯6ä¸ª</li><li>ä½¿ç”¨<code>pipelining</code>ä¼šé€ æˆ <code>Head of line blocking</code></li><li>æ¯æ¬¡é€šä¿¡éƒ½éœ€è¦ä¼ é€<code>header</code>ï¼Œå¤šæ¬¡è¯·æ±‚æ—¶å¤§éƒ¨åˆ†è¯·æ±‚é¦–éƒ¨å­—æ®µä¸å˜ï¼Œä¼šå¢åŠ ä¼ è¾“æˆæœ¬</li></ol><h2 id="URL-URI-URN"><a href="#URL-URI-URN" class="headerlink" title="URL / URI / URN"></a>URL / URI / URN</h2><p><strong>å®šä¹‰</strong><br>uniform resource identifierï¼ˆç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼‰ URI<br>uniform resource locator ï¼ˆç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼‰URL<br>uniform resource nameï¼ˆç»Ÿä¸€èµ„æºåç§°ï¼‰URN</p><p><strong>åŒºåˆ«</strong><br>URLã€URN æ˜¯ URI çš„å­é›†</p><blockquote><p>URIå¯è¢«è§†ä¸ºå®šä½ç¬¦ï¼ˆURLï¼‰ï¼Œåç§°ï¼ˆURNï¼‰æˆ–ä¸¤è€…å…¼å¤‡ã€‚ç»Ÿä¸€èµ„æºåï¼ˆURNï¼‰å¦‚åŒä¸€ä¸ªäººçš„åç§°ï¼Œè€Œç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼ˆURLï¼‰ä»£è¡¨ä¸€ä¸ªäººçš„ä½å€ã€‚æ¢è¨€ä¹‹ï¼Œ<strong>URNå®šä¹‰æŸäº‹ç‰©çš„èº«ä»½ï¼Œè€ŒURLæä¾›æŸ¥æ‰¾è¯¥äº‹ç‰©çš„æ–¹æ³•ã€‚</strong></p></blockquote><p><img src="/images/2017/11/11/uri.png" alt="URI"></p><h2 id="Http-æŠ¥æ–‡"><a href="#Http-æŠ¥æ–‡" class="headerlink" title="Http æŠ¥æ–‡"></a>Http æŠ¥æ–‡</h2><p><img src="/images/2017/12/05/æŠ¥æ–‡ç»“æ„.png" alt="æŠ¥æ–‡ç»“æ„"></p><h3 id="é€šç”¨é¦–éƒ¨å­—æ®µ"><a href="#é€šç”¨é¦–éƒ¨å­—æ®µ" class="headerlink" title="é€šç”¨é¦–éƒ¨å­—æ®µ"></a>é€šç”¨é¦–éƒ¨å­—æ®µ</h3><p><img src="/images/2017/12/05/é€šç”¨é¦–éƒ¨å­—æ®µ.png" alt="é€šç”¨é¦–éƒ¨å­—æ®µ"></p><h3 id="è¯·æ±‚é¦–éƒ¨å­—æ®µ"><a href="#è¯·æ±‚é¦–éƒ¨å­—æ®µ" class="headerlink" title="è¯·æ±‚é¦–éƒ¨å­—æ®µ"></a>è¯·æ±‚é¦–éƒ¨å­—æ®µ</h3><p><img src="/images/2017/12/05/è¯·æ±‚é¦–éƒ¨å­—æ®µ.png" alt="è¯·æ±‚é¦–éƒ¨å­—æ®µ"></p><h3 id="å“åº”é¦–éƒ¨å­—æ®µ"><a href="#å“åº”é¦–éƒ¨å­—æ®µ" class="headerlink" title="å“åº”é¦–éƒ¨å­—æ®µ"></a>å“åº”é¦–éƒ¨å­—æ®µ</h3><p><img src="/images/2017/12/05/å“åº”é¦–éƒ¨å­—æ®µ1.png" alt="å“åº”é¦–éƒ¨å­—æ®µ1"><br><img src="/images/2017/12/05/å“åº”é¦–éƒ¨å­—æ®µ2.png" alt="å“åº”é¦–éƒ¨å­—æ®µ2"></p><h3 id="å®ä½“é¦–éƒ¨å­—æ®µ"><a href="#å®ä½“é¦–éƒ¨å­—æ®µ" class="headerlink" title="å®ä½“é¦–éƒ¨å­—æ®µ"></a>å®ä½“é¦–éƒ¨å­—æ®µ</h3><p><img src="/images/2017/12/05/å®ä½“é¦–éƒ¨å­—æ®µ.png" alt="å®ä½“é¦–éƒ¨å­—æ®µ"></p><h2 id="Http-çŠ¶æ€ç "><a href="#Http-çŠ¶æ€ç " class="headerlink" title="Http çŠ¶æ€ç "></a>Http çŠ¶æ€ç </h2><p><img src="/images/2017/12/05/çŠ¶æ€ç ç±»åˆ«.png" alt="çŠ¶æ€ç ç±»åˆ«"></p><h3 id="1XX"><a href="#1XX" class="headerlink" title="1XX"></a>1XX</h3><table><thead><tr><th>çŠ¶æ€ç </th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>100</td><td>Continue</td></tr><tr><td>101</td><td>Switching Protocols</td></tr></tbody></table><h3 id="2XX"><a href="#2XX" class="headerlink" title="2XX"></a>2XX</h3><table><thead><tr><th>çŠ¶æ€ç </th><th>å«ä¹‰</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>200</td><td>OK</td><td></td></tr><tr><td>201</td><td>Created</td><td></td></tr><tr><td>202</td><td>Accepted</td><td></td></tr><tr><td>203</td><td>Non-Authoritative Information</td><td></td></tr><tr><td>204</td><td>No Content</td><td>å“åº”æŠ¥æ–‡ä¸­ä¸å«ä¸»ä½“</td></tr><tr><td>205</td><td>Reset Content</td><td></td></tr><tr><td>206</td><td>Parial Content</td><td>èŒƒå›´è¯·æ±‚ï¼›å“åº”æŠ¥æ–‡ä¸­å«æœ‰content-range</td></tr></tbody></table><h3 id="3XX"><a href="#3XX" class="headerlink" title="3XX"></a>3XX</h3><table><thead><tr><th>çŠ¶æ€ç </th><th>å«ä¹‰</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>300</td><td>Multiple Choices</td><td></td></tr><tr><td>301</td><td>Moved Permanently</td><td>æ°¸ä¹…é‡å®šå‘ï¼Œä¸¢å¤±æœç´¢å¼•æ“æƒé‡</td></tr><tr><td>302</td><td>Found</td><td>ä¸´æ—¶é‡å®šå‘</td></tr><tr><td>303</td><td>See other</td><td>æœ‰å¦å¤–çš„URLï¼Œåº”ä½¿ç”¨GETå»è®¿é—®å¦ä¸€ä¸ªURL</td></tr><tr><td>304</td><td>Not Modified</td><td>æ²¡æœ‰æ»¡è¶³å®¢æˆ·ç«¯çš„æ¡ä»¶è¯·æ±‚çš„å“åº”éœ€è¦è¿”å›ï¼Œä¸åŒ…å«ä¸»ä½“</td></tr><tr><td>305</td><td>Use Proxy</td><td></td></tr><tr><td>306</td><td>(Unuesed)</td><td></td></tr><tr><td>307</td><td>Temporary Redirect</td><td>ä¸´æ—¶é‡å®šå‘ï¼Œä¸ä¼šæŠŠPOSTæ”¹ä¸ºGET</td></tr></tbody></table><h3 id="4XX"><a href="#4XX" class="headerlink" title="4XX"></a>4XX</h3><table><thead><tr><th>çŠ¶æ€ç </th><th>å«ä¹‰</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>400</td><td>Bad Request</td><td>è¯·æ±‚æŠ¥æ–‡å­˜åœ¨è¯­æ³•é”™è¯¯</td></tr><tr><td>401</td><td>Unauthorized</td><td>HTTPè®¤è¯æœªé€šè¿‡</td></tr><tr><td>402</td><td>Payment Required</td><td></td></tr><tr><td>403</td><td>Forbidden</td><td>è¯·æ±‚è¢«æ‹’ç»</td></tr><tr><td>404</td><td>Not Found</td><td>æœªæ‰¾åˆ°è¯·æ±‚èµ„æº</td></tr><tr><td>405</td><td>Method NOt Allowed</td><td></td></tr><tr><td>406</td><td>Not Acceptable</td><td></td></tr><tr><td>407</td><td>Proxy Authentication Required</td><td></td></tr><tr><td>408</td><td>Request Timeout</td><td></td></tr><tr><td>409</td><td>Conflict</td><td></td></tr><tr><td>410</td><td>Gone</td><td>è¯·æ±‚èµ„æºè¢«æ°¸ä¹…æ€§åˆ é™¤</td></tr><tr><td>411</td><td>Length Required</td><td></td></tr><tr><td>412</td><td>Precondition Failed</td><td></td></tr><tr><td>413</td><td>Request Entity Too Large</td><td></td></tr><tr><td>414</td><td>Request-URI Too Long</td><td></td></tr><tr><td>415</td><td>Unsupported Media Type</td><td></td></tr><tr><td>416</td><td>Requested Range Not Satisfiable</td><td></td></tr><tr><td>417</td><td>Expectation Failed</td><td>-</td></tr></tbody></table><h3 id="5XX"><a href="#5XX" class="headerlink" title="5XX"></a>5XX</h3><table><thead><tr><th>çŠ¶æ€ç </th><th>å«ä¹‰</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>500</td><td>Internal Server Error</td><td>æœåŠ¡ç«¯åœ¨æ‰§è¡Œè¯·æ±‚æ—¶å‘ç”Ÿé”™è¯¯</td></tr><tr><td>501</td><td>Not Implemented</td><td></td></tr><tr><td>502</td><td>Bad Gateway</td><td></td></tr><tr><td>503</td><td>Service Unavailable</td><td>æœåŠ¡å™¨è¶…è´Ÿè½½ï¼Œæš‚æ—¶æ— æ³•å¤„ç†è¯·æ±‚</td></tr><tr><td>504</td><td>Gateway Timeout</td><td></td></tr><tr><td>505</td><td>Http Version Not Unsupported</td><td>-</td></tr></tbody></table><h2 id="HTTP-è¿½åŠ åè®®"><a href="#HTTP-è¿½åŠ åè®®" class="headerlink" title="HTTP è¿½åŠ åè®®"></a>HTTP è¿½åŠ åè®®</h2><h3 id="SPDY-åè®®"><a href="#SPDY-åè®®" class="headerlink" title="SPDY åè®®"></a>SPDY åè®®</h3><p>Googleåœ¨2010å¹´å‘å¸ƒäº† <a href="http://www.chromium.org/spdy" rel="external nofollow noopener noreferrer" target="_blank">SPDYåè®®</a>ï¼›å¸Œæœ›åœ¨åè®®å±‚é¢è§£å†³httpçš„ä¸€äº›ç—›ç‚¹ï¼š</p><ol><li>ä¸€æ¡è¿æ¥å‘é€ä¸€æ¡è¯·æ±‚</li><li>è¯·æ±‚åªèƒ½ä»å®¢æˆ·ç«¯å‘èµ·</li><li>é¦–éƒ¨æœªç»å‹ç¼©</li></ol><p><img src="/images/2017/12/05/spdyçš„è®¾è®¡.png" alt="SPDYçš„è®¾è®¡"></p><p><strong>SPDYåè®®çš„ä¸»è¦åŠŸèƒ½æœ‰ï¼š</strong></p><ol><li>å¤šè·¯å¤ç”¨æµï¼ˆå•ä¸€TCPè¿æ¥ï¼‰</li><li>è¯·æ±‚ä¼˜å…ˆçº§</li><li>å‹ç¼©Httpé¦–éƒ¨</li><li>æ”¯æŒæœåŠ¡ç«¯æ¨é€æ•°æ®åˆ°å®¢æˆ·ç«¯</li><li>æœåŠ¡å™¨ä¸»åŠ¨æç¤ºå®¢æˆ·ç«¯æ‰€éœ€èµ„æºï¼ˆè¿‡æœŸï¼‰</li></ol><h3 id="WebSocket-åè®®"><a href="#WebSocket-åè®®" class="headerlink" title="WebSocket åè®®"></a>WebSocket åè®®</h3><p>Websocketå³webæµè§ˆå™¨ä¸webæœåŠ¡å™¨ä¹‹é—´å…¨åŒå·¥é€šä¿¡æ ‡å‡†ã€‚2011å¹´12æœˆ11æ—¥è®°è½½äº <a href="https://www.ietf.org/rfc/rfc6455.txt" rel="external nofollow noopener noreferrer" target="_blank">RFC6455</a>ï¼›</p><p>ä¸ºäº†å®ç°Websocketé€šä¿¡ï¼Œåœ¨HTTPè¿æ¥å»ºç«‹ä¹‹åï¼Œéœ€è¦å®Œæˆä¸€æ¬¡æ¡æ‰‹ï¼š</p><p><img src="/images/2017/12/05/websocketé€šä¿¡.png" alt="Websocketé€šä¿¡"></p><p><strong>Websocketçš„åŠŸèƒ½ï¼š</strong></p><ol><li>æœåŠ¡å™¨æ¨é€</li><li>å‡å°‘é€šä¿¡é‡ï¼ˆwebsocketé¦–éƒ¨ä¿¡æ¯å¾ˆå°ï¼‰</li><li>jså¯è°ƒç”¨ <a href="http://www.w3.org/TR/websockets" rel="external nofollow noopener noreferrer" target="_blank">Websocket API</a></li></ol><h1 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a>HTTPS</h1><p>2000å¹´5æœˆå…¬å¸ƒï¼Œå‘å¸ƒäº <a href="https://www.ietf.org/rfc/rfc2818.txt" rel="external nofollow noopener noreferrer" target="_blank">RFC2818</a>ï¼›é»˜è®¤ç«¯å£443ã€‚å› ä¸ºæœ‰åŠ å¯†è§£å¯†ï¼Œæ‰€ä»¥è®¿é—®ä¼šæ¯”httpæ…¢ï¼ˆå¯æ¥å—ï¼‰ï¼Œå¹¶ä¸”ä¼šæ¶ˆè€—æœåŠ¡å™¨cpuèµ„æºã€‚</p><h2 id="Httpçš„ç¼ºç‚¹"><a href="#Httpçš„ç¼ºç‚¹" class="headerlink" title="Httpçš„ç¼ºç‚¹"></a>Httpçš„ç¼ºç‚¹</h2><ol><li>é€šä¿¡ä½¿ç”¨æ˜æ–‡ï¼Œå¯èƒ½è¢«çªƒå¬</li><li>ä¸éªŒè¯é€šä¿¡æ–¹èº«ä»½ï¼Œå¯èƒ½è¢«ä¼ªè£…</li><li>æ— æ³•è¯æ˜æŠ¥æ–‡çš„å®Œæ•´æ€§ï¼Œå¯èƒ½è¢«ç¯¡æ”¹</li></ol><h2 id="SSL-TLS-åè®®"><a href="#SSL-TLS-åè®®" class="headerlink" title="SSL/TLS åè®®"></a>SSL/TLS åè®®</h2><p>æœ€åˆæ˜¯ç½‘æ™¯è®¾è®¡äº† SSLï¼ˆ1.0~3.0ï¼‰ï¼›åæ¥ ITEF åœ¨ SSL3.0 åŸºç¡€ä¸Šè®¾è®¡äº† TLS1.0ï¼Œç›®å‰ TLS æœ€æ–°ç‰ˆä¸º1.3ã€‚</p><p><strong>5æ¬¡æ¡æ‰‹ï¼š</strong></p><p>ç¬¬ä¸€æ­¥ï¼Œå®¢æˆ·ç«¯ç»™å‡ºåè®®ç‰ˆæœ¬å·ã€ä¸€ä¸ªå®¢æˆ·ç«¯ç”Ÿæˆçš„éšæœºæ•°ï¼ˆClient randomï¼‰ï¼Œä»¥åŠå®¢æˆ·ç«¯æ”¯æŒçš„åŠ å¯†æ–¹æ³•ã€‚<br>ç¬¬äºŒæ­¥ï¼ŒæœåŠ¡ç«¯ç¡®è®¤åŒæ–¹ä½¿ç”¨çš„åŠ å¯†æ–¹æ³•ï¼Œå¹¶ç»™å‡ºæ•°å­—è¯ä¹¦ã€ä»¥åŠä¸€ä¸ªæœåŠ¡å™¨ç”Ÿæˆçš„éšæœºæ•°ï¼ˆServer randomï¼‰ã€‚<br>ç¬¬ä¸‰æ­¥ï¼Œå®¢æˆ·ç«¯ç¡®è®¤æ•°å­—è¯ä¹¦æœ‰æ•ˆï¼Œç„¶åç”Ÿæˆä¸€ä¸ªæ–°çš„éšæœºæ•°ï¼ˆPremaster secretï¼‰ï¼Œå¹¶ä½¿ç”¨æ•°å­—è¯ä¹¦ä¸­çš„å…¬é’¥ï¼ŒåŠ å¯†è¿™ä¸ªéšæœºæ•°ï¼Œå‘ç»™æœåŠ¡ç«¯ã€‚<br>ç¬¬å››æ­¥ï¼ŒæœåŠ¡ç«¯ä½¿ç”¨è‡ªå·±çš„ç§é’¥ï¼Œè·å–å®¢æˆ·ç«¯å‘æ¥çš„éšæœºæ•°ï¼ˆå³Premaster secretï¼‰ã€‚<br>ç¬¬äº”æ­¥ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æ ¹æ®çº¦å®šçš„åŠ å¯†æ–¹æ³•ï¼Œä½¿ç”¨å‰é¢çš„ä¸‰ä¸ªéšæœºæ•°ï¼Œç”Ÿæˆâ€å¯¹è¯å¯†é’¥â€ï¼ˆsession keyï¼‰ï¼Œç”¨æ¥åŠ å¯†æ¥ä¸‹æ¥çš„æ•´ä¸ªå¯¹è¯è¿‡ç¨‹ã€‚</p><p>æ•´ä½“æ¡æ‰‹æ˜¯æ˜æ–‡ä¼ è¾“ã€‚</p><p><strong>ä¼šè¯æ¢å¤ï¼š</strong></p><ol><li><p>session ID<br>æ¯ä¸€æ¬¡å¯¹è¯éƒ½æœ‰ä¸€ä¸ªç¼–å·ï¼ˆsession IDï¼‰ã€‚å¦‚æœå¯¹è¯ä¸­æ–­ï¼Œä¸‹æ¬¡é‡è¿çš„æ—¶å€™ï¼Œåªè¦å®¢æˆ·ç«¯ç»™å‡ºè¿™ä¸ªç¼–å·ï¼Œä¸”æœåŠ¡å™¨æœ‰è¿™ä¸ªç¼–å·çš„è®°å½•ï¼ŒåŒæ–¹å°±å¯ä»¥é‡æ–°ä½¿ç”¨å·²æœ‰çš„â€å¯¹è¯å¯†é’¥â€ï¼Œè€Œä¸å¿…é‡æ–°ç”Ÿæˆä¸€æŠŠã€‚</p></li><li><p>session ticket<br>å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªæœåŠ¡å™¨åœ¨ä¸Šä¸€æ¬¡å¯¹è¯ä¸­å‘é€è¿‡æ¥çš„session ticketã€‚è¿™ä¸ªsession ticketæ˜¯åŠ å¯†çš„ï¼Œåªæœ‰æœåŠ¡å™¨æ‰èƒ½è§£å¯†ï¼Œå…¶ä¸­åŒ…æ‹¬æœ¬æ¬¡å¯¹è¯çš„ä¸»è¦ä¿¡æ¯ï¼Œæ¯”å¦‚å¯¹è¯å¯†é’¥å’ŒåŠ å¯†æ–¹æ³•ã€‚å½“æœåŠ¡å™¨æ”¶åˆ°session ticketä»¥åï¼Œè§£å¯†åå°±ä¸å¿…é‡æ–°ç”Ÿæˆå¯¹è¯å¯†é’¥äº†ã€‚</p></li></ol><h2 id="Httpsçš„ç»„æˆ"><a href="#Httpsçš„ç»„æˆ" class="headerlink" title="Httpsçš„ç»„æˆ"></a>Httpsçš„ç»„æˆ</h2><blockquote><p>Http + åŠ å¯† + è®¤è¯ + å®Œæ•´æ€§ä¿æŠ¤ = Https</p></blockquote><p>Httpç›´æ¥å’ŒTCPé€šä¿¡ï¼ŒHttpså…ˆå’ŒSSL/TLSé€šä¿¡ï¼Œå†ç”±SSL/TLSå’ŒTCPé€šä¿¡ã€‚<br><img src="/images/2017/12/05/httpvshttps.png" alt="HttpVsHttps"></p><h3 id="åŠ å¯†"><a href="#åŠ å¯†" class="headerlink" title="åŠ å¯†"></a>åŠ å¯†</h3><p>é‡‡ç”¨ã€Œå¯¹ç§°åŠ å¯†ã€<sup id="fnref:2"><a href="#fn:2" rel="footnote"><span class="hint--top-right hint--error hint--large" aria-label="åŠ å¯†å’Œè§£å¯†ä½¿ç”¨åŒä¸€ä¸ªå¯†é’¥ï¼›æ¶ˆè€—èµ„æºå°‘ä¸”å¿«">[2]</span></a></sup>å’Œã€Œéå¯¹ç§°åŠ å¯†ã€<sup id="fnref:3"><a href="#fn:3" rel="footnote"><span class="hint--top-right hint--error hint--large" aria-label="ä½¿ç”¨å…¬é’¥è¿›è¡ŒåŠ å¯†ï¼ˆå‘é€æ–¹ï¼‰ï¼Œä½¿ç”¨ç§é’¥è¿›è¡Œè§£å¯†ï¼ˆä½¿ç”¨æ–¹ï¼‰ï¼›æ¶ˆè€—èµ„æºå¤šä¸”æ…¢">[3]</span></a></sup>æ··åˆåŠ å¯†æ–¹å¼ï¼›äº¤æ¢å¯†é’¥ä½¿ç”¨ã€Œéå¯¹ç§°åŠ å¯†ã€ï¼Œé€šä¿¡ä½¿ç”¨ã€Œå¯¹ç§°åŠ å¯†ã€ã€‚</p><h3 id="è®¤è¯"><a href="#è®¤è¯" class="headerlink" title="è®¤è¯"></a>è®¤è¯</h3><p>é‡‡ç”¨æ•°å­—è®¤è¯æœºæ„ä¸å…¶ç›¸å…³æœºå…³é¢å‘çš„ã€Œå…¬å¼€å¯†é’¥è¯ä¹¦ã€è¿›è¡Œè®¤è¯ã€‚</p><ol><li>ç½‘ç«™æäº¤å…¬é’¥ç»™æ•°å­—è®¤è¯æœºæ„ï¼Œæœºæ„åˆ¶ä½œä¸ºã€Œå…¬å¼€å¯†é’¥è¯ä¹¦ã€ï¼ˆéå¯¹ç§°åŠ å¯†ï¼‰</li><li>ç½‘ç«™æœåŠ¡ç«¯æŠŠã€Œå…¬å¼€å¯†é’¥è¯ä¹¦ã€å‘é€ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯åˆ©ç”¨æµè§ˆå™¨å†…ç½®çš„æ•°å­—è®¤è¯æœºæ„å…¬é’¥è¿›è¡ŒéªŒè¯ï¼ˆéå¯¹ç§°åŠ å¯†ï¼‰</li><li>éªŒè¯é€šè¿‡åï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä½¿ç”¨å…¬é’¥è¿›è¡ŒåŠ å¯†é€šä¿¡ï¼ˆå¯¹ç§°åŠ å¯†ï¼‰</li></ol><h3 id="å®Œæ•´æ€§ä¿æŠ¤"><a href="#å®Œæ•´æ€§ä¿æŠ¤" class="headerlink" title="å®Œæ•´æ€§ä¿æŠ¤"></a>å®Œæ•´æ€§ä¿æŠ¤</h3><p>åœ¨é€šä¿¡è¿‡ç¨‹ä¸­ï¼Œåº”ç”¨å±‚ä¼šå‘é€MACï¼ˆMessage Authentication Codeï¼‰æŠ¥æ–‡æ‘˜è¦ï¼ˆMD5ç­‰ç®—æ³•ï¼‰ï¼›MACå¯ä»¥æŸ¥çŸ¥æŠ¥æ–‡æ˜¯å¦è¢«ç¯¡æ”¹ã€‚</p><h1 id="HTTP2"><a href="#HTTP2" class="headerlink" title="HTTP2"></a>HTTP2</h1><p>2015å¹´5æœˆï¼Œå‘å¸ƒäº <a href="https://www.ietf.org/rfc/rfc7540.txt" rel="external nofollow noopener noreferrer" target="_blank">RFC7540</a>ï¼›åŸºäº<code>spdy3.0è‰æ¡ˆ</code>ï¼›Http2 å¯ä»¥åŸºäºã€Œæ˜æ–‡ã€ï¼Œä¹Ÿå¯ä»¥åŸºäºã€ŒTLSã€è¿›è¡Œé€šä¿¡ã€‚</p><p>å…³äºåç»­ç‰ˆæœ¬ï¼š<br>HTTP2åå–æ¶ˆäº†å°ç‰ˆæœ¬ï¼Œåç»­çš„ç‰ˆæœ¬ä¼šæ˜¯HTTP3ã€‚</p><h2 id="HTTP2çš„ç‰¹æ€§"><a href="#HTTP2çš„ç‰¹æ€§" class="headerlink" title="HTTP2çš„ç‰¹æ€§"></a>HTTP2çš„ç‰¹æ€§</h2><p><strong>1. äºŒè¿›åˆ¶åè®®</strong><br><img src="/images/2017/12/08/http2.png" alt="http2"></p><ul><li>length å®šä¹‰äº†æ•´ä¸ªframeï¼ˆå¸§ï¼‰çš„å¤§å°</li><li>typeå®šä¹‰frameçš„ç±»å‹ï¼ˆä¸€å…±10ç§ï¼‰</li><li>flagsç”¨bitä½å®šä¹‰ä¸€äº›é‡è¦çš„å‚æ•°</li><li>stream idç”¨ä½œæµæ§åˆ¶</li><li>frame payloadå°±æ˜¯requestçš„æ­£æ–‡ã€‚</li></ul><p><strong>2. å¤šè·¯å¤ç”¨çš„æµ</strong></p><p><strong>å¸§</strong>ï¼šHTTP2 æ•°æ®é€šä¿¡çš„æœ€å°å•ä½ï¼›ä¾‹å¦‚è¯·æ±‚å’Œå“åº”ç­‰ï¼Œæ¶ˆæ¯ç”±ä¸€ä¸ªæˆ–å¤šä¸ªå¸§ç»„æˆã€‚</p><p><strong>æµ</strong>ï¼šå­˜åœ¨äºè¿æ¥ä¸­çš„ä¸€ä¸ªè™šæ‹Ÿé€šé“ã€‚æµå¯ä»¥æ‰¿è½½åŒå‘æ¶ˆæ¯ï¼Œæ¯ä¸ªæµéƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ•´æ•°IDã€‚</p><p>HTTP2 ä¸­ï¼ŒåŒåŸŸåä¸‹æ‰€æœ‰é€šä¿¡éƒ½åœ¨å•ä¸ªè¿æ¥ä¸Šå®Œæˆï¼Œè¯¥è¿æ¥å¯ä»¥æ‰¿è½½ä»»æ„æ•°é‡çš„åŒå‘æ•°æ®æµï¼ˆå¹¶å‘ï¼‰ã€‚æµçš„å¤šè·¯å¤ç”¨æ„å‘³ç€åœ¨åŒä¸€è¿æ¥ä¸­æ¥è‡ªå„ä¸ªæµçš„æ•°æ®åŒ…ä¼šè¢«æ··åˆåœ¨ä¸€èµ·ï¼ŒStream Identifierå°†è¿æ¥ä¸Šä¼ è¾“çš„æ¯ä¸ªå¸§éƒ½å…³è”åˆ°ä¸€ä¸ªâ€œæµâ€ã€‚</p><p><strong>3. æµçš„ä¼˜å…ˆçº§å’Œä¾èµ–æ€§</strong><br>ä¼˜å…ˆçº§ï¼šæ¯ä¸ªæµéƒ½åŒ…å«ä¸€ä¸ªä¼˜å…ˆçº§ï¼ˆä¹Ÿå°±æ˜¯â€œæƒé‡â€ï¼‰ï¼Œå®ƒè¢«ç”¨æ¥å‘Šè¯‰å¯¹ç«¯å“ªä¸ªæµæ›´é‡è¦ã€‚<br>ä¾èµ–æ€§ï¼šå€ŸåŠ©äºPRIORITYå¸§ï¼Œå®¢æˆ·ç«¯å¯ä»¥å‘ŠçŸ¥æœåŠ¡å™¨å½“å‰çš„æµä¾èµ–äºå…¶ä»–å“ªä¸ªæµã€‚</p><p><strong>4. headerå‹ç¼©</strong><br>HTTP2 å¯¹æ¶ˆæ¯å¤´é‡‡ç”¨ <a href="https://www.ietf.org/rfc/rfc7541.txt" rel="external nofollow noopener noreferrer" target="_blank">HPACK</a>ï¼ˆä¸“ä¸ºhttp/2å¤´éƒ¨è®¾è®¡çš„å‹ç¼©æ ¼å¼ï¼‰è¿›è¡Œå‹ç¼©ä¼ è¾“ï¼Œèƒ½å¤ŸèŠ‚çœæ¶ˆæ¯å¤´å ç”¨çš„ç½‘ç»œçš„æµé‡ã€‚</p><p>HTTP2 å¯¹è¿™äº›é¦–éƒ¨é‡‡å–äº†å‹ç¼©ç­–ç•¥ï¼š</p><ol><li>HTTP2 åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä½¿ç”¨â€œé¦–éƒ¨è¡¨â€æ¥è·Ÿè¸ªå’Œå­˜å‚¨ä¹‹å‰å‘é€çš„é”®ï¼å€¼å¯¹ï¼Œå¯¹äºç›¸åŒçš„æ•°æ®ï¼Œä¸å†é€šè¿‡æ¯æ¬¡è¯·æ±‚å’Œå“åº”å‘é€ï¼›</li><li>é¦–éƒ¨è¡¨åœ¨HTTP2 çš„è¿æ¥å­˜ç»­æœŸå†…å§‹ç»ˆå­˜åœ¨ï¼Œç”±å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å…±åŒæ¸è¿›åœ°æ›´æ–°;</li><li>æ¯ä¸ªæ–°çš„é¦–éƒ¨é”®ï¼å€¼å¯¹è¦ä¹ˆè¢«è¿½åŠ åˆ°å½“å‰è¡¨çš„æœ«å°¾ï¼Œè¦ä¹ˆæ›¿æ¢è¡¨ä¸­ä¹‹å‰çš„å€¼ã€‚</li></ol><p><strong>5. é‡ç½®æ¶ˆæ¯</strong><br>Http2 é€šè¿‡å‘é€RST_STREAMå¸§å¯ç»ˆæ­¢å½“å‰ä¼ è¾“çš„æ¶ˆæ¯å¹¶é‡æ–°å‘é€ä¸€ä¸ªæ–°çš„ã€‚</p><p><strong>6. æœåŠ¡å™¨æ¨é€</strong><br>è¿™ä¸ªåŠŸèƒ½é€šå¸¸è¢«ç§°ä½œâ€œç¼“å­˜æ¨é€â€ã€‚ä¸»è¦çš„æ€æƒ³æ˜¯ï¼šå½“ä¸€ä¸ªå®¢æˆ·ç«¯è¯·æ±‚èµ„æºXï¼Œè€ŒæœåŠ¡å™¨çŸ¥é“å®ƒå¾ˆå¯èƒ½ä¹Ÿéœ€è¦èµ„æºZçš„æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨å¯ä»¥åœ¨å®¢æˆ·ç«¯å‘é€è¯·æ±‚å‰ï¼Œä¸»åŠ¨å°†èµ„æºZæ¨é€ç»™å®¢æˆ·ç«¯ã€‚è¿™ä¸ªåŠŸèƒ½å¸®åŠ©å®¢æˆ·ç«¯å°†Zæ”¾è¿›ç¼“å­˜ä»¥å¤‡å°†æ¥ä¹‹éœ€ã€‚</p><p>æœåŠ¡å™¨æ¨é€éœ€è¦å®¢æˆ·ç«¯æ˜¾å¼çš„å…è®¸æœåŠ¡å™¨æä¾›è¯¥åŠŸèƒ½ã€‚ä½†å³ä½¿å¦‚æ­¤ï¼Œå®¢æˆ·ç«¯ä¾ç„¶èƒ½è‡ªä¸»é€‰æ‹©æ˜¯å¦éœ€è¦ä¸­æ–­è¯¥æ¨é€çš„æµã€‚å¦‚æœä¸éœ€è¦çš„è¯ï¼Œå®¢æˆ·ç«¯å¯ä»¥é€šè¿‡å‘é€ä¸€ä¸ªRST_STREAMå¸§æ¥ä¸­æ­¢ã€‚</p><p><strong>7. æµé‡æ§åˆ¶</strong><br>ç±»ä¼¼TCPåè®®é€šè¿‡sliding windowçš„ç®—æ³•æ¥åšæµé‡æ§åˆ¶ï¼Œhttp2 ä½¿ç”¨ WINDOW_UPDATE frame æ¥åšæµé‡æ§åˆ¶ã€‚æ¯ä¸ªstreaméƒ½æœ‰æµé‡æ§åˆ¶ï¼Œè¿™ä¿è¯äº†æ•°æ®æ¥æ”¶æ–¹å¯ä»¥åªè®©è‡ªå·±éœ€è¦çš„æ•°æ®è¢«ä¼ è¾“ã€‚</p><p>åªæœ‰æ•°æ®å¸§ä¼šå—åˆ°æµé‡æ§åˆ¶ã€‚</p><p><img src="/images/2017/12/08/flow-control.png" alt="Flow Control"></p><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li>ã€Šå›¾è§£ HTTPã€‹</li><li><a href="https://ye11ow.gitbooks.io/http2-explained/content/part6.html" rel="external nofollow noopener noreferrer" target="_blank">Http2åè®®</a></li><li><a href="https://github.com/creeperyang/blog/issues/23" rel="external nofollow noopener noreferrer" target="_blank">HTTP2ç®€ä»‹å’ŒåŸºäºHTTP2çš„Webä¼˜åŒ–</a></li><li><a href="http://www.ruanyifeng.com/blog/2014/09/illustration-ssl.html" rel="external nofollow noopener noreferrer" target="_blank">å›¾è§£SSL/TLSåè®®</a></li></ul><!--ä»¥ä¸‹æ˜¯è„šæ³¨--><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style: none; padding-left: 0; margin-left: 40px"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">1.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">æ¯ä¸ªéç©ºçš„æ•°æ®å—ä¹‹å‰ï¼Œä¼šæœ‰ä¸€ä¸ª16è¿›åˆ¶çš„æ•°å€¼ï¼Œè¡¨ç¤ºè¿™ä¸ªå—çš„é•¿åº¦ã€‚æœ€åæ˜¯ä¸€ä¸ªå¤§å°ä¸º0çš„å—ï¼Œå°±è¡¨ç¤ºæœ¬æ¬¡å›åº”çš„æ•°æ®å‘é€å®Œäº†ã€‚<a href="#fnref:1" rev="footnote"> â†©</a></span></li><li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">2.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">åŠ å¯†å’Œè§£å¯†ä½¿ç”¨åŒä¸€ä¸ªå¯†é’¥ï¼›æ¶ˆè€—èµ„æºå°‘ä¸”å¿«<a href="#fnref:2" rev="footnote"> â†©</a></span></li><li id="fn:3"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">3.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">ä½¿ç”¨å…¬é’¥è¿›è¡ŒåŠ å¯†ï¼ˆå‘é€æ–¹ï¼‰ï¼Œä½¿ç”¨ç§é’¥è¿›è¡Œè§£å¯†ï¼ˆä½¿ç”¨æ–¹ï¼‰ï¼›æ¶ˆè€—èµ„æºå¤šä¸”æ…¢<a href="#fnref:3" rev="footnote"> â†©</a></span></li></ol></div></div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;Http-å†å²ç‰ˆæœ¬&quot;&gt;&lt;a href=&quot;#Http-å†å²ç‰ˆæœ¬&quot; c
      
    
    </summary>
    
      <category term="1-åŸºç¡€çŸ¥è¯†" scheme="http://yoursite.com/categories/1-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
      <category term="è®¡ç®—æœºç½‘ç»œ" scheme="http://yoursite.com/categories/1-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"/>
    
    
  </entry>
  
  <entry>
    <title>å¸¸è§é”™è¯¯</title>
    <link href="http://yoursite.com/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql/%E5%B8%B8%E8%A7%81%E9%94%99%E8%AF%AF/"/>
    <id>http://yoursite.com/2-å¼€å‘æŠ€èƒ½/æ•°æ®åº“/Mysql/å¸¸è§é”™è¯¯/</id>
    <published>2017-11-18T10:36:00.000Z</published>
    <updated>2017-12-03T16:04:44.531Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="ERROR-1205-HY000-Lock-wait-timeout-exceeded-try-restarting-transaction"><a href="#ERROR-1205-HY000-Lock-wait-timeout-exceeded-try-restarting-transaction" class="headerlink" title="ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transaction"></a>ERROR 1205 (HY000): Lock wait timeout exceeded; try restarting transaction</h1><p>åŸå› ï¼š<br>select @@autocommit;<br>+â€”â€”â€”â€”â€“+<br>| @@autocommit |<br>+â€”â€”â€”â€”â€“+<br>| 0            |<br>+â€”â€”â€”â€”â€“+<br>æ²¡æœ‰å¼€å¯è‡ªåŠ¨æäº¤ï¼Œå¯¼è‡´updateä¸€ç›´æœªcommitã€‚</p><p>è§£å†³ï¼š</p><ol><li>æŸ¥çœ‹æ˜¯å¦æœ‰æ…¢æŸ¥SQL</li><li>æŸ¥çœ‹innodbçš„äº‹åŠ¡è¡¨INNODB_TRXæ˜¯å¦æœ‰æ­£åœ¨é”å®šçš„äº‹åŠ¡çº¿ç¨‹,æœ‰çš„è¯çœ‹çœ‹IDæ˜¯å¦åœ¨show full processlisté‡Œé¢çš„sleepçº¿ç¨‹ä¸­ï¼Œå¦‚æœæ˜¯ï¼Œå°±è¯æ˜è¿™ä¸ªsleepçš„çº¿ç¨‹äº‹åŠ¡ä¸€ç›´æ²¡æœ‰commitæˆ–è€…rollbackè€Œæ˜¯å¡ä½äº†ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨killæ‰</li><li>å¼€å¯è‡ªåŠ¨æäº¤: set global autocommit=1;</li></ol><!--ä»¥ä¸‹æ˜¯è„šæ³¨-->]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;ERROR-1205-HY000-Lock-wait-timeou
      
    
    </summary>
    
      <category term="2-å¼€å‘æŠ€èƒ½" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/"/>
    
      <category term="æ•°æ®åº“" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="Mysql" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql/"/>
    
    
  </entry>
  
  <entry>
    <title>å¸¸ç”¨å‡½æ•°</title>
    <link href="http://yoursite.com/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql/%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0/"/>
    <id>http://yoursite.com/2-å¼€å‘æŠ€èƒ½/æ•°æ®åº“/Mysql/å¸¸ç”¨å‡½æ•°/</id>
    <published>2017-11-17T17:32:00.000Z</published>
    <updated>2017-12-03T16:04:44.530Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="è¿›åˆ¶è½¬æ¢å‡½æ•°"><a href="#è¿›åˆ¶è½¬æ¢å‡½æ•°" class="headerlink" title="è¿›åˆ¶è½¬æ¢å‡½æ•°"></a>è¿›åˆ¶è½¬æ¢å‡½æ•°</h1><p><code>CONV(N,from_base,to_base)</code> Næ˜¯è¦è½¬æ¢çš„æ•°æ®ï¼Œfrom_baseæ˜¯åŸè¿›åˆ¶ï¼Œto_baseæ˜¯ç›®æ ‡è¿›åˆ¶ã€‚</p><h1 id="å­—ç¬¦ä¸²å‡½æ•°"><a href="#å­—ç¬¦ä¸²å‡½æ•°" class="headerlink" title="å­—ç¬¦ä¸²å‡½æ•°"></a>å­—ç¬¦ä¸²å‡½æ•°</h1><p><code>substring(column,pos,length)</code>æˆªå–å­—ç¬¦ä¸².poså¼€å§‹çš„ä½ç½®ï¼Œlengthæˆªå–çš„é•¿åº¦<br><code>left(â€˜stringâ€™,length)</code>å–å·¦è¾¹lengthä¸ªå­—ç¬¦<br><code>right(â€˜stringâ€™,length)</code>å–å³è¾¹lengthä¸ªå­—ç¬¦</p><h1 id="æ’åºå‡½æ•°"><a href="#æ’åºå‡½æ•°" class="headerlink" title="æ’åºå‡½æ•°"></a>æ’åºå‡½æ•°</h1><p><code>field(column,â€™bâ€™,â€™aâ€™,â€™câ€™)</code>æ˜¾å¼çš„æ’åºï¼ŒæŒ‰ç…§bacæ’åº</p><h1 id="æ¡ä»¶å‡½æ•°"><a href="#æ¡ä»¶å‡½æ•°" class="headerlink" title="æ¡ä»¶å‡½æ•°"></a>æ¡ä»¶å‡½æ•°</h1><p><code>USING(id)</code> ç­‰äº on(a.id=b.id) //join onæ¡ä»¶çš„ç¼©å†™</p><h1 id="æ—¶é—´å‡½æ•°"><a href="#æ—¶é—´å‡½æ•°" class="headerlink" title="æ—¶é—´å‡½æ•°"></a>æ—¶é—´å‡½æ•°</h1><ul><li><code>unix_timestamp(â€˜2013-04-01â€™)</code></li><li><code>from_unixtime(â€˜1364745600â€™)</code></li></ul><h1 id="ipè½¬æ¢å‡½æ•°"><a href="#ipè½¬æ¢å‡½æ•°" class="headerlink" title="ipè½¬æ¢å‡½æ•°"></a>ipè½¬æ¢å‡½æ•°</h1><ul><li><code>inet_aton(â€˜192.168.1.1â€™)</code></li><li><code>inet_ntoa(â€˜3232235777 â€˜)</code></li></ul><!--ä»¥ä¸‹æ˜¯è„šæ³¨-->]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;è¿›åˆ¶è½¬æ¢å‡½æ•°&quot;&gt;&lt;a href=&quot;#è¿›åˆ¶è½¬æ¢å‡½æ•°&quot; class=&quot;
      
    
    </summary>
    
      <category term="2-å¼€å‘æŠ€èƒ½" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/"/>
    
      <category term="æ•°æ®åº“" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="Mysql" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql/"/>
    
    
      <category term="mysql" scheme="http://yoursite.com/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>å¸¸ç”¨SQL</title>
    <link href="http://yoursite.com/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql/%E5%B8%B8%E7%94%A8Sql/"/>
    <id>http://yoursite.com/2-å¼€å‘æŠ€èƒ½/æ•°æ®åº“/Mysql/å¸¸ç”¨Sql/</id>
    <published>2017-11-17T17:20:00.000Z</published>
    <updated>2017-12-03T16:04:44.530Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="æ‰¹é‡æ›´æ–°"><a href="#æ‰¹é‡æ›´æ–°" class="headerlink" title="æ‰¹é‡æ›´æ–°"></a>æ‰¹é‡æ›´æ–°</h1><p>gistï¼š<a href="https://gist.github.com/hlf513/035ae964db80e122c262" rel="external nofollow noopener noreferrer" target="_blank">multi_update.php</a></p><h1 id="åœ¨çº¿åŠ¨æ€æŠ“å–SQL"><a href="#åœ¨çº¿åŠ¨æ€æŠ“å–SQL" class="headerlink" title="åœ¨çº¿åŠ¨æ€æŠ“å–SQL"></a>åœ¨çº¿åŠ¨æ€æŠ“å–SQL</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcpdump -i eth0 -s 0 -l -w - dst port 3306|strings</span><br></pre></td></tr></table></figure><h1 id="éšæœºä¸€æ¡"><a href="#éšæœºä¸€æ¡" class="headerlink" title="éšæœºä¸€æ¡"></a>éšæœºä¸€æ¡</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> t1.*</span><br><span class="line"><span class="keyword">FROM</span> <span class="string">`table`</span> <span class="keyword">AS</span> t1 <span class="keyword">JOIN</span> (<span class="keyword">SELECT</span> <span class="keyword">ROUND</span>(<span class="keyword">RAND</span>() * (<span class="keyword">SELECT</span> <span class="keyword">MAX</span>(<span class="keyword">id</span>) <span class="keyword">FROM</span> <span class="string">`table`</span>)) <span class="keyword">AS</span> <span class="keyword">id</span>) <span class="keyword">AS</span> t2</span><br><span class="line"><span class="keyword">WHERE</span> t1.id &gt;= t2.id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> t1.id <span class="keyword">ASC</span> <span class="keyword">LIMIT</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure><h1 id="å¯¼å‡ºæ•°æ®å­—å…¸"><a href="#å¯¼å‡ºæ•°æ®å­—å…¸" class="headerlink" title="å¯¼å‡ºæ•°æ®å­—å…¸"></a>å¯¼å‡ºæ•°æ®å­—å…¸</h1><p>gistï¼š<a href="https://gist.github.com/hlf513/3ccaf696d3cd335dcaca" rel="external nofollow noopener noreferrer" target="_blank">generator_mysql_dict.php</a></p><h1 id="åˆ†é¡µ"><a href="#åˆ†é¡µ" class="headerlink" title="åˆ†é¡µ"></a>åˆ†é¡µ</h1><p>SQLé‡‡ç”¨å†…è¿æ¥ï¼ˆINNER JOINï¼‰å®ç°ï¼Œæ›´é«˜æ•ˆ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> cols <span class="keyword">from</span> <span class="keyword">tables</span> <span class="keyword">inner</span> <span class="keyword">join</span> (</span><br><span class="line">  <span class="keyword">select</span> pk <span class="keyword">from</span> <span class="keyword">tables</span></span><br><span class="line">    <span class="keyword">where</span> col1 = $col1 <span class="keyword">order</span> <span class="keyword">by</span> col2 <span class="keyword">limit</span> <span class="number">1000000</span>,<span class="number">10</span></span><br><span class="line">) <span class="keyword">using</span> (pk);</span><br></pre></td></tr></table></figure><h1 id="æ£€æŸ¥æ•°æ®è¡¨å¤§å°"><a href="#æ£€æŸ¥æ•°æ®è¡¨å¤§å°" class="headerlink" title="æ£€æŸ¥æ•°æ®è¡¨å¤§å°"></a>æ£€æŸ¥æ•°æ®è¡¨å¤§å°</h1><ol><li><p>è¿›å»æŒ‡å®š schema æ•°æ®åº“ï¼ˆå­˜æ”¾äº†å…¶ä»–çš„æ•°æ®åº“çš„ä¿¡æ¯ï¼‰</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; use information_schema;</span><br><span class="line">Database changed</span><br></pre></td></tr></table></figure></li><li><p>æŸ¥è¯¢æ‰€æœ‰æ•°æ®çš„å¤§å°</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select concat(round(sum(DATA_LENGTH/1024/1024), 2), 'MB')</span><br><span class="line">-&gt; as data from TABLES;</span><br><span class="line">+<span class="comment">-----------+</span></span><br><span class="line">| data |</span><br><span class="line">+<span class="comment">-----------+</span></span><br><span class="line">| 6674.48MB |</span><br><span class="line">+<span class="comment">-----------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">16.81</span> sec)</span><br></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹æŒ‡å®šæ•°æ®åº“å®ä¾‹çš„å¤§å°ï¼Œæ¯”å¦‚è¯´æ•°æ®åº“ forexpert</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select concat(round(sum(DATA_LENGTH/1024/1024), 2), 'MB')</span><br><span class="line">-&gt; as data from TABLES where table_schema='forexpert';</span><br><span class="line">+<span class="comment">-----------+</span></span><br><span class="line">| data |</span><br><span class="line">+<span class="comment">-----------+</span></span><br><span class="line">| 6542.30MB |</span><br><span class="line">+<span class="comment">-----------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">7.47</span> sec)</span><br></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹æŒ‡å®šæ•°æ®åº“çš„è¡¨çš„å¤§å°ï¼Œæ¯”å¦‚è¯´æ•°æ®åº“ forexpert ä¸­çš„ member è¡¨</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select concat(round(sum(DATA_LENGTH/1024/1024),2),'MB') as data</span><br><span class="line">-&gt; from TABLES where table_schema='forexpert'</span><br><span class="line">-&gt; and table_name='member';</span><br><span class="line">+<span class="comment">--------+</span></span><br><span class="line">| data |</span><br><span class="line">+<span class="comment">--------+</span></span><br><span class="line">| 2.52MB |</span><br><span class="line">+<span class="comment">--------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">1.88</span> sec)</span><br></pre></td></tr></table></figure></li></ol><h1 id="ä½¿ç”¨-OR-æ—¶-ä½¿ç”¨-union-all-æ›¿æ¢"><a href="#ä½¿ç”¨-OR-æ—¶-ä½¿ç”¨-union-all-æ›¿æ¢" class="headerlink" title="ä½¿ç”¨ OR æ—¶,ä½¿ç”¨ union all æ›¿æ¢"></a>ä½¿ç”¨ OR æ—¶,ä½¿ç”¨ union all æ›¿æ¢</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">table</span> <span class="keyword">where</span> <span class="keyword">id</span> = <span class="number">1</span> <span class="keyword">union</span> all <span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">table</span> <span class="keyword">where</span> <span class="keyword">id</span> =<span class="number">2</span>;</span><br></pre></td></tr></table></figure><h1 id="å¯¼å…¥å¯¼å‡ºæ•°æ®"><a href="#å¯¼å…¥å¯¼å‡ºæ•°æ®" class="headerlink" title="å¯¼å…¥å¯¼å‡ºæ•°æ®"></a>å¯¼å…¥å¯¼å‡ºæ•°æ®</h1><h2 id="å¯¼å…¥"><a href="#å¯¼å…¥" class="headerlink" title="å¯¼å…¥"></a>å¯¼å…¥</h2><ul><li><p>å¸¸è§„ä½¿ç”¨ values å¯¼å…¥<br>å­—æ®µé¡ºåºå¿…é¡»ä¸€è‡´</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;<span class="built_in">source</span> ~/dump.sql</span><br><span class="line">æˆ–</span><br><span class="line">mysql -u root -p database_name &lt; ~/dump.sql</span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨ load data infile<br>æ–¹å¼ä¸€ï¼šç›´æ¥å¯¼å…¥</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#$1,æ•°æ®æ–‡ä»¶çš„ç»å¯¹åœ°å€</span></span><br><span class="line">username=<span class="string">'root'</span></span><br><span class="line">password=<span class="string">''</span></span><br><span class="line">host=<span class="string">'127.0.0.1'</span></span><br><span class="line">database=<span class="string">"thirdsite_grab"</span></span><br><span class="line">table=<span class="string">"resumes_contacts"</span></span><br><span class="line">field=<span class="string">"src,src_no,resume_updated_at,name,phone,tel,email,create_at,updated_at,is_deleted,status,icdc_id,error_msg,source,type"</span></span><br><span class="line"><span class="keyword">if</span> [ -f <span class="string">"<span class="variable">$1</span>"</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">mysql -u <span class="variable">$username</span> -p<span class="variable">$passwoed</span> -h <span class="variable">$host</span> <span class="variable">$database</span> -e <span class="string">"load data local infile '<span class="variable">$1</span>' replace into table <span class="variable">$table</span> (<span class="variable">$field</span>)"</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$1</span><span class="string">'ä¸å­˜åœ¨'</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p>æ–¹å¼äºŒï¼šä¸æ›´æ–°ç´¢å¼•ï¼ŒåŠ å¿«å¯¼å…¥é€Ÿåº¦</p><ol><li>æ‰§è¡Œ <code>FLUSH TABLES</code> è¯­å¥æˆ–å‘½ä»¤ <code>mysqladmin flush-tables</code></li><li>ä½¿ç”¨<code>myisamchk â€“keys-used=0 -rq /path/to/db/tbl_name</code>ã€‚è¿™å°†ä»è¡¨ä¸­å–æ¶ˆæ‰€æœ‰ç´¢å¼•çš„ä½¿ç”¨</li><li>ç”¨<code>LOAD DATA INFILE</code>æŠŠæ•°æ®æ’å…¥åˆ°è¡¨ä¸­</li><li>ç”¨<code>myisamchk -r -q /path/to/db/tbl_name</code>é‡æ–°åˆ›å»ºç´¢å¼•.<br>è¿™å°†åœ¨å†™å…¥ç£ç›˜å‰åœ¨å†…å­˜ä¸­åˆ›å»ºç´¢å¼•æ ‘ï¼Œå¹¶ä¸”å®ƒæ›´å¿«ï¼Œå› ä¸ºé¿å…äº†å¤§é‡ç£ç›˜æœç´¢ã€‚ç»“æœç´¢å¼•æ ‘ä¹Ÿè¢«å®Œç¾åœ°å¹³è¡¡</li><li>æ‰§è¡Œ<code>FLUSH TABLES</code>è¯­å¥æˆ–<code>mysqladmin flush-tables</code>å‘½ä»¤ã€‚</li></ol><p>æ›´ç®€æ´çš„æ–¹å¼äºŒï¼š<br>ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œä¸éœ€è¦æ‰§è¡Œ<code>FLUSH TABLES</code>ã€‚</p><ol><li>ä½¿ç”¨<code>ALTER TABLE tbl_name DISABLE KEYS</code>ä»£æ›¿<code>myisamchk â€“keys-used=0 -rq/path/to/db/tbl_name</code>ï¼Œ</li><li>ä½¿ç”¨<code>ALTER TABLE tbl_name ENABLE KEYS</code>ä»£æ›¿<code>myisamchk -r -q/path/to/db/tbl_name</code>ã€‚</li></ol></li></ul><h2 id="å¯¼å‡º"><a href="#å¯¼å‡º" class="headerlink" title="å¯¼å‡º"></a>å¯¼å‡º</h2><ol><li><p>å¯¼å‡º sql</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -uxxx -pxxx -h127.0.0.1 database_name table_name -t --<span class="built_in">where</span>=<span class="string">"whereæ¡ä»¶"</span> &gt; dump.sql</span><br></pre></td></tr></table></figure></li><li><p>å¯¼å‡ºæ–‡æœ¬æ–‡ä»¶</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">username=<span class="string">'root'</span></span><br><span class="line">password=<span class="string">''</span></span><br><span class="line">host=<span class="string">'127.0.0.1'</span></span><br><span class="line">database=<span class="string">"thirdsite_grab"</span></span><br><span class="line">table=<span class="string">"resumes_contacts"</span></span><br><span class="line"><span class="keyword">if</span> [ -n <span class="string">"<span class="variable">$1</span>"</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">save_path=<span class="variable">$1</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">save_path=/tmp/export.data</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> [ -f <span class="string">"<span class="variable">$save_path</span>"</span> ]</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'åˆ é™¤æ—§æ–‡ä»¶'</span></span><br><span class="line">`rm <span class="variable">$save_path</span>`</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'ä¿å­˜è·¯å¾„ä¸º'</span><span class="variable">$save_path</span></span><br><span class="line">mysql -u <span class="variable">$user</span> -p<span class="variable">$password</span> <span class="variable">$database</span> -h <span class="variable">$host</span> -Ne <span class="string">"set names UTF8;select <span class="variable">$field</span> from <span class="variable">$table</span>"</span> &gt; <span class="variable">$save_path</span></span><br></pre></td></tr></table></figure></li></ol><h1 id="åˆ é™¤é‡å¤çš„æ•°æ®"><a href="#åˆ é™¤é‡å¤çš„æ•°æ®" class="headerlink" title="åˆ é™¤é‡å¤çš„æ•°æ®"></a>åˆ é™¤é‡å¤çš„æ•°æ®</h1><p>demoï¼šè¡¨åï¼›<br>idï¼šè‡ªå¢ IDï¼›<br>siteï¼šå…·æœ‰ç›¸åŒæ•°æ®çš„åˆ—</p><h2 id="åªæœ‰-crud-æƒé™"><a href="#åªæœ‰-crud-æƒé™" class="headerlink" title="åªæœ‰ crud æƒé™"></a>åªæœ‰ crud æƒé™</h2><ul><li><p>åˆ é™¤ ID å¤§çš„æ•°æ®</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> a <span class="keyword">using</span> demo <span class="keyword">as</span> a, demo <span class="keyword">as</span> b <span class="keyword">where</span> (a.id &gt; b.id) <span class="keyword">and</span> (a.site = b.site);</span><br></pre></td></tr></table></figure></li><li><p>åˆ é™¤ ID å°çš„æ•°æ®</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> a <span class="keyword">using</span> demo <span class="keyword">as</span> a, demo <span class="keyword">as</span> b <span class="keyword">where</span> (a.id &lt; b.id) <span class="keyword">and</span> (a.site = b.site);</span><br></pre></td></tr></table></figure></li></ul><h2 id="æœ‰ç´¢å¼•æƒé™"><a href="#æœ‰ç´¢å¼•æƒé™" class="headerlink" title="æœ‰ç´¢å¼•æƒé™"></a>æœ‰ç´¢å¼•æƒé™</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//è‡ªåŠ¨åˆ é™¤é‡å¤æ•°æ®ï¼ˆid å¤§çš„åˆ é™¤ï¼‰</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">ignore</span> <span class="keyword">table</span> demo <span class="keyword">add</span> <span class="keyword">unique</span> <span class="keyword">index</span> ukey (site);</span><br><span class="line">//åˆ é™¤åˆšå»ºç«‹çš„ç´¢å¼•</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> demo <span class="keyword">drop</span> <span class="keyword">index</span> ukey;</span><br></pre></td></tr></table></figure><!--ä»¥ä¸‹æ˜¯è„šæ³¨-->]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;æ‰¹é‡æ›´æ–°&quot;&gt;&lt;a href=&quot;#æ‰¹é‡æ›´æ–°&quot; class=&quot;head
      
    
    </summary>
    
      <category term="2-å¼€å‘æŠ€èƒ½" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/"/>
    
      <category term="æ•°æ®åº“" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="Mysql" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql/"/>
    
    
      <category term="mysql" scheme="http://yoursite.com/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>è¿ç»´æŒ‡å—</title>
    <link href="http://yoursite.com/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql/%E8%BF%90%E7%BB%B4%E6%8C%87%E5%8D%97/"/>
    <id>http://yoursite.com/2-å¼€å‘æŠ€èƒ½/æ•°æ®åº“/Mysql/è¿ç»´æŒ‡å—/</id>
    <published>2017-11-17T16:37:00.000Z</published>
    <updated>2017-12-03T16:04:44.533Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="ç³»ç»Ÿä¸è½¯ä»¶"><a href="#ç³»ç»Ÿä¸è½¯ä»¶" class="headerlink" title="ç³»ç»Ÿä¸è½¯ä»¶"></a>ç³»ç»Ÿä¸è½¯ä»¶</h1><h2 id="ç³»ç»Ÿ"><a href="#ç³»ç»Ÿ" class="headerlink" title="ç³»ç»Ÿ"></a>ç³»ç»Ÿ</h2><ul><li>ä¸€èˆ¬é€‰æ‹©RHELã€CentOS</li><li>æ‹’ç»ä½¿ç”¨32ä½ç³»ç»Ÿï¼Œå‡çº§åˆ°64ä½</li><li>ä¸è¿½æ–°ï¼Œç¨³å®šã€é«˜æ€§èƒ½å‹å€’ä¸€åˆ‡</li><li>ç‰ˆæœ¬ä¸€è‡´ï¼Œæ‰¹é‡éƒ¨ç½²ï¼Œç®¡ç†æ–¹ä¾¿</li><li>/tmpä½¿ç”¨/dev/shmçš„tmpfs</li></ul><h2 id="å†…æ ¸"><a href="#å†…æ ¸" class="headerlink" title="å†…æ ¸"></a>å†…æ ¸</h2><ul><li>IOè°ƒåº¦ï¼šdeadlineï¼Œnoopï¼Œåæ­£ä¸è¦cfq</li><li>VMç®¡ç†ï¼švm.swappiness=0</li></ul><h2 id="æ–‡ä»¶ç³»ç»Ÿ-xfs-zfs"><a href="#æ–‡ä»¶ç³»ç»Ÿ-xfs-zfs" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿ:xfs/zfs"></a>æ–‡ä»¶ç³»ç»Ÿ:xfs/zfs</h2><ul><li>å…¨B+æ ‘ï¼Œé«˜æ•ˆ</li><li>åˆ†é…ç»„ï¼Œæé«˜å¹¶å‘åº¦</li><li>å»¶è¿Ÿåˆ†é…ï¼Œå‡å°‘IO</li><li>mountï¼šnobarrierã€data=ordered,writeback</li></ul><h2 id="Mysqlä½¿ç”¨å†…å­˜ç›˜ï¼ˆæŒ‚è½½ï¼‰"><a href="#Mysqlä½¿ç”¨å†…å­˜ç›˜ï¼ˆæŒ‚è½½ï¼‰" class="headerlink" title="Mysqlä½¿ç”¨å†…å­˜ç›˜ï¼ˆæŒ‚è½½ï¼‰"></a>Mysqlä½¿ç”¨å†…å­˜ç›˜ï¼ˆæŒ‚è½½ï¼‰</h2><p>å°† MYSQL ç›®å½•è¿ç§»åˆ° 4G çš„å†…å­˜ç£ç›˜<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /mnt/ramdisk</span><br><span class="line">sudo mount -t tmpfs -o size=4000M tmpfs /mnt/ramdisk/</span><br><span class="line">mv /var/lib/mysql /mnt/ramdisk/mysql</span><br><span class="line">ln -s /tmp/ramdisk/mysql /var/lib/mysql</span><br><span class="line">chown mysql:mysql mysql</span><br></pre></td></tr></table></figure></p><h2 id="æ˜¯å¦å…³é—­swapï¼Ÿ"><a href="#æ˜¯å¦å…³é—­swapï¼Ÿ" class="headerlink" title="æ˜¯å¦å…³é—­swapï¼Ÿ"></a>æ˜¯å¦å…³é—­swapï¼Ÿ</h2><p>mysql ä¸“ç”¨æœåŠ¡å™¨åˆ™å…³é—­ swapï¼›å¦åˆ™ä¿è¯innodb_buffer_pool_sizeè¶³å¤Ÿå¤§</p><h2 id="å†…å­˜ä½¿ç”¨è€ƒé‡"><a href="#å†…å­˜ä½¿ç”¨è€ƒé‡" class="headerlink" title="å†…å­˜ä½¿ç”¨è€ƒé‡"></a>å†…å­˜ä½¿ç”¨è€ƒé‡</h2><ul><li>ç†è®ºä¸Šï¼Œå†…å­˜è¶Šå¤§ï¼Œè¶Šå¤šæ•°æ®è¯»å–å‘ç”Ÿåœ¨å†…å­˜ï¼Œæ•ˆç‡è¶Šé«˜</li><li>Query cacheçš„ä½¿ç”¨</li><li>å¦‚æœå‰ç«¯è¯·æ±‚é‡å¤åº¦ä¸é«˜ï¼Œæˆ–è€…åº”ç”¨å±‚å·²ç»å……åˆ†ç¼“å­˜é‡å¤è¯·æ±‚ï¼Œquery cacheä¸å¿…è®¾ç½®å¾ˆå¤§ï¼Œç”šè‡³å¯ä»¥ä¸è®¾ç½®ã€‚</li><li>å¦‚æœå‰ç«¯è¯·æ±‚é‡å¤åº¦è¾ƒé«˜ï¼Œæ— åº”ç”¨å±‚ç¼“å­˜ï¼Œquery cacheæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å·æ‡’é€‰æ‹©</li><li>å¯¹äºä¸­ç­‰ä»¥ä¸‹è§„æ¨¡æ•°æ®åº“åº”ç”¨ï¼Œå·æ‡’ä¸æ˜¯ä¸€ä¸ªåé€‰æ‹©ã€‚</li><li>å¦‚æœç¡®è®¤ä½¿ç”¨query cacheï¼Œè®°å¾—å®šæ—¶æ¸…ç†ç¢ç‰‡ï¼Œflush query cache.</li><li>è¦è€ƒè™‘åˆ°ç°å®çš„ç¡¬ä»¶èµ„æºå’Œç“¶é¢ˆåˆ†å¸ƒ</li><li>å­¦ä¼šç†è§£çƒ­ç‚¹æ•°æ®ï¼Œå¹¶å°†çƒ­ç‚¹æ•°æ®å°½å¯èƒ½å†…å­˜åŒ–</li><li>æ‰€è°“çƒ­ç‚¹æ•°æ®ï¼Œå°±æ˜¯æœ€å¤šè¢«è®¿é—®çš„æ•°æ®ã€‚</li><li>é€šå¸¸æ•°æ®åº“è®¿é—®æ˜¯ä¸å¹³å‡çš„ï¼Œå°‘æ•°æ•°æ®è¢«é¢‘ç¹è¯»å†™ï¼Œè€Œæ›´å¤šæ•°æ®é²œæœ‰è¯»å†™ã€‚</li><li>å­¦ä¼šåˆ¶å®šä¸åŒçš„çƒ­ç‚¹æ•°æ®è§„åˆ™ï¼Œå¹¶æµ‹ç®—æŒ‡æ ‡ã€‚</li><li>çƒ­ç‚¹æ•°æ®è§„æ¨¡ï¼Œç†è®ºä¸Šï¼Œçƒ­ç‚¹æ•°æ®è¶Šå°‘è¶Šå¥½ï¼Œè¿™æ ·å¯ä»¥æ›´å¥½çš„æ»¡è¶³ä¸šåŠ¡çš„å¢é•¿è¶‹åŠ¿ã€‚</li><li>å“åº”æ»¡è¶³åº¦ï¼Œå¯¹å“åº”çš„æ»¡è¶³ç‡è¶Šé«˜è¶Šå¥½ã€‚</li><li>æ¯”å¦‚ä¾æ®æœ€åæ›´æ–°æ—¶é—´ï¼Œæ€»è®¿é—®é‡ï¼Œå›è®¿æ¬¡æ•°ç­‰æŒ‡æ ‡å®šä¹‰çƒ­ç‚¹æ•°æ®ï¼Œå¹¶æµ‹ç®—ä¸åŒå®šä¹‰æ¨¡å¼ä¸‹çš„çƒ­ç‚¹æ•°æ®è§„æ¨¡</li></ul><h2 id="ç³»ç»Ÿä¼˜åŒ–"><a href="#ç³»ç»Ÿä¼˜åŒ–" class="headerlink" title="ç³»ç»Ÿä¼˜åŒ–"></a>ç³»ç»Ÿä¼˜åŒ–</h2><p><strong>vm.swappiness</strong><br>rhel6åŠä»¥ä¸‹è®¾ç½®ä¸º0 ï¼›rhel7ä»¥ä¸Šè®¾ç½®ä¸º10ï¼ˆ0 å¯èƒ½ä¼šè¢« oom kill æ‰ï¼‰</p><p><strong>/sys/block/sdX/queue/scheduler</strong></p><p>å†…æ ¸é»˜è®¤çš„ cfq å¾ˆçƒ‚ï¼Œä¸è¦ä½¿ç”¨<br>æ™®é€šçš„ sas ç›˜å»ºè®®ä½¿ç”¨ deadlineç­–ç•¥<br>ssd ä½¿ç”¨ noop æˆ–è€… deadlineï¼ˆè¿˜å¯ä»¥è®¾ç½® io scheduler ï¼‰</p><p><strong>æ–‡ä»¶ç³»ç»Ÿ</strong></p><p>é¦–é€‰xfsï¼Œå…¶æ¬¡ext4ï¼Œzfsä¹Ÿå¾ˆä¸é”™ï¼Œä½†åœ¨linuxä¸‹ä¸æ˜¯é‚£ä¹ˆå¯é (relserfsä¹Ÿä¸é”™ï¼Œä½†ä½œè€…è¢«æŠ“ï¼Œæ²¡äººç»´æŠ¤ï¼Œä¸å»ºè®®ä½¿ç”¨)<br>é«˜ io ä¸‹ä½¿ç”¨ xfsï¼Œä¸è¦ä½¿ç”¨ ext4ï¼ˆä¼šæœ‰ç“¶é¢ˆï¼‰å› ä¸ºï¼šext4ä¸‹%util åŸºæœ¬åˆ°äº†100%ï¼Œå†ä¹Ÿä¸Šä¸å»äº†ï¼›è€Œ xfs è¿˜æœ‰ä¸Šå‡çš„ç©ºé—´</p><p><strong>æ–‡ä»¶ç³»ç»Ÿæ•°æ®ç»“æ„</strong><br>xfs ç›®å½•å†…å®¹ b+treeï¼Œæ–‡ä»¶åˆ†é…b+tree<br>ext4 -&gt; htreeï¼ˆç‰¹æ®Š b æ ‘ï¼‰-&gt; extents/bitmap<br>ext3 -&gt; htree -&gt; bitmap</p><p><strong>æŸ¥çœ‹ç°åœ¨æ–‡ä»¶ç³»ç»Ÿçš„å‘½ä»¤</strong><br>df -HT</p><h1 id="å‚æ•°é…ç½®"><a href="#å‚æ•°é…ç½®" class="headerlink" title="å‚æ•°é…ç½®"></a>å‚æ•°é…ç½®</h1><p><a href="http://imysql.com/my_cnf_generator" rel="external nofollow noopener noreferrer" target="_blank">è€å¶çš„ my.cnf ç”Ÿæˆå™¨</a></p><h2 id="myisam-å‚æ•°"><a href="#myisam-å‚æ•°" class="headerlink" title="myisam å‚æ•°"></a>myisam å‚æ•°</h2><p>MyISAMå­˜å‚¨å¼•æ“æœ‰ä¸€ä¸ªç³»ç»Ÿå˜é‡concurrent_insertï¼Œä¸“é—¨ç”¨ä»¥æ§åˆ¶å…¶å¹¶å‘æ’å…¥çš„è¡Œä¸ºï¼Œå…¶å€¼åˆ†åˆ«å¯ä»¥ä¸º0ã€1æˆ–2ã€‚<br>å½“concurrent_insertè®¾ç½®ä¸º0æ—¶ï¼Œä¸å…è®¸å¹¶å‘æ’å…¥ã€‚<br>å½“concurrent_insertè®¾ç½®ä¸º1æ—¶ï¼Œå¦‚æœMyISAMè¡¨ä¸­æ²¡æœ‰ç©ºæ´ï¼ˆå³è¡¨çš„ä¸­é—´æ²¡æœ‰è¢«åˆ é™¤çš„è¡Œï¼‰ï¼ŒMyISAMå…è®¸åœ¨ä¸€ä¸ªè¿›ç¨‹è¯»è¡¨çš„åŒæ—¶ï¼Œå¦ä¸€ä¸ªè¿›ç¨‹ä»è¡¨å°¾æ’å…¥è®°å½•ã€‚è¿™ä¹Ÿæ˜¯MySQLçš„é»˜è®¤è®¾ç½®ã€‚<br>å½“concurrent_insertè®¾ç½®ä¸º2æ—¶ï¼Œæ— è®ºMyISAMè¡¨ä¸­æœ‰æ²¡æœ‰ç©ºæ´ï¼Œéƒ½å…è®¸åœ¨è¡¨å°¾å¹¶å‘æ’å…¥è®°å½•ã€‚</p><p>MyISAMçš„é”è°ƒåº¦</p><p>MyISAMå­˜å‚¨å¼•æ“çš„è¯»é”å’Œå†™é”æ˜¯äº’æ–¥çš„ï¼Œè¯»å†™æ“ä½œæ˜¯ä¸²è¡Œçš„ã€‚é‚£ä¹ˆï¼Œä¸€ä¸ªè¿›ç¨‹è¯·æ±‚æŸä¸ªMyISAMè¡¨çš„è¯»é”ï¼ŒåŒæ—¶å¦ä¸€ä¸ªè¿›ç¨‹ä¹Ÿè¯·æ±‚åŒä¸€è¡¨çš„å†™é”ï¼ŒMySQLå¦‚ä½•å¤„ç†å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å†™è¿›ç¨‹å…ˆè·å¾—é”ã€‚ä¸ä»…å¦‚æ­¤ï¼Œå³ä½¿è¯»è¯·æ±‚å…ˆåˆ°é”ç­‰å¾…é˜Ÿåˆ—ï¼Œå†™è¯·æ±‚ååˆ°ï¼Œå†™é”ä¹Ÿä¼šæ’åˆ°è¯»é”è¯·æ±‚ä¹‹å‰ï¼è¿™æ˜¯å› ä¸ºMySQLè®¤ä¸ºå†™è¯·æ±‚ä¸€èˆ¬æ¯”è¯»è¯·æ±‚è¦é‡è¦ã€‚è¿™ä¹Ÿæ­£æ˜¯MyISAMè¡¨ä¸å¤ªé€‚åˆäºæœ‰å¤§é‡æ›´æ–°æ“ä½œå’ŒæŸ¥è¯¢æ“ä½œåº”ç”¨çš„åŸå› ï¼Œå› ä¸ºï¼Œå¤§é‡çš„æ›´æ–°æ“ä½œä¼šé€ æˆæŸ¥è¯¢æ“ä½œå¾ˆéš¾è·å¾—è¯»é”ï¼Œä»è€Œå¯èƒ½æ°¸è¿œé˜»å¡ã€‚è¿™ç§æƒ…å†µæœ‰æ—¶å¯èƒ½ä¼šå˜å¾—éå¸¸ç³Ÿç³•ï¼å¹¸å¥½æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›è®¾ç½®æ¥è°ƒèŠ‚MyISAMçš„è°ƒåº¦è¡Œä¸ºã€‚</p><p>é€šè¿‡æŒ‡å®šå¯åŠ¨å‚æ•°low-priority-updatesï¼Œä½¿MyISAMå¼•æ“é»˜è®¤ç»™äºˆè¯»è¯·æ±‚ä»¥ä¼˜å…ˆçš„æƒåˆ©ã€‚</p><p>é€šè¿‡æ‰§è¡Œå‘½ä»¤SET LOW_PRIORITY_UPDATES=1ï¼Œä½¿è¯¥è¿æ¥å‘å‡ºçš„æ›´æ–°è¯·æ±‚ä¼˜å…ˆçº§é™ä½ã€‚</p><p>é€šè¿‡æŒ‡å®šINSERTã€UPDATEã€DELETEè¯­å¥çš„LOW_PRIORITYå±æ€§ï¼Œé™ä½è¯¥è¯­å¥çš„ä¼˜å…ˆçº§ã€‚</p><h2 id="å…³æ³¨çš„å‚æ•°"><a href="#å…³æ³¨çš„å‚æ•°" class="headerlink" title="å…³æ³¨çš„å‚æ•°"></a>å…³æ³¨çš„å‚æ•°</h2><h3 id="å…¨å±€å‚æ•°"><a href="#å…¨å±€å‚æ•°" class="headerlink" title="å…¨å±€å‚æ•°"></a>å…¨å±€å‚æ•°</h3><ul><li><p>interactive_timeout/wait_timeout<br>æ–­å¼€æ´»è·ƒè¿æ¥è¶…æ—¶çš„æ—¶é—´/æ–­å¼€ä¸æ´»è·ƒè¿æ¥çš„è¶…æ—¶æ—¶é—´<br>å‰è€…æ•°å€¼åŸºæœ¬ä¸Šç»§æ‰¿ä¸åè€…;å»ºè®®ä¸¤è€…è®¾ç½®ä¸€æ ·.<br>1.æœ‰è¿æ¥æ± ï¼Œtimeout è°ƒå¤§ä¸€äº›ï¼Œæˆ–è€…é»˜è®¤å€¼<br>2.æ— è¿æ¥æ± ï¼Œå»ºè®®è®¾ç½®300ä»¥å†…ï¼ˆç†è®ºæ˜¯è¶Šå°è¶Šå¥½ï¼ŒçœŸæ­£çš„å€¼æ ¹æ®ä¸šåŠ¡bï¼‰</p></li><li><p>open_files_limit<br>æ­¤é€‰é¡¹ä¸å¤Ÿæ—¶çš„é”™è¯¯ï¼š<br>canâ€™t  open file : \test\â€¦..(error:24)<br>sh&gt; perror 24 #æŸ¥çœ‹é”™è¯¯24çš„å«ä¹‰<br>OS error code 24: too many open files<br>å¦‚ä½•è°ƒæ•´ï¼Ÿ</p><ol><li>è°ƒæ•´æ­¤å‚æ•°çš„é™åˆ¶</li><li>ulimit -n ä¿®æ”¹å†…æ ¸çº§åˆ«çš„é™åˆ¶</li></ol></li><li><p>max_connections<br>è¿æ¥æ•°ä¸å¤Ÿç”¨ï¼Œå»ºè®®ä¸šåŠ¡æ–¹è¿›è¡Œä¼˜åŒ–ï¼Œä¿è¯è¿æ¥æ•°å¯ç”¨ï¼Œä¸æ˜¯ä¸€å‘³çš„è°ƒå¤§è¿æ¥æ•°<br>æœ‰å¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿé›ªå´©/oom_killer<br>å»ºè®®</p><ol><li>ä¸´æ—¶è°ƒé«˜æ•°é‡ï¼Œè®©ä¸šåŠ¡ä¼˜åŒ–sql</li><li>è°ƒä½ timeout çš„å€¼</li></ol></li><li><p>å’Œ open_files_limitç±»ä¼¼çš„é—®é¢˜<br>é—®é¢˜ï¼š<br><code>Can not connect to Mysql Server</code><br><code>1135: Can&#39;t create a new thread(errno 12);if you are not out of available memory, you can consult the manual for a possible OS-dependent bug</code><br> è§£å†³ï¼š</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/security/limits.d/90-nproc.conf</span><br><span class="line">nproc æ”¹ä¸º 65536</span><br><span class="line"> æˆ–è€…</span><br><span class="line">vi /etc/bashrc</span><br><span class="line">ulimit -u 65536</span><br></pre></td></tr></table></figure></li><li><p>thread_pool<br>å®˜æ–¹ç‰ˆæœ¬ä¸æ”¯æŒæ­¤åŠŸèƒ½ï¼ˆçº¿ç¨‹æ± ï¼‰ï¼›å¯ä»¥ä½¿ç”¨ percona,mariadb åˆ†æ”¯ç‰ˆæœ¬<br><a href="http://imysql.com/2014/07/02/percona-thread-pool-benchmark-testing.shtml" rel="external nofollow noopener noreferrer" target="_blank">http://imysql.com/2014/07/02/percona-thread-pool-benchmark-testing.shtml</a><br>çº¿ç¨‹æ± ä½œç”¨ï¼šè®©çº¿ç¨‹åˆ†ç»„å»å¤„ç†ï¼Œè€Œä¸æ˜¯é˜»å¡ç­‰å¾…å¤„ç†</p></li></ul><h3 id="å†…å­˜å‚æ•°"><a href="#å†…å­˜å‚æ•°" class="headerlink" title="å†…å­˜å‚æ•°"></a>å†…å­˜å‚æ•°</h3><p><img src="/images/2017/11/18/memory.png" alt="memory"></p><ul><li>tmp_table_size/max_heap_table_size<br>ä¸è¦æŠŠ tmp_table_size ã€max_heap_table_sizeï¼ˆè¿™ä¸ªæ˜¯ä¼šè¯çº§åˆ«ï¼‰ è®¾ç½®è¿‡å¤§ï¼Œå»ºè®®ä¸é«˜äº100M</li></ul><h3 id="innodbå‚æ•°"><a href="#innodbå‚æ•°" class="headerlink" title="innodbå‚æ•°"></a>innodbå‚æ•°</h3><ul><li><p>innodb_buffer_pool<br>å»ºè®®è®¾ç½®50-70%ï¼Œç¼“å­˜å¤§é‡çš„è„æ•°æ®ï¼Œäº‹åŠ¡ä¿¡æ¯ï¼Œé”ä¿¡æ¯ç­‰ï¼›ä¿è¯ä¸ä¼š oom çš„å‰æä¸‹ï¼Œå¯ä»¥è®¾ç½®80%æˆ–æ›´é«˜ï¼›éä¸“ä¸šäººå£«ï¼Œä¸å»ºè®®è®¾ç½®è¿‡é«˜ã€‚<br>è®¾ç½®å¤ªå°çš„è¯ï¼š</p><ol><li>tps å¾ˆä½ï¼Œå¤§é‡ç­‰å¾…</li><li>å¯èƒ½ä¼š table full</li><li>é”ä¸å¤Ÿç”¨</li></ol></li><li><p>innodb_data_file_path<br>é»˜è®¤åªæœ‰10mï¼Œibdata1åˆå§‹åŒ–æ—¶ï¼Œè‡³å°‘è®¾ç½®1G<br>å‚è€ƒï¼š <a href="http://imysql.com/2010/06/01/mysql-faq-what-contains-with-ibdata1.html" rel="external nofollow noopener noreferrer" target="_blank">http://imysql.com/2010/06/01/mysql-faq-what-contains-with-ibdata1.html</a><br>Innodb å…±äº«è¡¨ç©ºé—´æ–‡ä»¶ ibdata1 ä¸­å­˜å‚¨äº†ä»¥ä¸‹å‡ éƒ¨åˆ†ä¿¡æ¯ï¼š</p><ol><li>Data dictionary</li><li>Double write buffer</li><li>Insert buffer</li><li>Rollback segments</li><li>UNDO space</li></ol><p>å› æ­¤åœ¨åˆå§‹åŒ–ibdata1æ—¶ï¼Œæœ€å¥½è®¾ç½®å¤§ä¸€äº›ï¼Œè¿™æ ·å¯ä»¥é¿å…é«˜å¹¶å‘ä¸‹å¯¼è‡´ibdata1æ€¥å‰§å¢å¤§ï¼Œå¤§å¤§å½±å“æ€§èƒ½</p></li><li><p>innodb_flush_log_at_trx_commit<br>0\1\2\<br>æ¯ç§’\æ¯äº‹åŠ¡\0å’Œ1çš„æŠ˜ä¸­ï¼ˆåˆ·æ–° logå…¥ç£ç›˜ï¼‰</p></li><li><p>transaction_isolation<br>äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼šé»˜è®¤æ˜¯ RRï¼ˆå¯é‡å¤è¯»ï¼‰ï¼Œå»ºè®®ä½¿ç”¨ RR<br>ä¸å»ºè®®ä½¿ç”¨ RCï¼ŒRCå¹¶å‘æé«˜äº†ï¼Œé”ç­‰å¾…å¾ˆä¸¥é‡ï¼Œtpmc å¹¶æ²¡æé«˜å¤šå°‘</p></li><li><p>innodb_log_file_size &amp; innodb_log_buffer_size<br>è‹¥1åˆ†é’Ÿäº§ç”Ÿ10mäº‹åŠ¡ï¼Œåˆ™ log_buffer è®¾ç½®64mï¼›100mäº‹åŠ¡åˆ™è®¾ç½®512mï¼›ä¸€èˆ¬ä¸å»ºè®®è¶…è¿‡512mï¼›è‹¥å‘ç”Ÿ innodb_log_buffer_wait_freeäº‹ä»¶ï¼Œåˆ™éœ€è¦è°ƒæ•´<br>ä¸æ˜“è®¾ç½®è¿‡å¤§ï¼Œå› ä¸ºè‹¥ mysql æŒ‚æ‰ï¼Œé‡å¯æ—¶ä¼šè¯» logæ¢å¤ï¼›è¶Šå¤§æ¢å¤è¶Šæ…¢</p></li><li><p>innodb_file_per_table=1<br>ä¸ºæ¯ä¸ªè¡¨åˆ†åˆ«åˆ›å»º InnoDB FILEï¼›é˜²æ­¢ibdata1 æ–‡ä»¶è¿‡å¤§</p></li><li><p>innodb_buffer_pool_size<br>å°†æ•°æ®å®Œå…¨ä¿å­˜åœ¨innodb_buffer_pool_sizeï¼ˆå†…å­˜ï¼‰ä¸­</p><ul><li>å¦‚ä½•ç¡®å®šå–å€¼ï¼Ÿ<pre><code>mysql&gt; SHOW GLOBAL STATUS LIKE &apos;innodb_buffer_pool_pages_%&apos;;//Innodb_buffer_pool_pages_free = 0 åˆ™è¯´æ˜éœ€è¦å¢åŠ //innodb_additional_mem_pool_size = 1/200 of buffer_pool//innodb_max_dirty_pages_pct 80%</code></pre></li></ul></li><li><p>innodb_log_file_size<br>æ¨èinnodb_log_file_size è®¾ç½®ä¸º 0.25 * innodb_buffer_pool_size<br>å¦‚æœç”¨ 1G çš„ innodb_log_file_size ï¼Œå‡å¦‚æœåŠ¡å™¨å®•æœºï¼Œéœ€è¦ 10 åˆ†é’Ÿæ¥æ¢å¤ã€‚</p></li><li><p>innodb_flush_log_at_trx_commit<br>è¿™ä¸ªé€‰é¡¹å’Œå†™ç£ç›˜æ“ä½œå¯†åˆ‡ç›¸å…³ï¼š</p><pre><code>innodb_flush_log_at_trx_commit = 1 åˆ™æ¯æ¬¡ä¿®æ”¹å†™å…¥ç£ç›˜innodb_flush_log_at_trx_commit = 0/2 æ¯ç§’å†™å…¥ç£ç›˜</code></pre><p>å¦‚æœä½ çš„åº”ç”¨ä¸æ¶‰åŠå¾ˆé«˜çš„å®‰å…¨æ€§ (é‡‘èç³»ç»Ÿ)ï¼Œæˆ–è€…åŸºç¡€æ¶æ„è¶³å¤Ÿå®‰å…¨ï¼Œæˆ–è€… äº‹åŠ¡éƒ½å¾ˆå°ï¼Œéƒ½å¯ä»¥ç”¨ 0 æˆ–è€… 2 æ¥é™ä½ç£ç›˜æ“ä½œã€‚</p></li><li><p>innodb_flush_method=O_DIRECT<br>é¿å…åŒå†™å…¥ç¼“å†²</p></li></ul><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><ul><li><p>general_log<br>é€šå¸¸ä¸æ‰“å¼€ï¼Œå¦åˆ™ä¼šä½¿æ–‡ä»¶å¾ˆå¤§ï¼Œä¼šå¸¦æ¥mysql äº‹åŠ¡æ€§èƒ½ä¸‹é™<br>å› ä¸ºï¼š è®°å½•å…¨éƒ¨ general log æ—¶ tpmc å¤§çº¦æ˜¯ä¸æ‰“å¼€ log æ—¶çš„73.28%ï¼Œè€Œè®°å½•å…¨éƒ¨ slow log æ—¶çš„ tpmc å¤§çº¦æ˜¯ä¸æ‰“å¼€ log æ—¶çš„59.53%<br><a href="http://imysql.com/2014/09/01/mysql-faq-impact-of-generallog.shtml" rel="external nofollow noopener noreferrer" target="_blank">http://imysql.com/2014/09/01/mysql-faq-impact-of-generallog.shtml</a></p></li><li><p>innodb_max_dirty_pages_pct</p></li><li><p>log_bin<br>ä¸€å®šè¦æ‰“å¼€ï¼Œæ•°æ®ä¸¢å¤±å¯æ‰¾å›ï¼›å½±å“ï¼šæ€§èƒ½ä¸‹é™46%ï¼Œå¯ç”¨èµ‹å€¼æˆ–è¦æ±‚æ•°æ®ç¾éš¾æ—¶æŸå¤±æœ€å°ï¼Œå¿…é¡»å¼€å¯è¯¥åŠŸèƒ½ï¼Œè¿™æ—¶è€ƒè™‘ log_binä¸æ•°æ®éš”ç¦»æˆ–è€…ä½¿ç”¨ io èƒ½åŠ›å¼ºè®¾å¤‡ï¼Œå¯æé«˜å“åº”ï¼Œå¯†é›†å†™å¾ˆé«˜çš„åº”ç”¨è¦å¯ç”¨ ssd è®¾å¤‡ï¼Œæ¥ç¼“è§£è¯¥ç±»å‹åŠ›<br>binlog æ˜¯é¡ºåºå†™ï¼›å¯ç”¨ raid0æˆ–1æ¥ä¸“é—¨å­˜ binlog.<br>ä¸»ä»ç»“æ„æ—¶ï¼Œä»çš„ bin_log ä¹Ÿæ‰“å¼€</p></li><li><p>long_query_time<br>ä¸è¦è®¾ç½®ä¸º0 ï¼ˆ0çš„ä½œç”¨ï¼šæ¯ä¸ª sql è®°å½•å’Œ general_log çš„ä½œç”¨ç›¸å½“ï¼‰ï¼›å¯ä»¥è®¾ç½®ä¸º0.01ï¼Œ0.1ç­‰å…¶ä»–å€¼</p></li><li><p>sync_binlog<br>éœ€è¦å¾ˆé«˜çš„æ•°æ®ä¸€è‡´æ€§ï¼Œè®¾ç½®ä¸º1ï¼ˆæ¯ä¸ª sql éƒ½è¦åˆ·å…¥ binlogï¼‰ï¼›ä¸ç‰¹åˆ«éœ€è¦æ—¶ï¼Œå¯è®¾ç½®ä¸º2ï¼Œ3ï¼Œ10ç­‰æ›´é«˜ï¼›ä¸éœ€è¦æ—¶è®¾ä¸º0</p></li><li><p>log_slow_query<br>åˆ†ææ…¢æŸ¥è¯¢ç”¨</p></li><li><p>table_open_cache</p></li><li><p>key_buffer_size</p></li><li><p>query_cache_size</p></li><li><p>memlock</p></li></ul><h1 id="æ•°æ®é¢„çƒ­"><a href="#æ•°æ®é¢„çƒ­" class="headerlink" title="æ•°æ®é¢„çƒ­"></a>æ•°æ®é¢„çƒ­</h1><p><strong>å¦‚ä½•é¢„çƒ­ï¼Ÿ</strong><br>åŸºäº innodb_buffer_pool çš„å¤‡ä»½å’ŒåŠ è½½ï¼›å› ä¸ºæ•°æ®åªæœ‰åœ¨æ‰§è¡Œä¸€æ¬¡ï¼Œæ‰èƒ½åŠ è½½åˆ°innodb_buffer_pool</p><h1 id="ç¡¬ä»¶"><a href="#ç¡¬ä»¶" class="headerlink" title="ç¡¬ä»¶"></a>ç¡¬ä»¶</h1><h2 id="åŸåˆ™"><a href="#åŸåˆ™" class="headerlink" title="åŸåˆ™"></a>åŸåˆ™</h2><ul><li>æ€§èƒ½å·®ä¸å¤šï¼Œå…³é”®æ˜¯å¯é æ€§</li><li>ä¸Šçº¿å‰çƒ¤æœºæµ‹è¯•éå¸¸é‡è¦</li><li>ç›‘æ§é¢„è­¦å¯æœ‰æ•ˆé¢„é˜²æ•…éšœ</li><li>é¿å…ä½¿ç”¨å¤–éƒ¨é˜µåˆ—</li><li>æœ€å¥½æ˜¯2Uæœºå‹ï¼Œå¹¶ä¸”é…å¤‡RAIDå¡(with BBU)</li></ul><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><ul><li>æ‰€æœ‰ç£ç›˜ç»„å»ºå¤§é˜µåˆ—ï¼Œä¸é™ä½IOPS</li><li>é»˜è®¤é˜µåˆ—çº§åˆ«ä¸ºï¼šraid 1+0</li><li>ç»“åˆä¸šåŠ¡ç‰¹å¾è®¾ç½®ä¸»æœºåï¼Œå”¯ä¸€å‘½å</li><li>åˆç†åˆ©ç”¨hosts/dnsï¼Œå¯ç”¨äºåº”ç”¨æˆæƒç®¡ç†</li><li>masterå’Œslaveå‘½ååŒºåˆ†å¼€</li><li>/tmpä½¿ç”¨/dev/shm &amp; tmpfs</li><li>éƒ¨ç½²åŸºæœ¬å·¥å…·åŒ…ï¼šsysstatã€oprofileç­‰</li></ul><h2 id="BIOS-è®¾ç½®ä¼˜åŒ–"><a href="#BIOS-è®¾ç½®ä¼˜åŒ–" class="headerlink" title="BIOS è®¾ç½®ä¼˜åŒ–"></a>BIOS è®¾ç½®ä¼˜åŒ–</h2><ul><li>System Profileï¼ˆç³»ç»Ÿé…ç½®ï¼‰é€‰æ‹©Performance Per Watt Optimized(DAPC)ï¼Œå‘æŒ¥æœ€å¤§åŠŸè€—æ€§èƒ½ï¼Œå……åˆ†åˆ©ç”¨ cpu</li><li>Memory Frequencyï¼ˆå†…å­˜é¢‘ç‡ï¼‰é€‰æ‹©Maximum Performanceï¼ˆæœ€ä½³æ€§èƒ½ï¼‰</li><li>C1Eï¼Œå…è®¸åœ¨å¤„ç†å™¨å¤„äºé—²ç½®çŠ¶æ€æ—¶å¯ç”¨æˆ–ç¦ç”¨å¤„ç†å™¨åˆ‡æ¢è‡³æœ€ä½æ€§èƒ½çŠ¶æ€ï¼Œå»ºè®®å…³é—­ ï¼ˆé»˜è®¤å¯ç”¨ï¼‰</li><li>C Statesï¼ˆCçŠ¶æ€ï¼‰ï¼Œå…è®¸å¯ç”¨æˆ–ç¦ç”¨å¤„ç†å™¨åœ¨æ‰€æœ‰å¯ç”¨ç”µæºçŠ¶æ€ä¸‹è¿è¡Œï¼Œå»ºè®®å…³é—­ï¼ˆé»˜ è®¤å¯ç”¨ï¼‰</li></ul><h2 id="IO-å­ç³»ç»Ÿä¼˜åŒ–"><a href="#IO-å­ç³»ç»Ÿä¼˜åŒ–" class="headerlink" title="IO å­ç³»ç»Ÿä¼˜åŒ–"></a>IO å­ç³»ç»Ÿä¼˜åŒ–</h2><ul><li>ä¸“ä¸šçš„é˜µåˆ—å¡é…å¤‡CACHEï¼ˆå¤§éƒ¨åˆ†æ˜¯1Gï¼Œ4G å¾ˆå°‘ï¼‰åŠBBUæ¨¡å—ï¼ˆç»™ç¼“å­˜æä¾›åå¤‡ç”µé‡ï¼‰ï¼Œæé«˜IOPS</li><li>cache ç­–ç•¥è®¾ç½®å†™ç­–ç•¥ä¸ºWBï¼ˆwirte backï¼‰ï¼Œæˆ–è€…FORCE WBï¼Œç¦ç”¨WTç­–ç•¥<br>WB: è®©æ•°æ®å…ˆå†™å…¥ cacheï¼Œå†å†™å›ç£ç›˜</li><li>é˜µåˆ—å¡é…ç½®å…³é—­é¢„è¯»ï¼Œæ²¡å¿…è¦é¢„è¯»ï¼Œé‚£ç‚¹å®è´µçš„CACHEç”¨æ¥åšå†™ç¼“å­˜</li><li>é˜µåˆ—çº§åˆ«ä½¿ç”¨RAID 1+0ï¼Œè€Œä¸æ˜¯RAID 5 (1+0çš„ioså†™æ€§èƒ½æ¯”5é«˜)</li><li>å…³é—­ç‰©ç†ç£ç›˜cacheç­–ç•¥ï¼ˆéé˜µåˆ—å¡çš„ cacheï¼‰ï¼Œé˜²æ­¢æ–­ç”µæ—¶ä¸¢æ•°æ®</li><li>ä½¿ç”¨é«˜è½¬é€Ÿç¡¬ç›˜ï¼Œä¸ä½¿ç”¨ä½è½¬é€Ÿç›˜<br>æœ€ä½1w è½¬ï¼Œæœ€å¥½æ˜¯1.5w</li><li>ä½¿ç”¨SSDæˆ–è€…PCIe-SSDç›˜<br>ssdæ€§èƒ½æ¯” sata ç¡¬ç›˜æå‡å‡ ç™¾å€<br>pcle-ssd æå‡ä¸Šä¸‡å€</li></ul><h1 id="ç›‘æ§ã€å®‰å…¨ä¸å¤‡ä»½"><a href="#ç›‘æ§ã€å®‰å…¨ä¸å¤‡ä»½" class="headerlink" title="ç›‘æ§ã€å®‰å…¨ä¸å¤‡ä»½"></a>ç›‘æ§ã€å®‰å…¨ä¸å¤‡ä»½</h1><h2 id="ç›‘æ§"><a href="#ç›‘æ§" class="headerlink" title="ç›‘æ§"></a>ç›‘æ§</h2><ul><li>ç›‘æ§ä¸æ•°æ®åˆ†ææ˜¯ä¸€åˆ‡ä¼˜åŒ–çš„åŸºç¡€ã€‚</li><li>æ²¡æœ‰è¿è¥æ•°æ®ç›‘æµ‹å°±ä¸è¦å¦„è°ˆä¼˜åŒ–ï¼</li><li>ç›‘æ§è¦æ³¨æ„ä¸è¦äº§ç”Ÿå¤ªå¤šé¢å¤–çš„è´Ÿè½½ï¼Œä¸è¦å› ç›‘æ§å¸¦æ¥å¤ªå¤šé¢å¤–ç³»ç»Ÿå¼€é”€</li></ul><h3 id="ç›‘æ§è½¯ä»¶"><a href="#ç›‘æ§è½¯ä»¶" class="headerlink" title="ç›‘æ§è½¯ä»¶"></a>ç›‘æ§è½¯ä»¶</h3><p>nagiosã€zabbixã€cacti</p><h3 id="ç›‘æ§ä½“ç³»"><a href="#ç›‘æ§ä½“ç³»" class="headerlink" title="ç›‘æ§ä½“ç³»"></a>ç›‘æ§ä½“ç³»</h3><h4 id="ç³»ç»Ÿç›‘æ§"><a href="#ç³»ç»Ÿç›‘æ§" class="headerlink" title="ç³»ç»Ÿç›‘æ§"></a>ç³»ç»Ÿç›‘æ§</h4><p>æœåŠ¡å™¨èµ„æºç›‘æ§</p><ul><li>Cpu, å†…å­˜ï¼Œç¡¬ç›˜ç©ºé—´ï¼Œi/oå‹åŠ›</li><li>è®¾ç½®é˜ˆå€¼æŠ¥è­¦</li></ul><p>æœåŠ¡å™¨æµé‡ç›‘æ§</p><ul><li>å¤–ç½‘æµé‡ï¼Œå†…ç½‘æµé‡</li><li>è®¾ç½®é˜ˆå€¼æŠ¥è­¦</li></ul><p>è¿æ¥çŠ¶æ€ç›‘æ§</p><ul><li>Show processlist è®¾ç½®é˜ˆå€¼ï¼Œæ¯åˆ†é’Ÿç›‘æµ‹ï¼Œè¶…è¿‡é˜ˆå€¼è®°å½•</li></ul><h4 id="åº”ç”¨ç›‘æ§"><a href="#åº”ç”¨ç›‘æ§" class="headerlink" title="åº”ç”¨ç›‘æ§"></a>åº”ç”¨ç›‘æ§</h4><p>æ…¢æŸ¥è¯¢ç›‘æ§</p><ul><li>æ…¢æŸ¥è¯¢æ—¥å¿—</li><li>å¦‚æœå­˜åœ¨å¤šå°æ•°æ®åº“æœåŠ¡å™¨ï¼Œåº”æœ‰æ±‡æ€»æŸ¥é˜…æœºåˆ¶ã€‚</li></ul><p>è¯·æ±‚é”™è¯¯ç›‘æ§</p><ul><li>é«˜é¢‘ç¹åº”ç”¨ä¸­ï¼Œä¼šå‡ºç°å¶å‘æ€§æ•°æ®åº“è¿æ¥é”™è¯¯æˆ–æ‰§è¡Œé”™è¯¯ï¼Œå°†é”™è¯¯ä¿¡æ¯è®°å½•åˆ°æ—¥å¿—ï¼ŒæŸ¥çœ‹æ¯æ—¥çš„æ¯”ä¾‹å˜åŒ–ã€‚</li><li>å¶å‘æ€§é”™è¯¯ï¼Œå¦‚æœæ•°é‡æå°‘ï¼Œå¯ä»¥ä¸ç”¨å¤„ç†ï¼Œä½†æ˜¯éœ€æ—¶å¸¸ç›‘æ§å…¶è¶‹åŠ¿ã€‚</li><li>ä¼šå­˜åœ¨æ¶æ„è¾“å…¥å†…å®¹ï¼Œè¾“å…¥è¾¹ç•Œé™å®šç¼ºä¹å¯¼è‡´æ‰§è¡Œå‡ºé”™ï¼Œéœ€åŸºäºæ­¤é˜²æ­¢æ¶æ„å…¥ä¾µæ¢æµ‹è¡Œä¸ºã€‚</li></ul><p>å¾®æ…¢æŸ¥è¯¢ç›‘æ§</p><ul><li>é«˜å¹¶å‘ç¯å¢ƒé‡Œï¼Œè¶…è¿‡0.01ç§’çš„æŸ¥è¯¢è¯·æ±‚éƒ½åº”è¯¥å…³æ³¨ä¸€ä¸‹ã€‚</li></ul><p>é¢‘ç¹åº¦ç›‘æ§</p><ul><li>å†™æ“ä½œï¼ŒåŸºäºbinlogï¼Œå®šæœŸåˆ†æã€‚</li><li>è¯»æ“ä½œï¼Œåœ¨å‰ç«¯dbå°è£…ä»£ç ä¸­å¢åŠ æŠ½æ ·æ—¥å¿—ï¼Œå¹¶è¾“å‡ºæ‰§è¡Œæ—¶é—´ã€‚</li><li>åˆ†æè¯·æ±‚é¢‘ç¹åº¦æ˜¯å¼€å‘æ¶æ„ è¿›ä¸€æ­¥ä¼˜åŒ–çš„åŸºç¡€</li><li>æœ€å¥½çš„ä¼˜åŒ–å°±æ˜¯å‡å°‘è¯·æ±‚æ¬¡æ•°ï¼</li></ul><h2 id="å®‰å…¨"><a href="#å®‰å…¨" class="headerlink" title="å®‰å…¨"></a>å®‰å…¨</h2><h3 id="æ•°æ®å®‰å…¨"><a href="#æ•°æ®å®‰å…¨" class="headerlink" title="æ•°æ®å®‰å…¨"></a>æ•°æ®å®‰å…¨</h3><ul><li>é‡ç‚¹ï¼šå…ˆå¯ç”¨æ€§è€Œåæ‰æ˜¯æ€§èƒ½</li><li>å…³é—­å…¬ç½‘ï¼Œåªç•™ç§ç½‘</li><li>å¯†ç è¶³å¤Ÿé•¿åº¦ã€å¤æ‚åº¦</li><li>å¼€å¯iptablesç­–ç•¥</li><li>åªå¼€æ”¾å¿…è¦çš„æˆæƒè®¸å¯</li><li>ä½¿ç”¨æ™®é€šè´¦å·ç®¡ç†mysqld(ç»“åˆsudo)</li><li>é›†æˆå®šæœŸå®‰å…¨æ£€æŸ¥åˆ°ç›‘æ§ç³»ç»Ÿä¸­</li></ul><h3 id="æ€§èƒ½ä¸å®‰å…¨æ€§è€ƒé‡"><a href="#æ€§èƒ½ä¸å®‰å…¨æ€§è€ƒé‡" class="headerlink" title="æ€§èƒ½ä¸å®‰å…¨æ€§è€ƒé‡"></a>æ€§èƒ½ä¸å®‰å…¨æ€§è€ƒé‡</h3><p>æ•°æ®æäº¤æ–¹å¼</p><ul><li>innodb_flush_log_at_trx_commit = 1 æ¯æ¬¡è‡ªåŠ¨æäº¤ï¼Œå®‰å…¨æ€§é«˜ï¼Œi/oå‹åŠ›å¤§</li><li>innodb_flush_log_at_trx_commit = 2 æ¯ç§’è‡ªåŠ¨æäº¤ï¼Œå®‰å…¨æ€§ç•¥æœ‰å½±å“ï¼Œi/oæ‰¿è½½å¼ºã€‚</li></ul><p>æ—¥å¿—åŒæ­¥</p><ul><li>Sync-binlog =1 æ¯æ¡è‡ªåŠ¨æ›´æ–°ï¼Œå®‰å…¨æ€§é«˜ï¼Œi/oå‹åŠ›å¤§</li><li>Sync-binlog = 0 æ ¹æ®ç¼“å­˜è®¾ç½®æƒ…å†µè‡ªåŠ¨æ›´æ–°ï¼Œå­˜åœ¨ä¸¢å¤±æ•°æ®å’ŒåŒæ­¥å»¶è¿Ÿé£é™©ï¼Œi/oæ‰¿è½½åŠ›å¼ºã€‚</li><li>ä¸ªäººå»ºè®®ä¿å­˜binlogæ—¥å¿—æ–‡ä»¶ï¼Œä¾¿äºè¿½æº¯ æ›´æ–°æ“ä½œå’Œç³»ç»Ÿæ¢å¤ã€‚</li><li>å¦‚å¯¹æ—¥å¿—æ–‡ä»¶çš„i/oå‹åŠ›æœ‰æ‹…å¿ƒï¼Œåœ¨å†…å­˜å®½è£•çš„æƒ…å†µä¸‹ï¼Œå¯è€ƒè™‘å°†binlog å†™å…¥åˆ°è¯¸å¦‚ /dev/shm è¿™æ ·çš„å†…å­˜æ˜ å°„åˆ†åŒºï¼Œå¹¶å®šæ—¶å°†æ—§æœ‰çš„binlogè½¬ç§»åˆ°ç‰©ç†ç¡¬ç›˜ã€‚</li></ul><p>æ€§èƒ½ä¸å®‰å…¨æœ¬èº«å­˜åœ¨ç›¸æ‚–çš„æƒ…å†µï¼Œéœ€è¦åœ¨ä¸šåŠ¡è¯‰æ±‚å±‚é¢å†³å®šå–èˆ</p><ul><li>å­¦ä¼šåŒºåˆ†ä»€ä¹ˆåœºåˆä¾§é‡æ€§èƒ½ï¼Œä»€ä¹ˆåœºåˆä¾§é‡å®‰å…¨</li><li>å­¦ä¼šå°†ä¸åŒå®‰å…¨ç­‰çº§çš„æ•°æ®åº“ç”¨ä¸åŒç­–ç•¥ç®¡ç†</li></ul><h2 id="å¤‡ä»½"><a href="#å¤‡ä»½" class="headerlink" title="å¤‡ä»½"></a>å¤‡ä»½</h2><h3 id="å¤‡ä»½æ¢å¤"><a href="#å¤‡ä»½æ¢å¤" class="headerlink" title="å¤‡ä»½æ¢å¤"></a>å¤‡ä»½æ¢å¤</h3><ul><li>åˆ©ç”¨slaveæ‰§è¡Œå¤‡ä»½</li><li>å®šæœŸå…¨å¤‡+åŠæ—¶å¢å¤‡</li><li>ä¸å®šæœŸéšæœºåšæ¢å¤æµ‹è¯•</li><li>äºŒè¿›åˆ¶å†…å®¹å¤‡ä»½ä½¿ç”¨ â€“hex-blob</li><li>å¤‡ä»½æ–¹å¼ï¼šmysqldump VS XtraBackup</li><li>å¦‚ä½•å¿«é€Ÿå¤‡ä»½/æ¢å¤ï¼Ÿ(å¹¶å‘ï¼Ÿå¿«ç…§ï¼Ÿ)</li><li>å¦‚ä½•æ‰§è¡Œåœ¨çº¿çƒ­å¤‡<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump <span class="comment">--single-transactionæˆ–Xtrabackup</span></span><br></pre></td></tr></table></figure></li></ul><h1 id="é«˜å¯ç”¨"><a href="#é«˜å¯ç”¨" class="headerlink" title="é«˜å¯ç”¨"></a>é«˜å¯ç”¨</h1><h2 id="æ¶æ„"><a href="#æ¶æ„" class="headerlink" title="æ¶æ„"></a>æ¶æ„</h2><ul><li>Keepalived + LVS</li><li>Heartbeat + LVS</li><li>Master + Slave</li><li>å¤šMasterå…±äº«å­˜å‚¨</li></ul><h2 id="æ•…éšœè½¬ç§»å¤„ç†"><a href="#æ•…éšœè½¬ç§»å¤„ç†" class="headerlink" title="æ•…éšœè½¬ç§»å¤„ç†"></a>æ•…éšœè½¬ç§»å¤„ç†</h2><p><strong>è¦ç‚¹</strong></p><ul><li>ç¨‹åºä¸æ•°æ®åº“çš„è¿æ¥ï¼ŒåŸºäºè™šåœ°å€è€ŒéçœŸå®ipï¼Œç”±è´Ÿè½½å‡è¡¡ç³»ç»Ÿç›‘æ§ã€‚</li><li>ä¿æŒä¸»ä»ç»“æ„çš„ç®€å•åŒ–ï¼Œå¦åˆ™å¾ˆéš¾åšåˆ°æ•…éšœç‚¹æ‘˜é™¤ã€‚</li></ul><p><strong>æ€è€ƒæ–¹å¼</strong></p><ul><li>éå†å¯¹æœåŠ¡å™¨é›†ç¾¤çš„ä»»ä½•ä¸€å°æœåŠ¡å™¨ï¼Œå‰ç«¯webï¼Œä¸­é—´ä»¶ï¼Œç›‘æ§ï¼Œç¼“å­˜ï¼Œdbç­‰ç­‰ï¼Œå‡è®¾è¯¥æœåŠ¡å™¨å‡ºç°æ•…éšœï¼Œç³»ç»Ÿæ˜¯å¦ä¼šå‡ºç°å¼‚å¸¸ï¼Ÿç”¨æˆ·è®¿é—®æ˜¯å¦ä¼šå‡ºç°å¼‚å¸¸ã€‚</li><li>ç›®æ ‡ï¼šä»»æ„ä¸€å°æœåŠ¡å™¨å´©æºƒï¼Œè´Ÿè½½å’Œæ•°æ®æ“ä½œå‡ä¼šå¾ˆçŸ­æ—¶é—´å†…è‡ªåŠ¨è½¬ç§»åˆ°å…¶ä»–æœåŠ¡å™¨ï¼Œä¸ä¼šå½±å“ä¸šåŠ¡çš„æ­£å¸¸è¿›è¡Œã€‚ä¸ä¼šé€ æˆæ¶æ€§çš„æ•°æ®ä¸¢å¤±ã€‚ï¼ˆå“ªäº›æ˜¯å¯ä»¥ä¸¢å¤±çš„ï¼Œå“ªäº›æ˜¯ä¸èƒ½ä¸¢å¤±çš„ï¼‰</li></ul><p><strong>å¸¸è§æ•…éšœ</strong></p><ul><li>å¤åˆ¶æŠ¥é”™ï¼šä¸»é”®å†²çª</li><li>ç¡¬ä»¶ã€ç³»ç»Ÿå´©æºƒï¼šæ•°æ®é¡µæŸå</li><li>è¯¯æ“ä½œï¼šæ•°æ®è¯¯åˆ é™¤</li><li>ç¡¬ä»¶æ•…éšœï¼šé˜µåˆ—å¡(æ‰çº¿ã€IOæ€§èƒ½ä¸‹é™)ã€CPUã€å†…å­˜</li></ul><h1 id="å‹æµ‹"><a href="#å‹æµ‹" class="headerlink" title="å‹æµ‹"></a>å‹æµ‹</h1><h2 id="åŸºå‡†æµ‹è¯•"><a href="#åŸºå‡†æµ‹è¯•" class="headerlink" title="åŸºå‡†æµ‹è¯•"></a>åŸºå‡†æµ‹è¯•</h2><p>tpccã€sysbench<br>ç°åœ¨æµ‹è¯•å»ºè®®ä½¿ç”¨ tpccï¼Œä¸ä½¿ç”¨ sysbenchï¼ˆå› ä¸ºæœ‰ä¸€å®šçš„å±€é™æ€§ï¼‰</p><h2 id="å‹åŠ›æµ‹è¯•"><a href="#å‹åŠ›æµ‹è¯•" class="headerlink" title="å‹åŠ›æµ‹è¯•"></a>å‹åŠ›æµ‹è¯•</h2><p>mysqlslapã€å‰ç«¯åŠ å‹</p><h1 id="å­˜å‚¨-å†™å…¥å‹åŠ›ä¼˜åŒ–"><a href="#å­˜å‚¨-å†™å…¥å‹åŠ›ä¼˜åŒ–" class="headerlink" title="å­˜å‚¨/å†™å…¥å‹åŠ›ä¼˜åŒ–"></a>å­˜å‚¨/å†™å…¥å‹åŠ›ä¼˜åŒ–</h1><ul><li>é¡ºåºè¯»å†™æ€§èƒ½è¿œé«˜äºéšæœºè¯»å†™</li><li>å°†é¡ºåºå†™æ•°æ®å’Œéšæœºè¯»å†™æ•°æ®åˆ†æˆä¸åŒçš„ç‰©ç†ç£ç›˜è¿›è¡Œï¼Œæœ‰åŠ©äºi/oå‹åŠ›çš„ç–è§£<ul><li>æ•°æ®åº“æ–‡ä»¶æ¶‰åŠç´¢å¼•ç­‰å†…å®¹ï¼Œå†™å…¥æ˜¯éšå³å†™</li><li>binlogæ–‡ä»¶æ˜¯é¡ºåºå†™</li><li>æ·˜å®æ•°æ®åº“å­˜å‚¨ä¼˜åŒ–æ˜¯è¿™æ ·å¤„ç†çš„</li></ul></li><li>éƒ¨åˆ†å®‰å…¨è¦æ±‚ä¸é«˜çš„å†™å…¥æ“ä½œå¯ä»¥ç”¨ /dev/shm åˆ†åŒºå­˜å‚¨ï¼Œç®€å•å˜æˆå†…å­˜å†™ã€‚</li><li>å¤šå—ç‰©ç†ç¡¬ç›˜åšraid10ï¼Œå¯ä»¥æå‡å†™å…¥èƒ½åŠ›</li><li>å…³é”®å­˜å‚¨è®¾å¤‡ä¼˜åŒ–ï¼Œå–„äºæ¯”å¯¹ä¸åŒå­˜å‚¨ä»‹è´¨çš„å‹åŠ›æµ‹è¯•æ•°æ®ã€‚<ul><li>ä¾‹å¦‚fusion-ioåœ¨æ–°æµªå’Œæ·˜å®éƒ½æœ‰è¾ƒå¤šä½¿ç”¨ã€‚</li></ul></li><li>æ¶‰åŠå¿…é¡»å­˜å‚¨è¾ƒä¸ºåºå¤§çš„æ•°æ®é‡æ—¶<ul><li>å‹ç¼©å­˜å‚¨ï¼Œå¯ä»¥é€šè¿‡å¢åŠ cpuå¼€é”€ï¼ˆå‹ç¼©ç®—æ³•ï¼‰å‡å°‘i/oå‹åŠ›ã€‚å‰ææ˜¯ä½ ç¡®è®¤cpuç›¸å¯¹ç©ºé—²è€Œi/oå‹åŠ›å¾ˆå¤§ã€‚ æ–°æµªå¾®åšå°±æ˜¯å‹ç¼©å­˜å‚¨çš„å…¸èŒƒã€‚</li><li>é€šè¿‡md5å»é‡å­˜å‚¨ï¼Œæ¡ˆä¾‹æ˜¯QQçš„æ–‡ä»¶å…±äº«ï¼Œä»¥åŠdropboxè¿™æ ·çš„å…±äº«æœåŠ¡ï¼Œå¦‚æœä½ ä¸Šä¼ çš„æ˜¯ä¸€ä¸ªåˆ«äººå·²æœ‰çš„æ–‡ä»¶ï¼Œè®¡ç®—md5åï¼Œç›´æ¥é€šè¿‡md5å®šä½åˆ°åŸæœ‰æ–‡ä»¶ï¼Œè¿™æ ·å¯ä»¥æå¤§å‡å°‘å­˜å‚¨é‡ã€‚æ¶‰åŠæ–‡ä»¶å…±äº«ï¼Œå¤´åƒå…±äº«ï¼Œç›¸å†Œç­‰åº”ç”¨ï¼Œé€šè¿‡è¿™ç§æ–¹æ³•å¯ä»¥å‡å°‘è¶…è¿‡70%çš„å­˜å‚¨è§„æ¨¡ï¼Œå¯¹ç¡¬ä»¶èµ„æºçš„èŠ‚çœæ˜¯ç›¸å½“å·¨å¤§çš„ã€‚ç¼ºç‚¹æ˜¯ï¼Œåˆ é™¤æ–‡ä»¶éœ€è¦ç”„åˆ«è¯¥md5æ˜¯å¦æœ‰å…¶ä»–äººä½¿ç”¨ã€‚ å»é‡å­˜å‚¨ï¼Œç”¨æˆ·é‡è¶Šå¤šï¼Œä¸Šä¼ æ–‡ä»¶è¶Šå¤šï¼Œæ•ˆç‡è¶Šé«˜ï¼</li><li>æ–‡ä»¶å°½é‡ä¸è¦å­˜å‚¨åˆ°æ•°æ®åº“å†…ã€‚å°½é‡ä½¿ç”¨ç‹¬ç«‹çš„æ–‡ä»¶ç³»ç»Ÿå­˜å‚¨ï¼Œè¯¥è¯é¢˜ä¸å±•å¼€ã€‚</li></ul></li></ul><h1 id="å·¥å…·é›†åˆ"><a href="#å·¥å…·é›†åˆ" class="headerlink" title="å·¥å…·é›†åˆ"></a>å·¥å…·é›†åˆ</h1><h2 id="è°ƒä¼˜å·¥å…·"><a href="#è°ƒä¼˜å·¥å…·" class="headerlink" title="è°ƒä¼˜å·¥å…·"></a>è°ƒä¼˜å·¥å…·</h2><ul><li>systemtap</li><li>sar</li><li>gdb</li><li>gcore</li><li>oprofile</li><li>pmp (Poor Manâ€™s Profiler)</li><li>dstat</li></ul><h2 id="å…¶ä»–å·¥å…·"><a href="#å…¶ä»–å·¥å…·" class="headerlink" title="å…¶ä»–å·¥å…·"></a>å…¶ä»–å·¥å…·</h2><ul><li>Xtrabackup<br>å¤‡ä»½å‡ºæ¥çš„æ•°æ®ï¼Œå¯ä»¥å¯¼å…¥å¦å¤–ä¸€ä¸ªåº“ï¼Œåªè¦åˆ¶å®šé…ç½®æ–‡ä»¶å°±è¡Œ</li><li>ioprofile</li><li>pt-online-schema-change</li><li>pt-table-checksum</li><li>pt-query-digest + Box Anemometer/Query-Digest-UI â€“ åˆ†æ slow log<br>index_ratio æ˜¯ digest çš„ä¸€ä¸ªæŒ‡æ ‡ï¼Œæ„æ€æ˜¯ï¼šæ€»å…±æ‰«æçš„è®°å½•æ•°+æœ€ç»ˆè¿”å›çš„ç»“æœè®°å½•æ•°</li><li>mysqldumpslow â€“ åˆ†æ slow log</li><li>pt-ioprofile â€“ æŸ¥çœ‹å“ªä¸ªæ•°æ®åº“è¯»å†™é¢‘ç¹</li></ul><h1 id="å¼€å‘äººå‘˜è¡Œä¸º"><a href="#å¼€å‘äººå‘˜è¡Œä¸º" class="headerlink" title="å¼€å‘äººå‘˜è¡Œä¸º"></a>å¼€å‘äººå‘˜è¡Œä¸º</h1><ul><li>æ‰¹é‡å¯¼å…¥ã€å¯¼å‡ºæ•°æ®é¡»æå‰é€šçŸ¥DBAï¼Œè¯·æ±‚ååŠ©è§‚å¯Ÿ</li><li>æ¨å¹¿æ´»åŠ¨æˆ–ä¸Šçº¿æ–°åŠŸèƒ½é¡»æå‰é€šçŸ¥DBAï¼Œè¯·æ±‚å‹åŠ›è¯„ä¼°</li><li>ä¸ä½¿ç”¨SUPERæƒé™è¿æ¥æ•°æ®åº“</li><li>å•è¡¨å¤šæ¬¡ALTERæ“ä½œå¿…é¡»åˆå¹¶ä¸ºä¸€æ¬¡æ“ä½œ</li><li>æ•°æ®åº“DDLåŠé‡è¦SQLåŠæ—©æäº¤DBAè¯„å®¡</li><li>é‡è¦ä¸šåŠ¡åº“é¡»å‘ŠçŸ¥DBAé‡è¦ç­‰çº§ã€æ•°æ®å¤‡ä»½åŠæ—¶æ€§è¦æ±‚</li><li>ä¸åœ¨ä¸šåŠ¡é«˜å³°æœŸæ‰¹é‡æ›´æ–°ã€æŸ¥è¯¢æ•°æ®åº“</li><li>æäº¤çº¿ä¸ŠDDLéœ€æ±‚ï¼Œæ‰€æœ‰SQLè¯­å¥é¡»æœ‰å¤‡æ³¨è¯´æ˜</li></ul><h1 id="å¼€å‘ç¯å¢ƒæ­å»º"><a href="#å¼€å‘ç¯å¢ƒæ­å»º" class="headerlink" title="å¼€å‘ç¯å¢ƒæ­å»º"></a>å¼€å‘ç¯å¢ƒæ­å»º</h1><ul><li>å¯ç”¨log_queries_not_using_indexes</li><li>è®¾ç½®long_query_timeä¸ºæœ€å°å€¼</li><li>å®šæœŸæ£€æŸ¥åˆ†æslow log</li><li>æˆæƒå’Œç”Ÿäº§ç¯å¢ƒä¸€è‡´</li><li>å…³é—­Query Cache</li><li>è®¾ç½®è¾ƒå°InnoDB Buffer Poolã€key buffer size</li><li>æ•°æ®é‡ä¸èƒ½å¤ªå°‘ï¼Œå¦åˆ™æœ‰äº›æ€§èƒ½é—®é¢˜æ— æ³•æå‰è§„é¿</li></ul><h1 id="è¯¯åŒº"><a href="#è¯¯åŒº" class="headerlink" title="è¯¯åŒº"></a>è¯¯åŒº</h1><ul><li>åˆ†é…å†…å­˜è¶Šå¤šè¶Šå¥½ï¼Œå¯èƒ½å¯¼è‡´OS Swap<br>ä¸“ç”¨æœåŠ¡å™¨ï¼Œç¦ç”¨ swap; è€ƒè™‘ numa ä¹Ÿç¦</li><li>sessionçº§å†…å­˜åˆ†é…è¿‡å¤§ï¼Œå¯¼è‡´OOM</li><li>ç´¢å¼•è¶Šå¤šè¶Šå¥½ï¼Œå¯èƒ½å¯¼è‡´æ›´å¤šIO</li><li>Qcacheè®¾ç½®è¿‡å¤§ï¼Œå®é™…æ•ˆæœå·®(å»ºè®®å…³é—­)</li><li>è®¤ä¸ºMyISAMçš„åªè¯»æ•ˆç‡è¿œé«˜äºInnoDB(ä¸ä¸€å®š)</li><li>è¿‡åº¦ä¼˜åŒ–ï¼Œåè€Œå¸¦æ¥æˆæœ¬çš„ä¸Šå‡<br>ï¼ˆæ”¹ä¸šåŠ¡é€»è¾‘ï¼Œæ”¹ sqlï¼Œä¹°æ˜‚è´µçš„ io è®¾å¤‡ï¼Œä½†å®é™…ä¸Šå¤šåŠ å‡ çº§ cache å°±å¯ä»¥è§£å†³ï¼‰</li></ul><!--ä»¥ä¸‹æ˜¯è„šæ³¨-->]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;ç³»ç»Ÿä¸è½¯ä»¶&quot;&gt;&lt;a href=&quot;#ç³»ç»Ÿä¸è½¯ä»¶&quot; class=&quot;he
      
    
    </summary>
    
      <category term="2-å¼€å‘æŠ€èƒ½" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/"/>
    
      <category term="æ•°æ®åº“" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="Mysql" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql/"/>
    
    
      <category term="mysql" scheme="http://yoursite.com/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>æ€§èƒ½ä¼˜åŒ–</title>
    <link href="http://yoursite.com/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    <id>http://yoursite.com/2-å¼€å‘æŠ€èƒ½/æ•°æ®åº“/Mysql/æ€§èƒ½ä¼˜åŒ–/</id>
    <published>2017-11-17T14:20:00.000Z</published>
    <updated>2017-12-03T16:04:44.532Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="ä¼˜åŒ–æ­¥éª¤"><a href="#ä¼˜åŒ–æ­¥éª¤" class="headerlink" title="ä¼˜åŒ–æ­¥éª¤"></a>ä¼˜åŒ–æ­¥éª¤</h1><ul><li>ç¬¬ä¸€æ­¥ï¼Œå®Œæˆæ•°æ®åº“æŸ¥è¯¢çš„ä¼˜åŒ–ï¼Œéœ€è¦ç†è§£ç´¢å¼•ç»“æ„ï¼Œæ‰èƒ½å­¦ä¼šåˆ¤æ–­å½±å“ç»“æœé›†ã€‚è€Œå½±å“ç»“æœé›†å¯¹æŸ¥è¯¢æ•ˆç‡çº¿æ€§ç›¸å…³ï¼ŒæŒæ¡è¿™ä¸€ç‚¹ï¼Œç¼–å†™æ•°æ®æŸ¥è¯¢è¯­å¥å°±å¾ˆå®¹æ˜“åˆ¤æ–­ç³»ç»Ÿå¼€é”€ï¼Œäº†è§£ä¸šåŠ¡å‹åŠ›è¶‹åŠ¿ã€‚</li><li>ç¬¬äºŒæ­¥ï¼Œåœ¨SQLè¯­å¥å·²ç»è¶³å¤Ÿä¼˜åŒ–çš„åŸºç¡€ä¸Šï¼Œå­¦ä¼šå¯¹æ•°æ®åº“æ•´ä½“çŠ¶å†µçš„åˆ†æï¼Œèƒ½å¤Ÿå¯¹å¼‚å¸¸å’Œè´Ÿè½½çš„æ³¢åŠ¨æœ‰æ­£ç¡®çš„è®¤è¯†å’Œè§£è¯»ï¼›èƒ½å¤Ÿå¯¹ç³»ç»Ÿèµ„æºçš„åˆ†é…å’Œç“¶é¢ˆæœ‰æ­£ç¡®çš„è®¤è¯†ã€‚å­¦ä¼šé€šè¿‡ç›‘æ§å’Œæ•°æ®æ¥è¿›è¡Œç³»ç»Ÿçš„è¯„ä¼°å’Œä¼˜åŒ–æ–¹æ¡ˆè®¾è®¡ï¼Œæœç»æ‹è„‘è¢‹ï¼Œå­¦ä¼šæŠ“å¤§æ”¾å°ï¼ŒæŠŠæ¡è¦ç‚¹çš„å¤„ç†æ–¹æ³•ã€‚</li><li>ç¬¬ä¸‰æ­¥ï¼Œåœ¨å½»åº•æŒæ¡æ•°æ®åº“è¯­å¥ä¼˜åŒ–å’Œè¿ç»´ä¼˜åŒ–çš„åŸºç¡€ä¸Šï¼Œå­¦ä¼šåˆ†å¸ƒå¼æ¶æ„è®¾è®¡ï¼ŒæŒæ¡å¤æ‚ï¼Œå¤§å®¹é‡æ•°æ®åº“ç³»ç»Ÿçš„æ­å»ºæ–¹æ³•ã€‚</li></ul><h1 id="ä¼˜åŒ–SQL"><a href="#ä¼˜åŒ–SQL" class="headerlink" title="ä¼˜åŒ–SQL"></a>ä¼˜åŒ–SQL</h1><h2 id="å»ºç«‹æ…¢æŸ¥è¯¢ä¼˜åŒ–ç³»ç»Ÿ"><a href="#å»ºç«‹æ…¢æŸ¥è¯¢ä¼˜åŒ–ç³»ç»Ÿ" class="headerlink" title="å»ºç«‹æ…¢æŸ¥è¯¢ä¼˜åŒ–ç³»ç»Ÿ"></a>å»ºç«‹æ…¢æŸ¥è¯¢ä¼˜åŒ–ç³»ç»Ÿ</h2><p>åˆ©ç”¨ <a href="https://www.percona.com/doc/percona-toolkit/2.2/pt-query-digest.html" rel="external nofollow noopener noreferrer" target="_blank">pt-query-digest</a> å®šæœŸåˆ†æslow query logï¼Œå¹¶ç»“åˆ <a href="https://github.com/box/Anemometer" rel="external nofollow noopener noreferrer" target="_blank">Box Anemometer</a> æ„å»ºslow query logåˆ†æåŠä¼˜åŒ–ç³»ç»Ÿã€‚</p><h2 id="SELECT"><a href="#SELECT" class="headerlink" title="SELECT"></a>SELECT</h2><p>åªé€‰æ‹©è‡ªå·±éœ€è¦çš„åˆ—ï¼Œä¸è¦ç›²ç›®çš„ä½¿ç”¨* ï¼Œå› ä¸ºä¸éœ€è¦çš„åˆ—å¯èƒ½ä¼šå¯¼è‡´å†…å­˜ buffer pool è¢«è¿™äº›â€œæ— æ•ˆâ€æ•°æ®æŠŠçœŸæ­£çš„çƒ­ç‚¹æ•°æ®ç»™æ´—å‡ºå»äº†ï¼ˆå°¤å…¶æœ‰ text/blob åˆ—æ—¶ï¼‰</p><h2 id="JOIN"><a href="#JOIN" class="headerlink" title="JOIN"></a>JOIN</h2><p>è¦æŠŠè¿‡æ»¤æ€§æœ€å¤§ï¼ˆä¸ä¸€å®šæ˜¯æ•°æ®é‡æœ€å°å“¦ï¼Œè€Œæ˜¯åªåŠ äº†WHEREæ¡ä»¶åè¿‡æ»¤æ€§æœ€å¤§çš„é‚£ä¸ªï¼‰çš„è¡¨é€‰ä¸ºé©±åŠ¨è¡¨ã€‚æ­¤å¤–ï¼Œå¦‚æœJOINä¹‹åæœ‰æ’åºï¼Œæ’åºå­—æ®µä¸€å®šè¦å±äºé©±åŠ¨è¡¨ï¼Œæ‰èƒ½åˆ©ç”¨é©±åŠ¨è¡¨ä¸Šçš„ç´¢å¼•å®Œæˆæ’åºã€‚</p><h2 id="æ’åº"><a href="#æ’åº" class="headerlink" title="æ’åº"></a>æ’åº</h2><p>ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ’åºçš„ä»£ä»·é€šå¸¸è¦æ¥çš„æ›´é«˜ï¼Œå› æ­¤å¦‚æœçœ‹åˆ°æ‰§è¡Œè®¡åˆ’ä¸­æœ‰ Using filesortï¼Œä¼˜å…ˆåˆ›å»ºæ’åºç´¢å¼•å§ã€‚</p><h2 id="EXPLAIN"><a href="#EXPLAIN" class="headerlink" title="EXPLAIN"></a>EXPLAIN</h2><p>è¯¦æƒ…è§ï¼š<a href="http://dev.mysql.com/doc/refman/5.6/en/explain-output.html#explain-join-types" rel="external nofollow noopener noreferrer" target="_blank">mysql5.6 explain</a></p><p>ç»“æœè§£æï¼š</p><table><thead><tr><th>å­—æ®µå</th><th>å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>type</td><td>ALL</td><td>è¡¨ç¤ºé¢„è®¡ä¼šè¿›è¡Œå…¨è¡¨æ‰«æï¼ˆfull table scanï¼‰ã€‚é€šå¸¸å…¨è¡¨æ‰«æçš„ä»£ä»·æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œå»ºè®®åˆ›å»ºé€‚å½“çš„ç´¢å¼•ï¼Œé€šè¿‡ç´¢å¼•æ£€ç´¢é¿å…å…¨è¡¨æ‰«æã€‚æ­¤å¤–ï¼Œå…¨ç´¢å¼•æ‰«æï¼ˆfull index scanï¼‰çš„ä»£ä»·æœ‰æ—¶å€™æ˜¯æ¯”å…¨è¡¨æ‰«æè¿˜è¦é«˜çš„ï¼Œé™¤éæ˜¯åŸºäºInnoDBè¡¨çš„ä¸»é”®ç´¢å¼•æ‰«æã€‚</td></tr><tr><td>Extra</td><td>Using temporary</td><td>è¡¨ç¤ºéœ€è¦åˆ›å»ºä¸´æ—¶è¡¨ä»¥æ»¡è¶³éœ€æ±‚ï¼Œé€šå¸¸æ˜¯å› ä¸ºGROUP BYçš„åˆ—æ²¡æœ‰ç´¢å¼•ï¼Œæˆ–è€…GROUP BYå’ŒORDER BYçš„åˆ—ä¸ä¸€æ ·ï¼Œä¹Ÿéœ€è¦åˆ›å»ºä¸´æ—¶è¡¨ï¼Œå»ºè®®æ·»åŠ é€‚å½“çš„ç´¢å¼•ã€‚</td></tr><tr><td></td><td>Using filesort</td><td>è¡¨ç¤ºæ— æ³•åˆ©ç”¨ç´¢å¼•å®Œæˆæ’åºï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯å› ä¸ºå¤šè¡¨è¿æ¥æ—¶ï¼Œæ’åºå­—æ®µä¸æ˜¯é©±åŠ¨è¡¨ä¸­çš„å­—æ®µï¼Œå› æ­¤ä¹Ÿæ²¡åŠæ³•åˆ©ç”¨ç´¢å¼•å®Œæˆæ’åºï¼Œå»ºè®®æ·»åŠ é€‚å½“çš„ç´¢å¼•ã€‚</td></tr><tr><td></td><td>Using where</td><td>é€šå¸¸æ˜¯å› ä¸ºå…¨è¡¨æ‰«ææˆ–å…¨ç´¢å¼•æ‰«ææ—¶ï¼ˆtype åˆ—æ˜¾ç¤ºä¸º ALL æˆ– indexï¼‰ï¼ŒåˆåŠ ä¸Šäº†WHEREæ¡ä»¶ï¼Œå»ºè®®æ·»åŠ é€‚å½“çš„ç´¢å¼•ã€‚</td></tr></tbody></table><h2 id="æŸ¥è¯¢-ä¼˜åŒ–å½±å“ç»“æœé›†"><a href="#æŸ¥è¯¢-ä¼˜åŒ–å½±å“ç»“æœé›†" class="headerlink" title="æŸ¥è¯¢/ä¼˜åŒ–å½±å“ç»“æœé›†"></a>æŸ¥è¯¢/ä¼˜åŒ–å½±å“ç»“æœé›†</h2><h3 id="æŸ¥è¯¢"><a href="#æŸ¥è¯¢" class="headerlink" title="æŸ¥è¯¢"></a>æŸ¥è¯¢</h3><ul><li>é€šè¿‡ Explain åˆ†æ SQLï¼ŒæŸ¥çœ‹ rows åˆ—å†…å®¹</li><li>é€šè¿‡æ…¢æŸ¥è¯¢æ—¥å¿—çš„Rows_examined: åé¢çš„æ•°å­—</li></ul><h3 id="ä¼˜åŒ–"><a href="#ä¼˜åŒ–" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h3><p>æ ¸å¿ƒï¼šå‡å°‘å½±å“ç»“æœé›†æ•°ç›®</p><ul><li>åŸºäºå½±å“ç»“æœé›†çš„ç†è§£å»ä¼˜åŒ–ï¼Œä¸è®ºä»æ•°æ®ç»“æ„ï¼Œä»£ç ï¼Œè¿˜æ˜¯æ¶‰åŠäº§å“ç­–ç•¥ä¸Šï¼Œéƒ½éœ€è¦è´¯å½»ä¸‹å»ã€‚</li><li>æ¶‰åŠ limit $start,$numçš„æœç´¢ï¼Œå¦‚æœ$startå·¨å¤§ï¼Œåˆ™å½±å“ç»“æœé›†å·¨å¤§ï¼Œæœç´¢æ•ˆç‡ä¼šéå¸¸éš¾è¿‡ä½ï¼Œå°½é‡ç”¨å…¶ä»–æ–¹å¼æ”¹å†™ä¸º limit 0,$numï¼› ç¡®ç³»æ— æ³•æ”¹å†™çš„æƒ…å†µä¸‹ï¼Œå…ˆä»ç´¢å¼•ç»“æ„ä¸­è·å¾— limit $start,$num æˆ–limit $start,1 ï¼›å†ç”¨inæ“ä½œæˆ–åŸºäºç´¢å¼•åºçš„ limit 0,$num äºŒæ¬¡æœç´¢ã€‚</li><li>é¿å…æ‰€æœ‰é”è¡¨çš„æƒ…å†µï¼ˆæ¯”å¦‚ delete æ“ä½œæ— ç´¢å¼•æ—¶ï¼‰</li></ul><h3 id="æ¡ˆä¾‹"><a href="#æ¡ˆä¾‹" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h3><h4 id="å®æ—¶æ’è¡Œæ¦œ"><a href="#å®æ—¶æ’è¡Œæ¦œ" class="headerlink" title="å®æ—¶æ’è¡Œæ¦œ"></a>å®æ—¶æ’è¡Œæ¦œ</h4><p><strong>èƒŒæ™¯ï¼š</strong> ç”¨æˆ·æäº¤æ¸¸æˆç§¯åˆ†ï¼Œæ˜¾ç¤ºå®æ—¶æ’åã€‚</p><p><strong>åŸæ–¹æ¡ˆï¼š</strong><br>è®¾ç½®ç§¯åˆ†åŒºé—´ï¼Œæ¯ä¸ªåŒºé—´å¢åŠ æ•°æ®ç»Ÿè®¡å­—æ®µï¼›æ¯æ¬¡éƒ½åª count æœ¬åŒºé—´çš„åæ¬¡ï¼Œå†åŠ ä¸Šå‰é¢æ‰€æœ‰åŒºé—´çš„æ€»å’Œã€‚</p><ol><li>æäº¤ç§¯åˆ†æ˜¯æ’å…¥è®°å½•ï¼Œç•¥ï¼Œ</li><li>select count(*) from jifen where gameid=$gameid and fenshu&gt;$fenshu</li></ol><p><strong>é—®é¢˜ä¸æŒ‘æˆ˜ï¼š</strong><br>å³ä¾¿ç´¢å¼•æ˜¯ gameid+fenshu å¤åˆç´¢å¼•ï¼Œæ¶‰åŠcountæ“ä½œï¼Œå½“åˆ†æ•°è¾ƒä½æ—¶ï¼Œå½±å“ç»“æœé›†å·¨å¤§ï¼ŒæŸ¥è¯¢æ•ˆç‡ç¼“æ…¢ï¼Œé«˜å³°æœŸä¼šå¯¼è‡´è¿æ¥è¿‡å¤šã€‚</p><p><strong>ä¼˜åŒ–æ€è·¯ï¼š</strong><br>SQL ä¼˜åŒ–<br>å‡å°‘å½±å“ç»“æœé›†ï¼Œåˆè¦å–å¾—å®æ—¶æ•°æ®ï¼Œå•çº¯ä»SQLä¸Šè€ƒè™‘ï¼Œä¸å¤ªæœ‰æ–¹æ³•ã€‚</p><p><strong>æ–¹æ¡ˆ1ï¼š</strong><br>é€»è¾‘ä¼˜åŒ–</p><ol><li>å°†æ¸¸æˆç§¯åˆ†é¢„å®šä¹‰åˆ†æˆæ•°ä¸ªç§¯åˆ†æ–­ç‚¹ï¼Œç„¶ååˆ†æˆç§¯åˆ†åŒºé—´ï¼ŒåŸå§‹çŠ¶æ€ï¼Œæ¯ä¸ªåŒºé—´è®¾ç½®ä¸€ä¸ªç»Ÿè®¡æ•°å­—é¡¹ï¼Œåˆå§‹ä¸º0ã€‚</li><li>æ¯æ¬¡ç§¯åˆ†æäº¤æ—¶ï¼Œå…ˆç¡®å®šè¯¥åˆ†æ•°å±äºå“ªä¸¤ä¸ªåŒºé—´ä¹‹é—´ï¼Œè¿™ä¸ªæ“ä½œéå¸¸ç®€å•ï¼Œå› ä¸ºåŒºé—´æ˜¯é¢„å®šä¹‰çš„ï¼Œè€Œä¸”æ•°é‡å¾ˆå°‘ï¼Œåªéœ€éå†å³å¯ï¼Œæ‰¾åˆ°æœ€è¯¥åˆ†æ•°ç¬¦åˆçš„åŒºé—´ï¼Œè¯¥åŒºé—´çš„ç»Ÿè®¡æ•°å­—é¡¹ï¼ˆç‹¬ç«‹å­—æ®µï¼Œå¯ç”¨å†…å­˜å¤„ç†ï¼Œå¼‚æ­¥å›å†™æ•°æ®åº“æˆ–æ–‡ä»¶ï¼‰+1ã€‚ è®°å½•è¯¥åŒºé—´ä¸Šè¾¹ç•Œæ•°å­—ä¸º$duandianã€‚SQL:  select count(*) from jifen where gameid=$gameid and fenshu&gt;$fenshu and fenshu&lt;$duandianï¼Œå¦‚æœå¤„äºç¬¬ä¸€åŒºé—´ï¼Œåˆ™æ— éœ€$duandianï¼Œè¿™æ ·å› ä¸ºç¬¬ä¸€åŒºé—´æœ¬èº«ä¹Ÿæ˜¯æœ€å¥½çš„æˆç»©ï¼Œå½±å“ç»“æœé›†ä¸ä¼šå¾ˆå¤šã€‚ é€šè¿‡è¯¥SQLè·å¾—å…¶åœ¨è¯¥åŒºé—´çš„åæ¬¡ã€‚è·å–å‰é¢åŒºé—´çš„æ€»æ•°æ€»å’Œã€‚ï¼ˆè¯¥æ•°å­—æ˜¯ç›´æ¥ä»ä¸Šè¿°æåˆ°çš„åŒºé—´ç»Ÿè®¡æ•°å­—è·å–ï¼Œä¸éœ€è¦è¿›è¡Œcountæ“ä½œï¼‰å°†åŒºé—´å†…åæ¬¡+å‰åŒºé—´çš„ç»Ÿè®¡æ•°å­—å’Œï¼Œè·å¾—æ€»åæ¬¡ã€‚</li></ol><p>è¯¥æ–¹æ³•å…³é”®åœ¨äºï¼Œç§¯åˆ†åŒºé—´éœ€è¦åˆç†å®šä¹‰ï¼Œä¿è¯ç§¯åˆ†æäº¤æˆç»©èƒ½å¹³å‡æ•£è½åœ¨ä¸åŒåŒºé—´ã€‚ï¼ˆå¦‚æ¶‰åŠè¾ƒå¤šå…¶ä»–æ¡ä»¶ï¼Œå¦‚æ—¥æ’è¡Œï¼Œæ€»æ’è¡Œï¼Œä»¥åŠå…¶ä»–ç‹¬ç«‹ç”¨æˆ·å»é‡ç­‰ï¼Œè¯·æŒ‰ç…§å½±å“ç»“æœé›†æ€è·¯è‡ªè¡Œå‘æŒ¥ã€‚ï¼‰</p><p><strong>æ–¹æ¡ˆ2ï¼š</strong><br>Redisæ–¹æ¡ˆ<br>Zset æœ‰åºæ•°ç»„ç»“æ„ï¼Œåˆ†ä¸¤ä¸ªå­ç»“æ„ï¼Œç¬¬ä¸€æ˜¯å¤šå±‚æ ‘å½¢çš„å­˜å‚¨ç»“æ„ï¼Œç¬¬äºŒæ˜¯æ¯ä¸ªæ ‘å½¢èŠ‚ç‚¹çš„è®¡æ•°å™¨ï¼Œè¿™æ ·ç±»ä¼¼äºå‰é¢çš„åˆ†æ®µæ–¹å¼ï¼Œå¯ä»¥ç†è§£ä¸ºå¤šå±‚åˆ†æ®µæ–¹å¼ï¼Œæ‰€ä»¥æŸ¥è¯¢æ•ˆç‡æ›´é«˜ï¼Œç¼ºç‚¹æ˜¯æ›´æ–°æ•ˆç‡æœ‰æ‰€å¢åŠ ã€‚</p><h4 id="å¤§æ•°æ®é‡ç¿»é¡µ"><a href="#å¤§æ•°æ®é‡ç¿»é¡µ" class="headerlink" title="å¤§æ•°æ®é‡ç¿»é¡µ"></a>å¤§æ•°æ®é‡ç¿»é¡µ</h4><p><strong>èƒŒæ™¯</strong>ï¼šå¸¸è§è®ºå›å¸–å­é¡µ SQL: select * from post where tagid=$tagid order by lastpost limit $start, $end ç¿»é¡µ ã€‚ç´¢å¼•ä¸º tagid+lastpost å¤åˆç´¢å¼•</p><p><strong>æŒ‘æˆ˜</strong>ï¼šè¶…çº§çƒ­å¸–ï¼Œå‡ ä¸‡å›å¸–ï¼Œç”¨æˆ·é¢‘é¢‘ç¿»åˆ°æœ«é¡µï¼Œlimit 25770,30 ä¸€ä¸ªæ“ä½œä¸‹æ¥ï¼Œå½±å“ç»“æœé›†å·¨å¤§(25770+30)ï¼ŒæŸ¥è¯¢ç¼“æ…¢ã€‚</p><p><strong>æ–¹æ¡ˆ1ï¼š</strong><br>ç‚¹å‡»é¡µç æ”¹ä¸ºä¸Šä¸‹ç¿»é¡µï¼›è·³è½¬é¡µsqlæ”¹ä¸ºå­æŸ¥è¯¢æˆ–è€…å†…è¿æ¥</p><ul><li><p>åªæ¶‰åŠä¸Šä¸‹ç¿»é¡µæƒ…å†µ<br>æ¯æ¬¡æŸ¥è¯¢çš„æ—¶å€™å°†è¯¥é¡µæŸ¥è¯¢ç»“æœä¸­æœ€å¤§çš„ $lastpostå’Œæœ€å°çš„åˆ†åˆ«è®°å½•ä¸º $minlastpost å’Œ $maxlastpost ï¼Œä¸Šç¿»é¡µæŸ¥è¯¢ä¸º select <em> from post where tagid=$tagid and lastpost&lt;$minlastpost order by lastpost desc limit 30; ä¸‹ç¿»é¡µä¸º select </em> from post where tagid=$tagid and lastpost&gt;$maxlastpost order by lastpost limit 30; ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œå½±å“ç»“æœé›†åªæœ‰30æ¡ï¼Œæ•ˆç‡æå¤§æå‡ã€‚</p></li><li><p>æ¶‰åŠè·³è½¬åˆ°ä»»æ„é¡µ<br>äº’è”ç½‘ä¸Šå¸¸è§çš„ä¸€ä¸ªä¼˜åŒ–æ–¹æ¡ˆå¯ä»¥è¿™æ ·è¡¨è¿°ï¼Œselect <em> from post where tagid=$tagid and lastpost&gt;=(select lastpost from post where tagid=$tagid order by lastpost limit $start,1) order by lastpost limit 30; æˆ–è€… select </em> from post where pid in (select pid from post where tagid=$tagid order by lastpost limit $start,30); (ç¬¬2æ¡Sè¯­æ³•åœ¨æ–°çš„mysqlç‰ˆæœ¬å·²ç»ä¸æ”¯æŒï¼Œæ–°ç‰ˆæœ¬mysql inçš„å­è¯­å¥ä¸å†æ”¯æŒlimitæ¡ä»¶ï¼Œä½†å¯ä»¥åˆ†è§£ä¸ºä¸¤æ¡SQLå®ç°ï¼ŒåŸç†ä¸å˜ï¼Œä¸åšèµ˜è¿°)</p></li></ul><p>ä»¥ä¸Šæ€è·¯åœ¨äºï¼Œå­æŸ¥è¯¢çš„å½±å“ç»“æœé›†ä»ç„¶æ˜¯$start +30ï¼Œä½†æ˜¯æ•°æ®è·å–çš„è¿‡ç¨‹ï¼ˆSending dataçŠ¶æ€ï¼‰å‘ç”Ÿåœ¨ç´¢å¼•æ–‡ä»¶ä¸­ï¼Œè€Œä¸æ˜¯æ•°æ®è¡¨æ–‡ä»¶ï¼Œè¿™æ ·æ‰€éœ€è¦çš„ç³»ç»Ÿå¼€é”€å°±æ¯”å‰ä¸€ç§æ™®é€šçš„æŸ¥è¯¢ä½ä¸€ä¸ªæ•°é‡çº§ï¼Œè€Œä¸»æŸ¥è¯¢çš„å½±å“ç»“æœé›†åªæœ‰30æ¡ï¼Œå‡ ä¹æ— å¼€é”€ã€‚ä½†æ˜¯åˆ‡è®°ï¼Œè¿™é‡Œä»ç„¶æ¶‰åŠäº†å¤ªå¤šçš„å½±å“ç»“æœé›†æ“ä½œã€‚</p><h2 id="å¸¸è§æ€æ‰‹çº§SQL"><a href="#å¸¸è§æ€æ‰‹çº§SQL" class="headerlink" title="å¸¸è§æ€æ‰‹çº§SQL"></a>å¸¸è§æ€æ‰‹çº§SQL</h2><ul><li><p>SELECT * vs SELECT col1, col2<br>å‡å°‘ç£ç›˜ io å’Œç½‘ç»œ io</p></li><li><p>ORDER BY RAND()<br><a href="http://imysql.com/2014/07/04/mysql-optimization-case-rand-optimize.shtml" rel="external nofollow noopener noreferrer" target="_blank">http://imysql.com/2014/07/04/mysql-optimization-case-rand-optimize.shtml</a></p></li><li><p>LIMIT huge_num, offset<br><a href="http://imysql.com/2015/04/02/mysql-optimization-case-discuz-hot-post-very-old-paging-optimizing.shtml" rel="external nofollow noopener noreferrer" target="_blank">http://imysql.com/2015/04/02/mysql-optimization-case-discuz-hot-post-very-old-paging-optimizing.shtml</a></p></li><li><p>SELECT COUNT(*) on InnoDB table</p></li><li><p>WHERE func(key_col) = ? â€“ æ— æ³•ä½¿ç”¨ç´¢å¼•</p></li><li><p>WHERE key_part2 =? AND key_part3 =? â€“ æ— æ³•ä½¿ç”¨ç´¢å¼•</p></li><li><p>WHERE key_part1 &gt; ? AND key_part2 =? â€“ åªèƒ½ç”¨åˆ°éƒ¨åˆ†ç´¢å¼•</p></li><li><p>SELECT â€¦ WHERE key_col + ? = ? â€“ æ— æ³•ä½¿ç”¨ç´¢å¼•</p></li></ul><h2 id="å¼€å¯-åˆ†ææ…¢æŸ¥è¯¢"><a href="#å¼€å¯-åˆ†ææ…¢æŸ¥è¯¢" class="headerlink" title="å¼€å¯/åˆ†ææ…¢æŸ¥è¯¢"></a>å¼€å¯/åˆ†ææ…¢æŸ¥è¯¢</h2><h3 id="å¼€å¯"><a href="#å¼€å¯" class="headerlink" title="å¼€å¯"></a>å¼€å¯</h3><p><strong>æ£€æŸ¥æ˜¯å¦å¼€å¯</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">'%slow%'</span>; //0ä¸ºæœªå¼€å¯</span><br></pre></td></tr></table></figure><p><strong>å¼€å¯æ…¢æŸ¥è¯¢</strong><br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//my.cnf æ·»åŠ </span><br><span class="line">[mysqld]</span><br><span class="line">log_slow_queries = æ—¥å¿—ä¿å­˜ä½ç½®</span><br><span class="line">long_query_time=1 <span class="comment">#è¶…è¿‡ä¸€ç§’çš„æŸ¥è¯¢ä¿å­˜åˆ°æ—¥å¿—</span></span><br><span class="line"><span class="built_in">log</span>-queries-not-using-indexes <span class="comment">#æ²¡æœ‰ä½¿ç”¨åˆ°ç´¢å¼•çš„æŸ¥è¯¢ä¿å­˜åœ¨æ—¥å¿—</span></span><br><span class="line"><span class="built_in">log</span>-slow-admin-statements <span class="comment">#ä¸€äº›ç®¡ç†æŒ‡ä»¤ï¼Œä¹Ÿä¼šè¢«è®°å½•ã€‚æ¯”å¦‚OPTIMEZE TABLE, ALTER TABLEç­‰ç­‰ã€‚</span></span><br></pre></td></tr></table></figure></p><h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><ol><li><p><strong>mysqldumpslow</strong></p><p>mysqlè‡ªå¸¦,å‚æ•°å¯â€“helpæŸ¥çœ‹</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># -sï¼šæ’åºæ–¹å¼ã€‚c , t , l , r è¡¨ç¤ºè®°å½•æ¬¡æ•°ã€æ—¶é—´ã€æŸ¥è¯¢æ—¶é—´çš„å¤šå°‘ã€è¿”å›çš„è®°å½•æ•°æ’åºï¼›</span><br><span class="line"># ac , at , al , ar è¡¨ç¤ºç›¸åº”çš„å€’åºï¼›</span><br><span class="line"># -tï¼šè¿”å›å‰é¢å¤šå°‘æ¡çš„æ•°æ®ï¼›</span><br><span class="line"># -gï¼šåŒ…å«ä»€ä¹ˆï¼Œå¤§å°å†™ä¸æ•æ„Ÿçš„ï¼›</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ¡ˆä¾‹ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysqldumpslow -s r -t 10 /slowquery.log #slowè®°å½•æœ€å¤šçš„10ä¸ªè¯­å¥</span><br><span class="line">mysqldumpslow -s t -t 10 -g "left join" /slowquery.log #æŒ‰ç…§æ—¶é—´æ’åºå‰10ä¸­å«æœ‰"left join"çš„</span><br></pre></td></tr></table></figure></li><li><p><strong>mysqlsla</strong></p><p>githubåœ°å€: <a href="https://github.com/daniel-nichter/hackmysql.com/tree/master/mysqlsla" rel="external nofollow noopener noreferrer" target="_blank">ç‚¹æ­¤è¿›å…¥</a></p><p>ä½¿ç”¨æ¡ˆä¾‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// mysqlslaä¼šè‡ªåŠ¨åˆ¤æ–­æ—¥å¿—ç±»å‹ï¼Œä¸ºäº†æ–¹ä¾¿å¯ä»¥å»ºç«‹ä¸€ä¸ªé…ç½®æ–‡ä»¶â€œ~/.mysqlslaâ€</span><br><span class="line">// åœ¨æ–‡ä»¶é‡Œå†™ä¸Šï¼štop=100ï¼Œè¿™æ ·ä¼šæ‰“å°å‡ºå‰100æ¡ç»“æœã€‚</span><br><span class="line">mysqlsla /data/mysqldata/slow.log</span><br></pre></td></tr></table></figure><p>ç»“æœè¯´æ˜</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">* queries total: æ€»æŸ¥è¯¢æ¬¡æ•°</span><br><span class="line">* unique:å»é‡åçš„sqlæ•°é‡</span><br><span class="line">* sorted by : è¾“å‡ºæŠ¥è¡¨çš„å†…å®¹æ’åºæœ€é‡å¤§çš„æ…¢sqlç»Ÿè®¡ä¿¡æ¯, åŒ…æ‹¬å¹³å‡æ‰§è¡Œæ—¶é—´, ç­‰å¾…é”æ—¶é—´, ç»“æœè¡Œçš„æ€»æ•°, æ‰«æçš„è¡Œæ€»æ•°.</span><br><span class="line">* Count, sqlçš„æ‰§è¡Œæ¬¡æ•°åŠå æ€»çš„slow logæ•°é‡çš„ç™¾åˆ†æ¯”.</span><br><span class="line">* Time, æ‰§è¡Œæ—¶é—´, åŒ…æ‹¬æ€»æ—¶é—´, å¹³å‡æ—¶é—´, æœ€å°, æœ€å¤§æ—¶é—´, æ—¶é—´å åˆ°æ€»æ…¢sqlæ—¶é—´çš„ç™¾åˆ†æ¯”.</span><br><span class="line">* 95% of Time, å»é™¤æœ€å¿«å’Œæœ€æ…¢çš„sql, è¦†ç›–ç‡å 95%çš„sqlçš„æ‰§è¡Œæ—¶é—´.</span><br><span class="line">* Lock Time, ç­‰å¾…é”çš„æ—¶é—´.</span><br><span class="line">* 95% of Lock , 95%çš„æ…¢sqlç­‰å¾…é”æ—¶é—´.</span><br><span class="line">* Rows sent, ç»“æœè¡Œç»Ÿè®¡æ•°é‡, åŒ…æ‹¬å¹³å‡, æœ€å°, æœ€å¤§æ•°é‡.</span><br><span class="line">* Rows examined, æ‰«æçš„è¡Œæ•°é‡.</span><br><span class="line">* Database, å±äºå“ªä¸ªæ•°æ®åº“</span><br><span class="line">* Users, å“ªä¸ªç”¨æˆ·,IP, å åˆ°æ‰€æœ‰ç”¨æˆ·æ‰§è¡Œçš„sqlç™¾åˆ†æ¯”</span><br><span class="line">* Query abstract, æŠ½è±¡åçš„sqlè¯­å¥</span><br><span class="line">* Query sample, sqlè¯­å¥</span><br></pre></td></tr></table></figure></li></ol><h2 id="ä¼˜åŒ–ç´¢å¼•"><a href="#ä¼˜åŒ–ç´¢å¼•" class="headerlink" title="ä¼˜åŒ–ç´¢å¼•"></a>ä¼˜åŒ–ç´¢å¼•</h2><ol><li><p>å®šæœŸæ£€æŸ¥å¹¶åˆ é™¤é‡å¤çš„ç´¢å¼•<br>ç”¨ pt-duplicate-key-checker å·¥å…·<br>æ¯”å¦‚ index idx1(a, b) ç´¢å¼•å·²ç»æ¶µç›–äº† index idx2(a)ï¼Œå°±å¯ä»¥åˆ é™¤ idx2 ç´¢å¼•äº†ã€‚</p></li><li><p>ç´¢å¼•é‡<br>åŸºäºç´¢å¼•çš„æ¡ä»¶è¿‡æ»¤ï¼Œå¦‚æœä¼˜åŒ–å™¨æ„è¯†åˆ°æ€»å…±éœ€è¦æ‰«æçš„æ•°æ®é‡è¶…è¿‡ <strong>30%</strong> æ—¶ï¼Œå°±ä¼šç›´æ¥æ”¹å˜æ‰§è¡Œè®¡åˆ’ä¸ºå…¨è¡¨æ‰«æï¼Œä¸å†ä½¿ç”¨ç´¢å¼•ã€‚</p></li><li><p>è”åˆç´¢å¼•<br>WHEREä¸­è¿‡æ»¤æ¡ä»¶çš„å­—æ®µé¡ºåºå’Œç´¢å¼• <strong>æ— éœ€ä¸€è‡´</strong><br>æ’åºã€åˆ†ç»„åˆ™å°± <strong>å¿…é¡»ä¸€è‡´</strong></p></li><li><p>åˆç†åˆ©ç”¨è¦†ç›–ç´¢å¼•ï¼Œä½†å­—æ®µå°½é‡ä¸è¶…è¿‡5ä¸ª</p></li><li><p>åˆç†åˆ©ç”¨æœ€å·¦ç´¢å¼•ï¼ˆå‰ç¼€ç´¢å¼•/éƒ¨åˆ†ç´¢å¼•ï¼‰</p></li><li><p>åŠæ—¶åˆ é™¤å†—ä½™ç´¢å¼•</p></li><li><p>ç´¢å¼•å­—æ®µæ¡ä»¶ä¸ä½¿ç”¨å‡½æ•°</p></li><li><p>å†…å­˜è¡¨(HEAP è¡¨)ä½¿ç”¨HASHç´¢å¼•æ—¶ï¼Œä¸èƒ½ä½¿ç”¨èŒƒå›´æ£€ç´¢æˆ–è€…ORDER BYç­‰ï¼Œåªèƒ½ä½¿ç”¨=æˆ–è€…!=</p></li><li><p>ä¸¤ä¸ªç‹¬ç«‹ç´¢å¼•ï¼Œå…¶ä¸­ä¸€ä¸ªç”¨äºæ£€ç´¢ï¼Œä¸€ä¸ªç”¨äºæ’åº â€“ åªèƒ½ç”¨åˆ°å…¶ä¸­ä¸€ä¸ªç´¢å¼•ï¼Œ5.6ä»¥ä¸Šæœ‰ICPç‰¹æ€§<br>ä¼˜åŒ–å™¨åˆ¤æ–­ä½¿ç”¨å“ªä¸ªç´¢å¼•</p></li><li><p>è¡¨å…³è”å­—æ®µç±»å‹è¦ä¸€æ ·ï¼ˆä¹ŸåŒ…æ‹¬é•¿åº¦ä¸€æ ·ï¼‰ï¼Œå¦åˆ™ä¼šæœ‰ç±»å‹éšå¼è½¬æ¢</p></li></ol><h1 id="æ•°æ®åº“ä¼˜åŒ–"><a href="#æ•°æ®åº“ä¼˜åŒ–" class="headerlink" title="æ•°æ®åº“ä¼˜åŒ–"></a>æ•°æ®åº“ä¼˜åŒ–</h1><h2 id="å†…å­˜ä¼˜åŒ–"><a href="#å†…å­˜ä¼˜åŒ–" class="headerlink" title="å†…å­˜ä¼˜åŒ–"></a>å†…å­˜ä¼˜åŒ–</h2><p>æ³¨æ„å†…å­˜çš„ä½¿ç”¨ä¼˜åŒ–ï¼š<a href="">ç³»ç»Ÿä¸è½¯ä»¶-&gt;å†…å­˜ä½¿ç”¨è€ƒé‡</a></p><h2 id="æŸ¥çœ‹-åˆ†æèµ„æºæ¶ˆè€—"><a href="#æŸ¥çœ‹-åˆ†æèµ„æºæ¶ˆè€—" class="headerlink" title="æŸ¥çœ‹/åˆ†æèµ„æºæ¶ˆè€—"></a>æŸ¥çœ‹/åˆ†æèµ„æºæ¶ˆè€—</h2><p><strong>SHOW PROFILE å’Œ SHOW PROFILES</strong></p><h3 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h3><ol><li>ä½œç”¨åŸŸæ˜¯ä¼šè¯çº§ï¼›</li><li>SHOW PROFILESæ˜¾ç¤ºæœ€è¿‘å‘ç»™æœåŠ¡å™¨çš„å¤šæ¡è¯­å¥ï¼Œæ¡æ•°æ ¹æ®ä¼šè¯å˜é‡profiling_history_sizeå®šä¹‰ï¼Œé»˜è®¤æ˜¯15ï¼Œæœ€å¤§å€¼ä¸º100ã€‚è®¾ä¸º0ç­‰ä»·äºå…³é—­åˆ†æåŠŸèƒ½ã€‚</li><li><strong>é»˜è®¤æ˜¯å…³é—­</strong>ï¼›å…¶æ˜¯å¦å¯ç”¨æ˜¯æ ¹æ®ä¼šè¯çº§çš„å˜é‡profiling</li><li>mysql5.7ä»¥åä¸å»ºè®®ä½¿ç”¨SHOW PROFILEæŒ‡ä»¤ï¼Œæˆ–ç›´æ¥ä»INFORMATION_SCHEMA.PROFILINGä¸­æŸ¥çœ‹ï¼Œå»ºè®®åˆ©ç”¨PERFORMANCE_SCHEMAä¸­çš„å‡ ä¸ªè§†å›¾æŸ¥çœ‹ã€‚ï¼ˆå› ä¸ºä¼šè¢«åºŸå¼ƒï¼‰</li></ol><h3 id="å¼€å¯-1"><a href="#å¼€å¯-1" class="headerlink" title="å¼€å¯"></a>å¼€å¯</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SET profiling=1;æˆ– SET profiling=on;</span><br></pre></td></tr></table></figure><h3 id="å…³é—­"><a href="#å…³é—­" class="headerlink" title="å…³é—­"></a>å…³é—­</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SET profiling=0;æˆ– SET profiling=off;</span><br></pre></td></tr></table></figure><h3 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> PROFILE [<span class="keyword">type</span> [, <span class="keyword">type</span>] â€¦ ][<span class="keyword">FOR</span> <span class="keyword">QUERY</span> n][<span class="keyword">LIMIT</span> <span class="keyword">row_count</span> [<span class="keyword">OFFSET</span> <span class="keyword">offset</span>]]</span><br></pre></td></tr></table></figure><p>typeæ˜¯å¯é€‰çš„ï¼Œå–å€¼èŒƒå›´å¯ä»¥å¦‚ä¸‹ï¼š</p><ul><li>ALL æ˜¾ç¤ºæ‰€æœ‰æ€§èƒ½ä¿¡æ¯</li><li>BLOCK IO æ˜¾ç¤ºå—IOæ“ä½œçš„æ¬¡æ•°</li><li>CONTEXT SWITCHES æ˜¾ç¤ºä¸Šä¸‹æ–‡åˆ‡æ¢æ¬¡æ•°ï¼Œä¸ç®¡æ˜¯ä¸»åŠ¨è¿˜æ˜¯è¢«åŠ¨</li><li>CPU æ˜¾ç¤ºç”¨æˆ·CPUæ—¶é—´ã€ç³»ç»ŸCPUæ—¶é—´</li><li>IPC æ˜¾ç¤ºå‘é€å’Œæ¥æ”¶çš„æ¶ˆæ¯æ•°é‡</li><li>MEMORY [æš‚æœªå®ç°]</li><li>PAGE FAULTS æ˜¾ç¤ºé¡µé”™è¯¯æ•°é‡</li><li>SOURCE æ˜¾ç¤ºæºç ä¸­çš„å‡½æ•°åç§°ä¸ä½ç½®</li><li>SWAPS æ˜¾ç¤ºSWAPçš„æ¬¡æ•°</li></ul><p>SHOW PROFILE FOR QUERY nï¼Œè¿™é‡Œçš„nå°±æ˜¯å¯¹åº”SHOW PROFILESè¾“å‡ºä¸­çš„Query_IDã€‚<br>å¦‚æœæ²¡æœ‰æŒ‡å®šFOR QUERYï¼Œé‚£ä¹ˆè¾“å‡ºæœ€è¿‘ä¸€æ¡è¯­å¥çš„ä¿¡æ¯ã€‚</p><p><code>SHOW PROFILE ALL FOR QUERY 2</code> çš„ä¿¡æ¯è¿˜å¯ä»¥é€šè¿‡<code>SELECT * FROM information_schema.profiling WHERE query_id = 2 ORDER BY seq;</code>è·å–ã€‚</p><p>å‚è€ƒï¼š<br><a href="http://dev.mysql.com/doc/refman/5.5/en/show-profile.html" rel="external nofollow noopener noreferrer" target="_blank">http://dev.mysql.com/doc/refman/5.5/en/show-profile.html</a></p><h2 id="æŸ¥çœ‹æ‰§è¡ŒçŠ¶æ€"><a href="#æŸ¥çœ‹æ‰§è¡ŒçŠ¶æ€" class="headerlink" title="æŸ¥çœ‹æ‰§è¡ŒçŠ¶æ€"></a>æŸ¥çœ‹æ‰§è¡ŒçŠ¶æ€</h2><h3 id="æŸ¥çœ‹å‘½ä»¤"><a href="#æŸ¥çœ‹å‘½ä»¤" class="headerlink" title="æŸ¥çœ‹å‘½ä»¤"></a>æŸ¥çœ‹å‘½ä»¤</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> [<span class="keyword">FULL</span>] <span class="keyword">PROCESSLIST</span></span><br></pre></td></tr></table></figure><p>SHOW PROCESSLISTæ˜¾ç¤ºå“ªäº›çº¿ç¨‹æ­£åœ¨è¿è¡Œã€‚æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨mysqladmin processlistè¯­å¥å¾—åˆ°æ­¤ä¿¡æ¯ã€‚å¦‚æœæ‚¨æœ‰SUPERæƒé™ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°æ‰€æœ‰çº¿ç¨‹ã€‚å¦åˆ™ï¼Œæ‚¨åªèƒ½çœ‹åˆ°æ‚¨è‡ªå·±çš„çº¿ç¨‹ï¼ˆä¹Ÿå°±æ˜¯ï¼Œä¸æ‚¨æ­£åœ¨ä½¿ç”¨çš„MySQLè´¦æˆ·ç›¸å…³çš„çº¿ç¨‹ï¼‰ã€‚å¦‚æœæ‚¨ä¸ä½¿ç”¨FULLå…³é”®è¯ï¼Œåˆ™åªæ˜¾ç¤ºæ¯ä¸ªæŸ¥è¯¢çš„å‰100ä¸ªå­—ç¬¦ã€‚</p><h3 id="Command"><a href="#Command" class="headerlink" title="Command"></a>Command</h3><p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://dev.mysql.com/doc/refman/5.6/en/thread-commands.html" rel="external nofollow noopener noreferrer" target="_blank">https://dev.mysql.com/doc/refman/5.6/en/thread-commands.html</a></p><ul><li><p>Sleep<br>é€šå¸¸ä»£è¡¨èµ„æºæœªé‡Šæ”¾ï¼Œå¦‚æœæ˜¯é€šè¿‡è¿æ¥æ± ï¼ŒsleepçŠ¶æ€åº”è¯¥æ’å®šåœ¨ä¸€å®šæ•°é‡èŒƒå›´å†…</p><p>å®ä¾‹:å› å‰ç«¯æ•°æ®è¾“å‡ºæ—¶ï¼ˆç‰¹åˆ«æ˜¯è¾“å‡ºåˆ°ç”¨æˆ·ç»ˆç«¯ï¼‰æœªåŠæ—¶å…³é—­æ•°æ®åº“è¿æ¥ï¼Œå¯¼è‡´å› ç½‘ç»œè¿æ¥é€Ÿåº¦äº§ç”Ÿå¤§é‡sleepè¿æ¥ï¼Œåœ¨ç½‘é€Ÿå‡ºç°å¼‚å¸¸æ—¶ï¼Œæ•°æ®åº“ too many connectionsæŒ‚æ­»ã€‚</p><p>ç®€å•è§£è¯»ï¼Œæ•°æ®æŸ¥è¯¢å’Œæ‰§è¡Œé€šå¸¸åªéœ€è¦ä¸åˆ°0.01ç§’ï¼Œè€Œç½‘ç»œè¾“å‡ºé€šå¸¸éœ€è¦1ç§’å·¦å³ç”šè‡³æ›´é•¿ï¼ŒåŸæœ¬æ•°æ®è¿æ¥åœ¨0.01ç§’å³å¯é‡Šæ”¾ï¼Œä½†æ˜¯å› ä¸ºå‰ç«¯ç¨‹åºæœªæ‰§è¡Œcloseæ“ä½œï¼Œç›´æ¥è¾“å‡ºç»“æœï¼Œé‚£ä¹ˆåœ¨ ç»“æœæœªå±•ç°åœ¨ç”¨æˆ·æ¡Œé¢å‰ï¼Œè¯¥æ•°æ®åº“è¿æ¥ä¸€ç›´ç»´æŒåœ¨sleepçŠ¶æ€ï¼</p></li><li><p>Waiting for net / reading from net / writing to net<br>å¶å°”å‡ºç°æ— å¦¨ï¼Œå¦‚å¤§é‡å‡ºç°ï¼Œè¿…é€Ÿæ£€æŸ¥æ•°æ®åº“åˆ°å‰ç«¯çš„ç½‘ç»œè¿æ¥çŠ¶æ€å’Œæµé‡<br>Reading from net è¡¨ç¤ºserverç«¯æ­£é€šè¿‡ç½‘ç»œè¯»å–å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„è¯·æ±‚å»ºè®®ï¼šå‡å°å®¢æˆ·ç«¯å‘é€æ•°æ®åŒ…å¤§å°ï¼Œæé«˜ç½‘ç»œå¸¦å®½/è´¨é‡<br>Writing to neté€šè¿‡ç½‘ç»œä¼ è¾“æ•°æ®</p><p>æ¡ˆä¾‹: å› å¤–æŒ‚ç¨‹åºï¼Œå†…ç½‘æ•°æ®åº“å¤§é‡è¯»å–ï¼Œå†…ç½‘ä½¿ç”¨çš„ç™¾å…†äº¤æ¢è¿…é€Ÿçˆ†æ»¡ï¼Œå¯¼è‡´å¤§é‡è¿æ¥é˜»å¡åœ¨waiting for netï¼Œæ•°æ®åº“è¿æ¥è¿‡å¤šå´©æºƒ</p></li><li><p>Locked<br>æœ‰æ›´æ–°æ“ä½œé”å®šï¼Œé€šå¸¸ä½¿ç”¨innodbå¯ä»¥å¾ˆå¥½çš„å‡å°‘lockedçŠ¶æ€çš„äº§ç”Ÿï¼Œä½†æ˜¯åˆ‡è®°ï¼Œæ›´æ–°æ“ä½œè¦æ­£ç¡®ä½¿ç”¨ç´¢å¼•ï¼Œå³ä¾¿æ˜¯ä½é¢‘æ¬¡æ›´æ–°æ“ä½œä¹Ÿä¸èƒ½ç–å¿½ã€‚å¦‚ä¸Šå½±å“ç»“æœé›†èŒƒä¾‹æ‰€ç¤ºã€‚<br>åœ¨myisamçš„æ—¶ä»£ï¼Œlockedæ˜¯å¾ˆå¤šé«˜å¹¶å‘åº”ç”¨çš„å™©æ¢¦ã€‚æ‰€ä»¥mysqlå®˜æ–¹ä¹Ÿå¼€å§‹å€¾å‘äºæ¨èinnodbã€‚</p></li><li><p>Copy to tmp table<br>ç´¢å¼•åŠç°æœ‰ç»“æ„æ— æ³•æ¶µç›–æŸ¥è¯¢æ¡ä»¶ï¼Œæ‰ä¼šå»ºç«‹ä¸€ä¸ªä¸´æ—¶è¡¨æ¥æ»¡è¶³æŸ¥è¯¢è¦æ±‚ï¼Œäº§ç”Ÿå·¨å¤§çš„ææ€–çš„i/oå‹åŠ›ã€‚<br>å¾ˆå¯æ€•çš„æœç´¢è¯­å¥ä¼šå¯¼è‡´è¿™æ ·çš„æƒ…å†µï¼Œå¦‚æœæ˜¯æ•°æ®åˆ†æï¼Œæˆ–è€…åŠå¤œçš„å‘¨æœŸæ•°æ®æ¸…ç†ä»»åŠ¡ï¼Œå¶å°”å‡ºç°ï¼Œå¯ä»¥å…è®¸ã€‚é¢‘ç¹å‡ºç°åŠ¡å¿…ä¼˜åŒ–ä¹‹ã€‚<br>æ‰§è¡ŒALTER TABLEä¿®æ”¹è¡¨ç»“æ„æ—¶å»ºè®®ï¼šæ”¾åœ¨å‡Œæ™¨æ‰§è¡Œæˆ–è€…é‡‡ç”¨ç±»ä¼¼pt-oscå·¥å…·<br>é€šå¸¸ä¸è¿è¡¨æŸ¥è¯¢æœ‰å…³ï¼Œå»ºè®®é€æ¸ä¹ æƒ¯ä¸ä½¿ç”¨è¿è¡¨æŸ¥è¯¢ã€‚</p><p>å®æˆ˜èŒƒä¾‹ï¼šæŸç¤¾åŒºæ•°æ®åº“é˜»å¡ï¼Œæ±‚æ•‘ï¼Œç»æŸ¥ï¼Œå…¶æœåŠ¡å™¨å­˜åœ¨å¤šä¸ªæ•°æ®åº“åº”ç”¨å’Œç½‘ç«™ï¼Œå…¶ä¸­ä¸€ä¸ªä¸å¸¸ç”¨çš„å°ç½‘ç«™æ•°æ®åº“äº§ç”Ÿäº†ä¸€ä¸ªææ€–çš„copy to tmp table æ“ä½œï¼Œå¯¼è‡´æ•´ä¸ªç¡¬ç›˜i/oå’Œcpuå‹åŠ›è¶…è½½ã€‚Killæ‰è¯¥æ“ä½œä¸€åˆ‡æ¢å¤ã€‚</p></li><li><p>Copying to tmp table<br>æ‹·è´æ•°æ®åˆ°å†…å­˜ä¸­çš„ä¸´æ—¶è¡¨ï¼Œå¸¸è§äºGROUP BYæ“ä½œæ—¶,å»ºè®®ï¼šåˆ›å»ºé€‚å½“çš„ç´¢å¼•</p></li><li><p>Copying to tmp table on disk<br>ä¸´æ—¶ç»“æœé›†å¤ªå¤§ï¼Œå†…å­˜ä¸­æ”¾ä¸ä¸‹ï¼Œéœ€è¦å°†å†…å­˜ä¸­çš„ä¸´æ—¶è¡¨æ‹·è´åˆ°ç£ç›˜ä¸Šï¼Œå½¢æˆ <code>*sql.MYD</code>ã€<code>*sql.MYI</code>ï¼ˆåœ¨5.6åŠæ›´é«˜çš„ç‰ˆæœ¬ï¼Œä¸´æ—¶è¡¨å¯ä»¥æ”¹æˆInnoDBå¼•æ“äº†ï¼Œå¯ä»¥å‚è€ƒé€‰é¡¹default_tmp_storage_engineï¼‰å»ºè®®ï¼šåˆ›å»ºé€‚å½“çš„ç´¢å¼•ï¼Œå¹¶ä¸”é€‚å½“åŠ å¤§sort_buffer_size/tmp_table_size/max_heap_table_size</p></li><li><p>Creating sort index<br>å½“å‰çš„SELECTä¸­éœ€è¦ç”¨åˆ°ä¸´æ—¶è¡¨åœ¨è¿›è¡ŒORDER BYæ’åºï¼Œå»ºè®®ï¼šåˆ›å»ºé€‚å½“çš„ç´¢å¼•</p></li><li><p>Sending data<br>å¹¶ä¸æ˜¯å‘é€æ•°æ®ï¼Œåˆ«è¢«è¿™ä¸ªåå­—æ‰€æ¬ºéª—ï¼Œè¿™æ˜¯ä»ç‰©ç†ç£ç›˜è·å–æ•°æ®çš„è¿›ç¨‹ï¼Œå¦‚æœä½ çš„å½±å“ç»“æœé›†è¾ƒå¤šï¼Œé‚£ä¹ˆå°±éœ€è¦ä»ä¸åŒçš„ç£ç›˜ç¢ç‰‡å»æŠ½å–æ•°æ®ï¼Œ<br>å¶å°”å‡ºç°è¯¥çŠ¶æ€è¿æ¥æ— ç¢ã€‚å›åˆ°ä¸Šé¢å½±å“ç»“æœé›†çš„é—®é¢˜ï¼Œä¸€èˆ¬è€Œè¨€ï¼Œå¦‚æœsending dataè¿æ¥è¿‡å¤šï¼Œé€šå¸¸æ˜¯æŸæŸ¥è¯¢çš„å½±å“ç»“æœé›†è¿‡å¤§ï¼Œä¹Ÿå°±æ˜¯æŸ¥è¯¢çš„ç´¢å¼•é¡¹ä¸å¤Ÿä¼˜åŒ–ã€‚<br>å‰æ–‡æåˆ°å½±å“ç»“æœé›†å¯¹SQLæŸ¥è¯¢æ•ˆç‡çº¿æ€§ç›¸å…³ï¼Œä¸»è¦å°±æ˜¯é’ˆå¯¹è¿™ä¸ªçŠ¶æ€çš„ç³»ç»Ÿå¼€é”€ã€‚<br>å¦‚æœå‡ºç°å¤§é‡ç›¸ä¼¼çš„SQLè¯­å¥å‡ºç°åœ¨show proessliståˆ—è¡¨ä¸­ï¼Œå¹¶ä¸”éƒ½å¤„äºsending dataçŠ¶æ€ï¼Œä¼˜åŒ–æŸ¥è¯¢ç´¢å¼•ï¼Œè®°ä½ç”¨å½±å“ç»“æœé›†çš„æ€è·¯å»æ€è€ƒã€‚<br>ä»serverç«¯å‘é€æ•°æ®åˆ°å®¢æˆ·ç«¯ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯æ¥æ”¶å­˜å‚¨å¼•æ“å±‚è¿”å›çš„æ•°æ®ï¼Œå†å‘é€ç»™å®¢æˆ·ç«¯ï¼Œæ•°æ®é‡å¾ˆå¤§æ—¶å°¤å…¶ç»å¸¸èƒ½çœ‹è§å¤‡æ³¨ï¼šSending Dataä¸æ˜¯ç½‘ç»œå‘é€ï¼Œæ˜¯ä»ç¡¬ç›˜è¯»å–ï¼Œå‘é€åˆ°ç½‘ç»œæ˜¯Writing to net</p><p>å»ºè®®ï¼šé€šè¿‡ç´¢å¼•æˆ–åŠ ä¸ŠLIMITï¼Œå‡å°‘éœ€è¦æ‰«æå¹¶ä¸”å‘é€ç»™å®¢æˆ·ç«¯çš„æ•°æ®é‡</p></li><li><p>Creating tmp table<br>åˆ›å»ºåŸºäºå†…å­˜æˆ–ç£ç›˜çš„ä¸´æ—¶è¡¨ï¼Œå½“ä»å†…å­˜è½¬æˆç£ç›˜çš„ä¸´æ—¶è¡¨æ—¶ï¼ŒçŠ¶æ€ä¼šå˜æˆï¼šCopying to tmp table on disk<br>å»ºè®®ï¼šåˆ›å»ºé€‚å½“çš„ç´¢å¼•ï¼Œæˆ–è€…å°‘ç”¨UNIONã€è§†å›¾(VIEW)ã€å­æŸ¥è¯¢(SUBQUERY)ä¹‹ç±»çš„ï¼Œç¡®å®éœ€è¦ç”¨åˆ°ä¸´æ—¶è¡¨çš„æ—¶å€™ï¼Œå¯ä»¥åœ¨sessionçº§ä¸´æ—¶é€‚å½“è°ƒå¤§ tmp_table_size/max_heap_table_size çš„å€¼</p></li><li><p>Storing result to query cache<br>å‡ºç°è¿™ç§çŠ¶æ€ï¼Œå¦‚æœé¢‘ç¹å‡ºç°ï¼Œä½¿ç”¨set profilingåˆ†æï¼Œå¦‚æœå­˜åœ¨èµ„æºå¼€é”€åœ¨SQLæ•´ä½“å¼€é”€çš„æ¯”ä¾‹è¿‡å¤§ï¼ˆå³ä¾¿æ˜¯éå¸¸å°çš„å¼€é”€ï¼Œçœ‹æ¯”ä¾‹ï¼‰ï¼Œåˆ™è¯´æ˜query cacheç¢ç‰‡è¾ƒå¤š<br>ä½¿ç”¨flush query cache å¯å³æ—¶æ¸…ç†ï¼Œä¹Ÿå¯ä»¥åšæˆå®šæ—¶ä»»åŠ¡<br>Query cacheå‚æ•°å¯é€‚å½“é…Œæƒ…è®¾ç½®ã€‚</p></li><li><p>Freeing items<br>ç†è®ºä¸Šè¿™ç©æ„ä¸ä¼šå‡ºç°å¾ˆå¤šã€‚å¶å°”å‡ºç°æ— ç¢<br>å¦‚æœå¤§é‡å‡ºç°ï¼Œå†…å­˜ï¼Œç¡¬ç›˜å¯èƒ½å·²ç»å‡ºç°é—®é¢˜ã€‚æ¯”å¦‚ç¡¬ç›˜æ»¡æˆ–æŸåã€‚<br>i/oå‹åŠ›è¿‡å¤§æ—¶ï¼Œä¹Ÿå¯èƒ½å‡ºç°Free itemsæ‰§è¡Œæ—¶é—´è¾ƒé•¿çš„æƒ…å†µã€‚</p></li><li><p>Sorting for â€¦<br>å’ŒSending dataç±»ä¼¼ï¼Œç»“æœé›†è¿‡å¤§ï¼Œæ’åºæ¡ä»¶æ²¡æœ‰ç´¢å¼•åŒ–ï¼Œéœ€è¦åœ¨å†…å­˜é‡Œæ’åºï¼Œç”šè‡³éœ€è¦åˆ›å»ºä¸´æ—¶ç»“æ„æ’åºã€‚</p></li><li><p>Sorting result<br>æ­£åœ¨å¯¹ç»“æœè¿›è¡Œæ’åºï¼Œç±»ä¼¼Creating sort indexï¼Œä¸è¿‡æ˜¯æ­£å¸¸è¡¨ï¼Œè€Œä¸æ˜¯åœ¨å†…å­˜è¡¨ä¸­è¿›è¡Œæ’åºå»ºè®®ï¼šåˆ›å»ºé€‚å½“çš„ç´¢å¼•</p></li><li><p>statistics<br>è¿›è¡Œæ•°æ®ç»Ÿè®¡ä»¥ä¾¿è§£ææ‰§è¡Œè®¡åˆ’ï¼Œå¦‚æœçŠ¶æ€æ¯”è¾ƒç»å¸¸å‡ºç°ï¼Œæœ‰å¯èƒ½æ˜¯ç£ç›˜IOæ€§èƒ½å¾ˆå·®å»ºè®®ï¼šæŸ¥çœ‹å½“å‰ioæ€§èƒ½çŠ¶æ€ï¼Œä¾‹å¦‚iowait</p></li><li><p>Waiting for global read lock<br>FLUSH TABLES WITH READ LOCKæ•´ç­‰å¾…å…¨å±€è¯»é”<br>å»ºè®®ï¼šä¸è¦å¯¹çº¿ä¸Šä¸šåŠ¡æ•°æ®åº“åŠ ä¸Šå…¨å±€è¯»é”ï¼Œé€šå¸¸æ˜¯å¤‡ä»½å¼•èµ·ï¼Œå¯ä»¥æ”¾åœ¨ä¸šåŠ¡ä½è°·æœŸé—´æ‰§è¡Œæˆ–è€…æ”¾åœ¨slaveæœåŠ¡å™¨ä¸Šæ‰§è¡Œå¤‡ä»½</p></li><li><p>Waiting for tables,Waiting for table flush<br>FLUSH TABLES, ALTER TABLE, RENAME TABLE, REPAIR TABLE, ANALYZE TABLE, OPTIMIZE TABLEç­‰éœ€è¦åˆ·æ–°è¡¨ç»“æ„å¹¶é‡æ–°æ‰“å¼€<br>å»ºè®®ï¼šä¸è¦å¯¹çº¿ä¸Šä¸šåŠ¡æ•°æ®åº“æ‰§è¡Œè¿™äº›æ“ä½œï¼Œå¯ä»¥æ”¾åœ¨ä¸šåŠ¡ä½è°·æœŸé—´æ‰§è¡Œ</p></li><li><p>Waiting for lock_type lock<br>ç­‰å¾…å„ç§ç±»å‹çš„é”ï¼š</p><ul><li>Waiting for event metadata lock</li><li>Waiting for global read lock</li><li>Waiting for schema metadata lock</li><li>Waiting for stored function metadata lock</li><li>Waiting for stored procedure metadata lock</li><li>Waiting for table level lock</li><li>Waiting for table metadata lock</li><li>Waiting for trigger metadata lock</li></ul><p>å»ºè®®ï¼šæ¯”è¾ƒå¸¸è§çš„æ˜¯ä¸Šé¢æåˆ°çš„global read lockä»¥åŠtable metadata lockï¼Œå»ºè®®ä¸è¦å¯¹çº¿ä¸Šä¸šåŠ¡æ•°æ®åº“æ‰§è¡Œè¿™äº›æ“ä½œï¼Œå¯ä»¥æ”¾åœ¨ä¸šåŠ¡ä½è°·æœŸé—´æ‰§è¡Œã€‚å¦‚æœæ˜¯table level lockï¼Œé€šå¸¸æ˜¯å› ä¸ºè¿˜åœ¨ä½¿ç”¨MyISAMå¼•æ“è¡¨ï¼Œèµ¶ç´§è½¬æŠ•InnoDBå¼•æ“å§ï¼Œåˆ«å†è€é¡½å›ºäº†</p></li></ul><h3 id="State"><a href="#State" class="headerlink" title="State"></a>State</h3><p>å®˜æ–¹æ–‡æ¡£:<a href="http://dev.mysql.com/doc/refman/5.6/en/general-thread-states.html" rel="external nofollow noopener noreferrer" target="_blank">http://dev.mysql.com/doc/refman/5.6/en/general-thread-states.html</a></p><ul><li><p>After create<br>å½“çº¿ç¨‹åˆ›å»ºè¡¨ï¼ˆåŒ…æ‹¬ä¸´æ—¶è¡¨ï¼‰</p></li><li><p>Analyzing<br>çº¿ç¨‹æ­£åœ¨åˆ†æMYISAMçš„keyåˆ†å¸ƒ</p></li><li><p>checking permissions<br>çº¿ç¨‹æ­£åœ¨æ£€æŸ¥æ‰§è¡Œè¯­å¥çš„æƒé™</p></li><li><p>Checking table<br>çº¿ç¨‹æ­£åœ¨æ‰§è¡Œè¡¨checkæ“ä½œ</p></li><li><p>Cleaning up<br>çº¿ç¨‹å·²ç»å¤„ç†å®Œä¸€ä¸ªå‘½ä»¤ç„¶åå¼€å§‹å‡†å¤‡é‡Šæ”¾å†…å­˜å’ŒresetçŠ¶æ€å˜é‡</p></li><li><p>Closing tables<br>çº¿ç¨‹æŠŠæ”¹å˜çš„è¡¨æ•°æ®flushåˆ°ç£ç›˜ç„¶åå…³é—­ä½¿ç”¨çš„è¡¨ã€‚è¿™ä¸ªæ“ä½œåº”è¯¥æ˜¯å¾ˆå¿«çš„ï¼Œå¦‚æœè¿™ä¸ªçŠ¶æ€é•¿æ—¶é—´å‡ºç°ï¼Œè¦ç•™æ„æ£€æŸ¥ç£ç›˜çš„çŠ¶æ€ã€‚</p></li><li><p>Converting HEAP to MyISAM<br>æŠŠä¸€ä¸ªå†…å­˜ä¸­çš„ä¸´æ—¶è¡¨è½¬æ¢åˆ°ç£ç›˜ä¸Šçš„MYISAMè¡¨</p></li><li><p>Copy to tmp table<br>çº¿ç¨‹æ‰§è¡Œalter tableè¯­å¥ã€‚è¿™ä¸ªçŠ¶æ€å‡ºç°åœ¨æ–°çš„è¡¨ç»“æ„å·²ç»åˆ›å»ºä½†æ•°æ®è¿˜åœ¨æ‹·è´åˆ°æ–°è¡¨ä¹‹å‰ã€‚</p></li><li><p>Copying to group table<br>å¦‚æœä¸€ä¸ªè¯­å¥çš„group byå’Œorder by æ¡ä»¶ä¸åŒï¼Œæ•°æ®é€šè¿‡group byæ¥æ’åºç„¶åæ‹·è´åˆ°ä¸´æ—¶è¡¨</p></li><li><p>Copying to tmp table<br>æ‹·è´åˆ°å†…å­˜ä¸­çš„ä¸´æ—¶è¡¨</p></li><li><p>Copying to tmp table on disk<br>å¦‚æœä¸´æ—¶è¡¨è¿‡å¤§ï¼ŒæœåŠ¡å™¨è¦æŠŠå†…å­˜ä¸­çš„ä¸´æ—¶è¡¨æ‹·è´åˆ°ç£ç›˜ã€‚</p></li><li><p>Creating index<br>å¯¹ä¸€ä¸ªMYISAM æ‰§è¡ŒALTER TABLE â€¦ ENABLE KEYS</p></li><li><p>Creating sort index<br>çº¿ç¨‹é€šè¿‡æ‰§è¡Œä¸€ä¸ªä¸´æ—¶è¡¨æ¥æ‰§è¡Œselectè¯­å¥</p></li><li><p>Creating table<br>çº¿ç¨‹æ­£åœ¨åˆ›å»ºè¡¨ï¼ˆåŒ…æ‹¬ä¸´æ—¶è¡¨ï¼‰</p></li><li><p>Creating tmp table<br>åˆ›å»ºä¸´æ—¶è¡¨ï¼ˆåœ¨å†…å­˜æˆ–è€…ç£ç›˜ï¼‰ä¸Šï¼Œå¦‚æœè¡¨ä¸€å¼€å§‹åœ¨å†…å­˜ä¸­åˆ°åé¢å¤ªå¤§ï¼Œä¸´æ—¶è¡¨å°±ä¼šè½¬æ¢åˆ°ç£ç›˜ä¸Šï¼Œè€Œä¸”çŠ¶æ€ä¹Ÿä¼šå˜æˆCopying to tmp table on disk</p></li><li><p>deleting from main table<br>æœåŠ¡å™¨æ­£åœ¨æ‰§è¡Œä¸€ä¸ªå¤šè¡¨deleteè¯­å¥çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯ä»ç¬¬ä¸€å¼ è¡¨åˆ é™¤æ•°æ®ï¼Œå¹¶ä¸”ä¿ç•™è¡Œä»¥åŠåç§»é‡æ•°æ®ä»¥ç”¨æ¥åˆ é™¤å…¶ä»–è¡¨ä¸­çš„æ•°æ®ã€‚</p></li><li><p>deleting from reference tables<br>æœåŠ¡å™¨æ­£åœ¨æ‰§è¡Œä¸€ä¸ªå¤šè¡¨deleteè¯­å¥çš„äºŒéƒ¨åˆ†</p></li><li><p>discard_or_import_tablespace<br>çº¿ç¨‹æ­£åœ¨æ‰§è¡ŒALTER TABLE â€¦ DISCARD TABLESPACE æˆ–è€…ALTER TABLE â€¦ IMPORT TABLESPACE è¯­å¥.</p></li><li><p>end<br>è¿™ä¸ªçŠ¶æ€å‡ºç°åœ¨ALTER TABLE, CREATE VIEW, DELETE, INSERT, SELECT, UPDATEè¯­å¥ç»“æŸä¹‹åï¼Œä½†åœ¨æ¸…ç†ä»¥å‰ã€‚</p></li><li><p>executing<br>çº¿ç¨‹å¼€å§‹æ‰§è¡Œä¸€ä¸ªè¯­å¥</p></li><li><p>Execution of init_command<br>çº¿ç¨‹åœ¨init_commandç³»ç»Ÿå˜é‡ä¸­æ‰§è¡Œè¯­å¥</p></li><li><p>freeing items<br>çº¿ç¨‹å·²ç»æ‰§è¡Œå‘½ä»¤ã€‚ä¸€äº›é‡Šæ”¾</p></li><li><p>Flushing tables<br>è¿™ä¸ªçº¿ç¨‹æ‰§è¡Œäº†FLUSH TABLESï¼Œè€Œä¸”ç­‰å¾…æ‰€æœ‰çš„çº¿ç¨‹å…³é—­è¡¨</p></li><li><p>FULLTEXT initialization<br>æœåŠ¡å™¨å‡†å¤‡æ‰§è¡Œæ–‡æœ¬æœç´¢</p></li><li><p>Killed<br>å‘é€äº†kill è¯­å¥ç»™è¿™ä¸ªæŸ¥è¯¢ã€‚è¿™ä¸ªè¯­å¥åœ¨ä¸‹æ¬¡æ£€æŸ¥killæ ‡å¿—çš„æ—¶å€™ï¼Œè¿™ä¸ªè¯­å¥å°±åº”è¯¥æ”¾å¼ƒæ‰</p></li><li><p>Locked<br>æŸ¥è¯¢è¢«å…¶ä»–çš„æŸ¥è¯¢é”ä½äº†</p></li><li><p>logging slow query<br>çº¿ç¨‹æ­£åœ¨æŠŠæ…¢sqlå†™åˆ°æ…¢æŸ¥è¯¢logæ–‡ä»¶ä¸­</p></li><li><p>login<br>ç›´åˆ°çº¿ç¨‹æˆæƒæˆåŠŸä»¥å‰éƒ½æ˜¯è¿™ä¸ªçŠ¶æ€</p></li><li><p>manage keys<br>æœåŠ¡å™¨æ­£åœ¨ç®¡ç†è¡¨çš„ç´¢å¼•</p></li><li><p>Opening tables, Opening table<br>çº¿ç¨‹æ­£åœ¨æ‰“å¼€è¡¨ã€‚è¿™ä¸ªæ“ä½œæ˜¯å¾ˆå¿«çš„ï¼Œé™¤éæœ‰å…¶ä»–åŸå› é˜»æ­¢äº†æ‰“å¼€æ“ä½œï¼Œä¾‹å¦‚ALTER TABLE   LOCK TABLE</p></li><li><p>optimizing<br>æœåŠ¡å™¨æ­£åœ¨è¿›è¡Œä¸€ä¸ªæŸ¥è¯¢çš„åˆå§‹é˜¶æ®µä¼˜åŒ–</p></li><li><p>preparing<br>æ­£åœ¨è¿›è¡ŒæŸ¥è¯¢ä¼˜åŒ–</p></li><li><p>Purging old relay logs<br>çº¿ç¨‹åˆ é™¤ä¸éœ€è¦çš„relay logæ–‡ä»¶</p></li><li><p>query end<br>è¿™ä¸ªçŠ¶æ€å‡ºç°åœ¨å¤„ç†å®Œä»¥åä½†åœ¨å†»ç»“itemä¹‹å‰</p></li><li><p>Reading from net<br>æœåŠ¡å™¨ä»ç½‘ç»œè¯»å–åŒ…</p></li><li><p>Removing duplicates<br>æŸ¥è¯¢ä½¿ç”¨äº†select distinctã€‚mysqåœ¨å‘é€æ•°æ®åˆ°å®¢æˆ·ç«¯ä¹‹å‰éœ€è¦ä¸€ä¸ªé¢å¤–çš„è¿‡ç¨‹æ¥åˆ é™¤é‡å¤çš„è¡Œ</p></li><li><p>removing tmp table<br>åœ¨æ‰§è¡Œäº†selectè¯­å¥ä»¥åï¼Œçº¿ç¨‹æ­£åœ¨åˆ é™¤å†…éƒ¨çš„ä¸´æ—¶è¡¨</p></li><li><p>rename<br>çº¿ç¨‹æ­£åœ¨é‡å‘½åè¡¨</p></li><li><p>rename result table<br>çº¿ç¨‹æ­£åœ¨æ‰§è¡Œä¸€ä¸ªalter tableè¯­å¥ï¼Œè€Œä¸”å·²ç»åˆ›å»ºäº†æ–°è¡¨ï¼Œå¯¹æ–°è¡¨é‡å‘½åæ¥æ›¿æ¢åŸå§‹è¡¨ã€‚</p></li><li><p>Reopen tables<br>çº¿ç¨‹è·å–äº†ä¸€ä¸ªè¡¨çš„é”ã€‚ç”±äºå®ƒå·²ç»å¾—çŸ¥å®ƒä¾èµ–çš„è¡¨ç»“æ„å·²ç»å‘ç”Ÿäº†å˜åŒ–ã€‚çº¿ç¨‹éœ€è¦é‡Šæ”¾é”ã€å…³é—­è¡¨ã€ç„¶åå°è¯•é‡æ–°æ‰“å¼€ä»–ã€‚</p></li><li><p>Repair by sorting<br>ä¿®å¤ä»£ç é€šè¿‡æ’åºæ¥åˆ›å»ºç´¢å¼•ã€‚</p></li><li><p>Repair done<br>çº¿ç¨‹å®Œæˆäº†å¯¹ä¸€ä¸ªmyisamè¡¨çš„å¤šçº¿ç¨‹ä¿®å¤ã€‚</p></li><li><p>Repair with keycache<br>ä¿®å¤ä»£ç æ­£åœ¨é€šè¿‡keyçš„ç¼“å­˜åˆ›å»ºkeyã€‚</p></li><li><p>Rolling back<br>çº¿ç¨‹æ­£åœ¨å›æ»šäº‹ç‰©ã€‚</p></li><li><p>Saving state<br>myisamçš„analysiså’Œrepairæ“ä½œä¸­ï¼Œçº¿ç¨‹ä¼šæŠŠè¡¨çš„ä¸€äº›ä¿¡æ¯ä¾‹å¦‚è¡¨çš„è¡Œæ•°ã€AUTO_INCREMENTçš„è®¡æ•°å™¨ä»¥åŠkeyçš„åˆ†å¸ƒéƒ½ä¿å­˜åˆ°.MYIæ–‡ä»¶çš„å¤´éƒ¨</p></li><li><p>Searching rows for update<br>è¯­å¥æ‰§è¡Œçš„ç¬¬ä¸€ä¸ªé˜¶æ®µï¼Œæ‰¾åˆ°æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„è¡Œè®°å½•</p></li><li><p>Sending data<br>çº¿ç¨‹åœ¨è¯»å–å’Œå¤„ç†SELECTè¯­å¥ï¼Œå‘é€æ•°æ®åˆ°å®¢æˆ·ç«¯ã€‚ç”±äºè¯­å¥éœ€è¦å¤§é‡çš„ç£ç›˜è®¿é—®ï¼Œè¿™ä¸ªçŠ¶æ€ä¼šåœ¨è¯­å¥çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­å æ®æœ€é•¿çš„ä¸€ä¸ªçŠ¶æ€ã€‚</p></li><li><p>setup<br>çº¿ç¨‹å¼€å§‹è¿›è¡ŒALTER TABLE è¯­å¥</p></li><li><p>Sorting for group<br>çº¿ç¨‹æ­£åœ¨ä¸ºgroup by æ‰§è¡Œæ’åº</p></li><li><p>Sorting for order<br>çº¿ç¨‹æ­£åœ¨ä¸ºorder by æ‰§è¡Œæ’åº</p></li><li><p>Sorting index<br>åœ¨myisamè¡¨çš„ä¼˜åŒ–æ“ä½œä¸­ï¼Œè¿›è¡Œç´¢å¼•é¡µçš„æ’åºä»¥ä¾¿è·å¾—æ›´å¥½çš„è®¿é—®æ€§èƒ½ã€‚</p></li><li><p>Sorting result<br>å¯¹ç»“æœè¿›è¡Œæ’åº</p></li><li><p>Statistics<br>æœåŠ¡å™¨æ­£åœ¨è®¡ç®—ç»Ÿè®¡æ•°æ®ä»è€Œæ¥ç”Ÿæˆä¸€ä¸ªæ‰§è¡Œè®¡åˆ’ã€‚å¦‚æœä¸€ä¸ªçº¿ç¨‹ä¿ç•™è¿™ä¸ªçŠ¶æ€å¾ˆé•¿çš„æ—¶é—´ï¼Œæ„å‘³ç€æœåŠ¡å™¨åœ¨æ‰§è¡Œå…¶ä»–çš„ç£ç›˜ç›¸å…³çš„å·¥ä½œã€‚</p></li><li><p>System lock<br>çº¿ç¨‹æ­£åœ¨è¯·æ±‚å’Œè·å–ä¸€ä¸ªå†…éƒ¨å’Œå¤–éƒ¨é”ã€‚å¦‚æœæœ‰è¿™ä¸ªçŠ¶æ€</p></li><li><p>Table lock<br>System Lockåçš„å¦ä¸€ä¸ªçº¿ç¨‹çŠ¶æ€ã€‚çº¿ç¨‹å·²ç»è·å–äº†ä¸€ä¸ªå¤–éƒ¨é”ï¼Œç„¶åæ¥ä¸‹æ¥è¦å»è·å–ä¸€ä¸ªå†…éƒ¨è¡¨é”ã€‚</p></li><li><p>update<br>çº¿ç¨‹å·²ç»å‡†å¤‡å¥½å»æ›´æ–°</p></li><li><p>Updating<br>ç°åœ¨æ­£åœ¨æ‰¾æˆ–è€…æ­£åœ¨æ›´æ–°è¡Œ</p></li><li><p>updating main table<br>æœåŠ¡å™¨æ­£åœ¨æ‰§è¡Œä¸€ä¸ªå¤šè¡¨updateè¯­å¥ï¼Œæ­£åœ¨æ›´æ–°ç¬¬ä¸€å¼ è¡¨ï¼Œä¿å­˜è¡Œå’Œåç§»é‡ä»¥ç”¨æ¥æ›´æ–°å…¶ä»–è¡¨ã€‚</p></li><li><p>updating reference tables<br>æœåŠ¡å™¨æ­£åœ¨æ‰§è¡Œä¸€ä¸ªå¤šè¡¨updateè¯­å¥çš„ç¬¬äºŒéƒ¨åˆ†ï¼Œæ­£åœ¨ä»å…¶ä»–è¡¨æ›´æ–°è¡Œ</p></li><li><p>User lock<br>è¯·æ±‚æˆ–è€…ç­‰å¾…è·å–ä¸€ä¸ªé”</p></li><li><p>User sleep<br>çº¿ç¨‹sleep</p></li><li><p>Waiting for release of readlock<br>ç­‰å¾…ä¸€ä¸ªå…¨å±€çš„è¯»é”</p></li><li><p>Waiting for tables, Waiting for table<br>çº¿ç¨‹è·å¾—æç¤ºä¾èµ–çš„è¡¨ç»“æ„å‘ç”Ÿäº†æ”¹å˜ï¼Œçº¿ç¨‹éœ€è¦é‡æ–°æ‰“å¼€è¡¨æ¥è·å–æ–°çš„ç»“æ„ã€‚ä½†æ˜¯ï¼Œé‡æ–°æ‰“å¼€è¡¨æ˜¯éœ€è¦ç­‰å¾…å…¶ä»–çš„çº¿ç¨‹å…³é—­è¡¨ã€‚</p></li><li><p>Waiting on cond<br>çº¿ç¨‹æ­£åœ¨ç­‰æ¡ä»¶å˜æˆtrue</p></li><li><p>Waiting to get readlock<br>çº¿ç¨‹ç”¨FLUSH TABLES WITH READ LOCKè¯­å¥ï¼Œæ‰€ä»¥è¦è·å¾—ä¸€ä¸ªå…¨å±€çš„è¯»é”ï¼Œè¿™ä¸ªçŠ¶æ€è¡¨ç¤ºæ­£åœ¨ç­‰è¿™ä¸ªé”ã€‚</p></li><li><p>Writing to net<br>æœåŠ¡å™¨æŠŠåŒ…å†™åˆ°ç½‘ç»œ</p></li></ul><h2 id="æŸ¥çœ‹mysqlçŠ¶æ€"><a href="#æŸ¥çœ‹mysqlçŠ¶æ€" class="headerlink" title="æŸ¥çœ‹mysqlçŠ¶æ€"></a>æŸ¥çœ‹mysqlçŠ¶æ€</h2><h3 id="show-status-ä¸-show-global-status-åŒºåˆ«"><a href="#show-status-ä¸-show-global-status-åŒºåˆ«" class="headerlink" title="show status ä¸ show global status åŒºåˆ«"></a>show status ä¸ show global status åŒºåˆ«</h3><p>statusï¼šå½“å‰è¿æ¥çš„çŠ¶æ€ï¼ˆå½“å‰ä¼šè¯/è¿æ¥ï¼‰<br>global statusï¼šmysql å¯åŠ¨ååˆ°ç›®å‰çš„çŠ¶æ€ï¼ˆå…¨å±€ä¼šè¯ï¼‰</p><h3 id="show-status-è¯¦è§£"><a href="#show-status-è¯¦è§£" class="headerlink" title="show status è¯¦è§£"></a>show status è¯¦è§£</h3><p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="http://dev.mysql.com/doc/refman/5.7/en/server-status-variables.html" rel="external nofollow noopener noreferrer" target="_blank">http://dev.mysql.com/doc/refman/5.7/en/server-status-variables.html</a></p><table><thead><tr><th>çŠ¶æ€å</th><th>ä½œç”¨åŸŸ</th><th>è¯¦ç»†è§£é‡Š</th></tr></thead><tbody><tr><td>Aborted_clients</td><td>Global</td><td>ç”±äºå®¢æˆ·ç«¯æ²¡æœ‰æ­£ç¡®å…³é—­è¿æ¥å¯¼è‡´å®¢æˆ·ç«¯ç»ˆæ­¢è€Œä¸­æ–­çš„è¿æ¥æ•°</td></tr><tr><td>Aborted_connects</td><td>Global</td><td>è¯•å›¾è¿æ¥åˆ°MySQLæœåŠ¡å™¨è€Œå¤±è´¥çš„è¿æ¥æ•°</td></tr><tr><td>Binlog_cache_disk_use</td><td>Global</td><td>ä½¿ç”¨ä¸´æ—¶äºŒè¿›åˆ¶æ—¥å¿—ç¼“å­˜ä½†è¶…è¿‡binlog_cache_sizeå€¼å¹¶ä½¿ç”¨ä¸´æ—¶æ–‡ä»¶æ¥ä¿å­˜äº‹åŠ¡ä¸­çš„è¯­å¥çš„äº‹åŠ¡æ•°é‡</td></tr><tr><td>Binlog_cache_use</td><td>Global</td><td>ä½¿ç”¨ä¸´æ—¶äºŒè¿›åˆ¶æ—¥å¿—ç¼“å­˜çš„äº‹åŠ¡æ•°é‡</td></tr><tr><td>Bytes_received</td><td>Both</td><td>ä»æ‰€æœ‰å®¢æˆ·ç«¯æ¥æ”¶åˆ°çš„å­—èŠ‚æ•°ã€‚</td></tr><tr><td>Bytes_sent</td><td>Both</td><td>å‘é€ç»™æ‰€æœ‰å®¢æˆ·ç«¯çš„å­—èŠ‚æ•°ã€‚</td></tr><tr><td>com*</td><td></td><td>å„ç§æ•°æ®åº“æ“ä½œçš„æ•°é‡</td></tr><tr><td>Compression</td><td>Session</td><td>å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´åªå¦å¯ç”¨å‹ç¼©åè®®</td></tr><tr><td>Connections</td><td>Global</td><td>è¯•å›¾è¿æ¥åˆ°(ä¸ç®¡æ˜¯å¦æˆåŠŸ)MySQLæœåŠ¡å™¨çš„è¿æ¥æ•°</td></tr><tr><td>Created_tmp_disk_tables</td><td>Both</td><td>æœåŠ¡å™¨æ‰§è¡Œè¯­å¥æ—¶åœ¨ç¡¬ç›˜ä¸Šè‡ªåŠ¨åˆ›å»ºçš„ä¸´æ—¶è¡¨çš„æ•°é‡</td></tr><tr><td>Created_tmp_files</td><td>Global</td><td>mysqldå·²ç»åˆ›å»ºçš„ä¸´æ—¶æ–‡ä»¶çš„æ•°é‡</td></tr><tr><td>Created_tmp_tables</td><td>Both</td><td>æœåŠ¡å™¨æ‰§è¡Œè¯­å¥æ—¶è‡ªåŠ¨åˆ›å»ºçš„å†…å­˜ä¸­çš„ä¸´æ—¶è¡¨çš„æ•°é‡ã€‚å¦‚æœCreated_tmp_disk_tablesè¾ƒå¤§ï¼Œä½ å¯èƒ½è¦å¢åŠ tmp_table_sizeå€¼ä½¿ä¸´æ—¶è¡¨åŸºäºå†…å­˜è€Œä¸åŸºäºç¡¬ç›˜</td></tr><tr><td>Delayed_errors</td><td>Global</td><td>ç”¨INSERT DELAYEDå†™çš„å‡ºç°é”™è¯¯çš„è¡Œæ•°(å¯èƒ½ä¸ºduplicate key)ã€‚</td></tr><tr><td>Delayed_insert_threads</td><td>Global</td><td>ä½¿ç”¨çš„INSERT DELAYEDå¤„ç†å™¨çº¿ç¨‹æ•°ã€‚</td></tr><tr><td>Delayed_writes</td><td>Global</td><td>å†™å…¥çš„INSERT DELAYEDè¡Œæ•°</td></tr><tr><td>Flush_commands</td><td>Global</td><td>æ‰§è¡Œçš„FLUSHè¯­å¥æ•°ã€‚</td></tr><tr><td>Handler_commit</td><td>Both</td><td>å†…éƒ¨æäº¤è¯­å¥æ•°</td></tr><tr><td>Handler_delete</td><td>Both</td><td>è¡Œä»è¡¨ä¸­åˆ é™¤çš„æ¬¡æ•°ã€‚</td></tr><tr><td>Handler_discover</td><td>Both</td><td>MySQLæœåŠ¡å™¨å¯ä»¥é—®NDB CLUSTERå­˜å‚¨å¼•æ“æ˜¯å¦çŸ¥é“æŸä¸€åå­—çš„è¡¨ã€‚è¿™è¢«ç§°ä½œå‘ç°ã€‚Handler_discoverè¯´æ˜é€šè¿‡è¯¥æ–¹æ³•å‘ç°çš„æ¬¡æ•°ã€‚</td></tr><tr><td>Handler_prepare</td><td>Both</td><td>A counter for the prepare phase of two-phase commit operations.</td></tr><tr><td>Handler_read_first</td><td>Both</td><td>ç´¢å¼•ä¸­ç¬¬ä¸€æ¡è¢«è¯»çš„æ¬¡æ•°ã€‚å¦‚æœè¾ƒé«˜ï¼Œå®ƒå»ºè®®æœåŠ¡å™¨æ­£æ‰§è¡Œå¤§é‡å…¨ç´¢å¼•æ‰«æï¼›ä¾‹å¦‚ï¼ŒSELECT col1 FROM fooï¼Œå‡å®šcol1æœ‰ç´¢å¼•ã€‚</td></tr><tr><td>Handler_read_key</td><td>Both</td><td>æ ¹æ®é”®è¯»ä¸€è¡Œçš„è¯·æ±‚æ•°ã€‚å¦‚æœè¾ƒé«˜ï¼Œè¯´æ˜æŸ¥è¯¢å’Œè¡¨çš„ç´¢å¼•æ­£ç¡®ã€‚</td></tr><tr><td>Handler_read_next</td><td>Both</td><td>æŒ‰ç…§é”®é¡ºåºè¯»ä¸‹ä¸€è¡Œçš„è¯·æ±‚æ•°ã€‚å¦‚æœä½ ç”¨èŒƒå›´çº¦æŸæˆ–å¦‚æœæ‰§è¡Œç´¢å¼•æ‰«ææ¥æŸ¥è¯¢ç´¢å¼•åˆ—ï¼Œè¯¥å€¼å¢åŠ ã€‚</td></tr><tr><td>Handler_read_prev</td><td>Both</td><td>æŒ‰ç…§é”®é¡ºåºè¯»å‰ä¸€è¡Œçš„è¯·æ±‚æ•°ã€‚è¯¥è¯»æ–¹æ³•ä¸»è¦ç”¨äºä¼˜åŒ–ORDER BY â€¦ DESCã€‚</td></tr><tr><td>Handler_read_rnd</td><td>Both</td><td>æ ¹æ®å›ºå®šä½ç½®è¯»ä¸€è¡Œçš„è¯·æ±‚æ•°ã€‚å¦‚æœä½ æ­£æ‰§è¡Œå¤§é‡æŸ¥è¯¢å¹¶éœ€è¦å¯¹ç»“æœè¿›è¡Œæ’åºè¯¥å€¼è¾ƒé«˜ã€‚ä½ å¯èƒ½ä½¿ç”¨äº†å¤§é‡éœ€è¦MySQLæ‰«ææ•´ä¸ªè¡¨çš„æŸ¥è¯¢æˆ–ä½ çš„è¿æ¥æ²¡æœ‰æ­£ç¡®ä½¿ç”¨é”®ã€‚</td></tr><tr><td>Handler_read_rnd_next</td><td>Both</td><td>åœ¨æ•°æ®æ–‡ä»¶ä¸­è¯»ä¸‹ä¸€è¡Œçš„è¯·æ±‚æ•°ã€‚å¦‚æœä½ æ­£è¿›è¡Œå¤§é‡çš„è¡¨æ‰«æï¼Œè¯¥å€¼è¾ƒé«˜ã€‚é€šå¸¸è¯´æ˜ä½ çš„è¡¨ç´¢å¼•ä¸æ­£ç¡®æˆ–å†™å…¥çš„æŸ¥è¯¢æ²¡æœ‰åˆ©ç”¨ç´¢å¼•ã€‚</td></tr><tr><td>Handler_rollback</td><td>Both</td><td>å†…éƒ¨ROLLBACKè¯­å¥çš„æ•°é‡ã€‚</td></tr><tr><td>Handler_savepoint</td><td>Both</td><td>åœ¨ä¸€ä¸ªå­˜å‚¨å¼•æ“æ”¾ç½®ä¸€ä¸ªä¿å­˜ç‚¹çš„è¯·æ±‚æ•°é‡ã€‚</td></tr><tr><td>Handler_savepoint_rollback</td><td>Both</td><td>åœ¨ä¸€ä¸ªå­˜å‚¨å¼•æ“çš„è¦æ±‚å›æ»šåˆ°ä¸€ä¸ªä¿å­˜ç‚¹æ•°ç›®ã€‚</td></tr><tr><td>Handler_update</td><td>Both</td><td>åœ¨è¡¨å†…æ›´æ–°ä¸€è¡Œçš„è¯·æ±‚æ•°ã€‚</td></tr><tr><td>Handler_write</td><td>Both</td><td>åœ¨è¡¨å†…æ’å…¥ä¸€è¡Œçš„è¯·æ±‚æ•°ã€‚</td></tr><tr><td>Innodb_buffer_pool_pages_data</td><td>Global</td><td>åŒ…å«æ•°æ®çš„é¡µæ•°(è„æˆ–å¹²å‡€)ã€‚</td></tr><tr><td>Innodb_buffer_pool_pages_dirty</td><td>Global</td><td>å½“å‰çš„è„é¡µæ•°ã€‚</td></tr><tr><td>Innodb_buffer_pool_pages_flushed</td><td>Global</td><td>è¦æ±‚æ¸…ç©ºçš„ç¼“å†²æ± é¡µæ•°</td></tr><tr><td>Innodb_buffer_pool_pages_free</td><td>Global</td><td>ç©ºé¡µæ•°ã€‚</td></tr><tr><td>Innodb_buffer_pool_pages_latched</td><td>Global</td><td>åœ¨InnoDBç¼“å†²æ± ä¸­é”å®šçš„é¡µæ•°ã€‚è¿™æ˜¯å½“å‰æ­£è¯»æˆ–å†™æˆ–ç”±äºå…¶å®ƒåŸå› ä¸èƒ½æ¸…ç©ºæˆ–åˆ é™¤çš„é¡µæ•°ã€‚</td></tr><tr><td>Innodb_buffer_pool_pages_misc</td><td>Global</td><td>å¿™çš„é¡µæ•°ï¼Œå› ä¸ºå®ƒä»¬å·²ç»è¢«åˆ†é…ä¼˜å…ˆç”¨ä½œç®¡ç†ï¼Œä¾‹å¦‚è¡Œé”å®šæˆ–é€‚ç”¨çš„å“ˆå¸Œç´¢å¼•ã€‚è¯¥å€¼è¿˜å¯ä»¥è®¡ç®—ä¸ºInnodb_buffer_pool_pages_total - Innodb_buffer_pool_pages_free - Innodb_buffer_pool_pages_dataã€‚</td></tr><tr><td>Innodb_buffer_pool_pages_total</td><td>Global</td><td>ç¼“å†²æ± æ€»å¤§å°ï¼ˆé¡µæ•°ï¼‰ã€‚</td></tr><tr><td>Innodb_buffer_pool_read_ahead_rnd</td><td>Global</td><td>InnoDBåˆå§‹åŒ–çš„â€œéšæœºâ€read-aheadsæ•°ã€‚å½“æŸ¥è¯¢ä»¥éšæœºé¡ºåºæ‰«æè¡¨çš„ä¸€å¤§éƒ¨åˆ†æ—¶å‘ç”Ÿã€‚</td></tr><tr><td>Innodb_buffer_pool_read_ahead_seq</td><td>Global</td><td>InnoDBåˆå§‹åŒ–çš„é¡ºåºread-aheadsæ•°ã€‚å½“InnoDBæ‰§è¡Œé¡ºåºå…¨è¡¨æ‰«ææ—¶å‘ç”Ÿã€‚</td></tr><tr><td>Innodb_buffer_pool_read_requests</td><td>Global</td><td>InnoDBå·²ç»å®Œæˆçš„é€»è¾‘è¯»è¯·æ±‚æ•°ã€‚</td></tr><tr><td>Innodb_buffer_pool_reads</td><td>Global</td><td>ä¸èƒ½æ»¡è¶³InnoDBå¿…é¡»å•é¡µè¯»å–çš„ç¼“å†²æ± ä¸­çš„é€»è¾‘è¯»æ•°é‡ã€‚</td></tr><tr><td>Innodb_buffer_pool_wait_free</td><td>Global</td><td>ä¸€èˆ¬æƒ…å†µï¼Œé€šè¿‡åå°å‘InnoDBç¼“å†²æ± å†™ã€‚ä½†æ˜¯ï¼Œå¦‚æœéœ€è¦è¯»æˆ–åˆ›å»ºé¡µï¼Œå¹¶ä¸”æ²¡æœ‰å¹²å‡€çš„é¡µå¯ç”¨ï¼Œåˆ™å®ƒè¿˜éœ€è¦å…ˆç­‰å¾…é¡µé¢æ¸…ç©ºã€‚è¯¥è®¡æ•°å™¨å¯¹ç­‰å¾…å®ä¾‹è¿›è¡Œè®°æ•°ã€‚å¦‚æœå·²ç»é€‚å½“è®¾ç½®ç¼“å†²æ± å¤§å°ï¼Œè¯¥å€¼åº”å°ã€‚</td></tr><tr><td>Innodb_buffer_pool_write_requests</td><td>Global</td><td>å‘InnoDBç¼“å†²æ± çš„å†™æ•°é‡ã€‚</td></tr><tr><td>Innodb_data_fsyncs</td><td>Global</td><td>fsync()æ“ä½œæ•°ã€‚</td></tr><tr><td>Innodb_data_pending_fsyncs</td><td>Global</td><td>å½“å‰æŒ‚èµ·çš„fsync()æ“ä½œæ•°ã€‚</td></tr><tr><td>Innodb_data_pending_reads</td><td>Global</td><td>å½“å‰æŒ‚èµ·çš„è¯»æ•°ã€‚</td></tr><tr><td>Innodb_data_pending_writes</td><td>Global</td><td>å½“å‰æŒ‚èµ·çš„å†™æ•°ã€‚</td></tr><tr><td>Innodb_data_read</td><td>Global</td><td>è‡³æ­¤å·²ç»è¯»å–çš„æ•°æ®æ•°é‡ï¼ˆå­—èŠ‚ï¼‰ã€‚</td></tr><tr><td>Innodb_data_reads</td><td>Global</td><td>æ•°æ®è¯»æ€»æ•°é‡ã€‚</td></tr><tr><td>Innodb_data_writes</td><td>Global</td><td>æ•°æ®å†™æ€»æ•°é‡ã€‚</td></tr><tr><td>Innodb_data_written</td><td>Global</td><td>è‡³æ­¤å·²ç»å†™å…¥çš„æ•°æ®é‡ï¼ˆå­—èŠ‚ï¼‰ã€‚</td></tr><tr><td>Innodb_dblwr_pages_written</td><td>Global</td><td>å·²ç»æ‰§è¡Œçš„åŒå†™æ“ä½œæ•°é‡</td></tr><tr><td>Innodb_dblwr_writes</td><td>Global</td><td>åŒå†™æ“ä½œå·²ç»å†™å¥½çš„é¡µæ•°</td></tr><tr><td>Innodb_log_waits</td><td>Global</td><td>æˆ‘ä»¬å¿…é¡»ç­‰å¾…çš„æ—¶é—´ï¼Œå› ä¸ºæ—¥å¿—ç¼“å†²åŒºå¤ªå°ï¼Œæˆ‘ä»¬åœ¨ç»§ç»­å‰å¿…é¡»å…ˆç­‰å¾…å¯¹å®ƒæ¸…ç©º</td></tr><tr><td></td><td></td><td></td></tr><tr><td>Innodb_log_write_requests</td><td>Global</td><td>æ—¥å¿—å†™è¯·æ±‚æ•°ã€‚</td></tr><tr><td>Innodb_log_writes</td><td>Global</td><td>å‘æ—¥å¿—æ–‡ä»¶çš„ç‰©ç†å†™æ•°é‡ã€‚</td></tr><tr><td>Innodb_os_log_fsyncs</td><td>Global</td><td>å‘æ—¥å¿—æ–‡ä»¶å®Œæˆçš„fsync()å†™æ•°é‡ã€‚</td></tr><tr><td>Innodb_os_log_pending_fsyncs</td><td>Global</td><td>æŒ‚èµ·çš„æ—¥å¿—æ–‡ä»¶fsync()æ“ä½œæ•°é‡ã€‚</td></tr><tr><td>Innodb_os_log_pending_writes</td><td>Global</td><td>æŒ‚èµ·çš„æ—¥å¿—æ–‡ä»¶å†™æ“ä½œ</td></tr><tr><td>Innodb_os_log_written</td><td>Global</td><td>å†™å…¥æ—¥å¿—æ–‡ä»¶çš„å­—èŠ‚æ•°ã€‚</td></tr><tr><td>Innodb_page_size</td><td>Global</td><td>ç¼–è¯‘çš„InnoDBé¡µå¤§å°(é»˜è®¤16KB)ã€‚è®¸å¤šå€¼ç”¨é¡µæ¥è®°æ•°ï¼›é¡µçš„å¤§å°å¾ˆå®¹æ˜“è½¬æ¢ä¸ºå­—èŠ‚ã€‚</td></tr><tr><td>Innodb_pages_created</td><td>Global</td><td>åˆ›å»ºçš„é¡µæ•°ã€‚</td></tr><tr><td>Innodb_pages_read</td><td>Global</td><td>è¯»å–çš„é¡µæ•°ã€‚</td></tr><tr><td>Innodb_pages_written</td><td>Global</td><td>å†™å…¥çš„é¡µæ•°ã€‚</td></tr><tr><td>Innodb_row_lock_current_waits</td><td>Global</td><td>å½“å‰ç­‰å¾…çš„å¾…é”å®šçš„è¡Œæ•°ã€‚</td></tr><tr><td>Innodb_row_lock_time</td><td>Global</td><td>è¡Œé”å®šèŠ±è´¹çš„æ€»æ—¶é—´ï¼Œå•ä½æ¯«ç§’ã€‚</td></tr><tr><td>Innodb_row_lock_time_avg</td><td>Global</td><td>è¡Œé”å®šçš„å¹³å‡æ—¶é—´ï¼Œå•ä½æ¯«ç§’ã€‚</td></tr><tr><td>Innodb_row_lock_time_max</td><td>Global</td><td>è¡Œé”å®šçš„æœ€é•¿æ—¶é—´ï¼Œå•ä½æ¯«ç§’ã€‚</td></tr><tr><td>Innodb_row_lock_waits</td><td>Global</td><td>ä¸€è¡Œé”å®šå¿…é¡»ç­‰å¾…çš„æ—¶é—´æ•°ã€‚</td></tr><tr><td>Innodb_rows_deleted</td><td>Global</td><td>ä»InnoDBè¡¨åˆ é™¤çš„è¡Œæ•°ã€‚</td></tr><tr><td>Innodb_rows_inserted</td><td>Global</td><td>æ’å…¥åˆ°InnoDBè¡¨çš„è¡Œæ•°ã€‚</td></tr><tr><td>Innodb_rows_read</td><td>Global</td><td>ä»InnoDBè¡¨è¯»å–çš„è¡Œæ•°ã€‚</td></tr><tr><td>Innodb_rows_updated</td><td>Global</td><td>InnoDBè¡¨å†…æ›´æ–°çš„è¡Œæ•°ã€‚</td></tr><tr><td>Key_blocks_not_flushed</td><td>Global</td><td>é”®ç¼“å­˜å†…å·²ç»æ›´æ”¹ä½†è¿˜æ²¡æœ‰æ¸…ç©ºåˆ°ç¡¬ç›˜ä¸Šçš„é”®çš„æ•°æ®å—æ•°é‡ã€‚</td></tr><tr><td>Key_blocks_unused</td><td>Global</td><td>é”®ç¼“å­˜å†…æœªä½¿ç”¨çš„å—æ•°é‡ã€‚ä½ å¯ä»¥ä½¿ç”¨è¯¥å€¼æ¥ç¡®å®šä½¿ç”¨äº†å¤šå°‘é”®ç¼“å­˜</td></tr><tr><td>Key_blocks_used</td><td>Global</td><td>é”®ç¼“å­˜å†…ä½¿ç”¨çš„å—æ•°é‡ã€‚è¯¥å€¼ä¸ºé«˜æ°´å¹³çº¿æ ‡è®°ï¼Œè¯´æ˜å·²ç»åŒæ—¶æœ€å¤šä½¿ç”¨äº†å¤šå°‘å—ã€‚</td></tr><tr><td>Key_read_requests</td><td>Global</td><td>ä»ç¼“å­˜è¯»é”®çš„æ•°æ®å—çš„è¯·æ±‚æ•°ã€‚</td></tr><tr><td>Key_reads</td><td>Global</td><td>ä»ç¡¬ç›˜è¯»å–é”®çš„æ•°æ®å—çš„æ¬¡æ•°ã€‚å¦‚æœKey_readsè¾ƒå¤§ï¼Œåˆ™Key_buffer_sizeå€¼å¯èƒ½å¤ªå°ã€‚å¯ä»¥ç”¨Key_reads/Key_read_requestsè®¡ç®—ç¼“å­˜æŸå¤±ç‡ã€‚</td></tr><tr><td>Key_write_requests</td><td>Global</td><td>å°†é”®çš„æ•°æ®å—å†™å…¥ç¼“å­˜çš„è¯·æ±‚æ•°ã€‚</td></tr><tr><td>Key_writes</td><td>Global</td><td>å‘ç¡¬ç›˜å†™å…¥å°†é”®çš„æ•°æ®å—çš„ç‰©ç†å†™æ“ä½œçš„æ¬¡æ•°ã€‚</td></tr><tr><td>Last_query_cost</td><td>Session</td><td>ç”¨æŸ¥è¯¢ä¼˜åŒ–å™¨è®¡ç®—çš„æœ€åç¼–è¯‘çš„æŸ¥è¯¢çš„æ€»æˆæœ¬ã€‚ç”¨äºå¯¹æ¯”åŒä¸€æŸ¥è¯¢çš„ä¸åŒæŸ¥è¯¢æ–¹æ¡ˆçš„æˆæœ¬ã€‚é»˜è®¤å€¼0è¡¨ç¤ºè¿˜æ²¡æœ‰ç¼–è¯‘æŸ¥è¯¢ã€‚é»˜è®¤å€¼æ˜¯0ã€‚Last_query_costå…·æœ‰ä¼šè¯èŒƒå›´ã€‚</td></tr><tr><td>Max_used_connections</td><td>Global</td><td>æœåŠ¡å™¨å¯åŠ¨åå·²ç»åŒæ—¶ä½¿ç”¨çš„è¿æ¥çš„æœ€å¤§æ•°é‡ã€‚</td></tr><tr><td>ndb*</td><td></td><td>ndbé›†ç¾¤ç›¸å…³</td></tr><tr><td>Not_flushed_delayed_rows</td><td>Global</td><td>ç­‰å¾…å†™å…¥INSERT DELAYé˜Ÿåˆ—çš„è¡Œæ•°ã€‚</td></tr><tr><td>Open_files</td><td>Global</td><td>æ‰“å¼€çš„æ–‡ä»¶çš„æ•°ç›®ã€‚</td></tr><tr><td>Open_streams</td><td>Global</td><td>æ‰“å¼€çš„æµçš„æ•°é‡(ä¸»è¦ç”¨äºè®°å½•)ã€‚</td></tr><tr><td>Open_table_definitions</td><td>Global</td><td>ç¼“å­˜çš„.frmæ–‡ä»¶æ•°é‡</td></tr><tr><td>Open_tables</td><td>Both</td><td>å½“å‰æ‰“å¼€çš„è¡¨çš„æ•°é‡ã€‚</td></tr><tr><td>Opened_files</td><td>Global</td><td>æ–‡ä»¶æ‰“å¼€çš„æ•°é‡ã€‚ä¸åŒ…æ‹¬è¯¸å¦‚å¥—æ¥å­—æˆ–ç®¡é“å…¶ä»–ç±»å‹çš„æ–‡ä»¶ã€‚ ä¹Ÿä¸åŒ…æ‹¬å­˜å‚¨å¼•æ“ç”¨æ¥åšè‡ªå·±çš„å†…éƒ¨åŠŸèƒ½çš„æ–‡ä»¶ã€‚</td></tr><tr><td>Opened_table_definitions</td><td>Both</td><td>å·²ç»ç¼“å­˜çš„.frmæ–‡ä»¶æ•°é‡</td></tr><tr><td>Opened_tables</td><td>Both</td><td>å·²ç»æ‰“å¼€çš„è¡¨çš„æ•°é‡ã€‚å¦‚æœOpened_tablesè¾ƒå¤§ï¼Œtable_cache å€¼å¯èƒ½å¤ªå°ã€‚</td></tr><tr><td>Prepared_stmt_count</td><td>Global</td><td>å½“å‰çš„é¢„å¤„ç†è¯­å¥çš„æ•°é‡ã€‚(æœ€å¤§æ•°ä¸ºç³»ç»Ÿå˜é‡: max_prepared_stmt_count)</td></tr><tr><td>Qcache_free_blocks</td><td>Global</td><td>æŸ¥è¯¢ç¼“å­˜å†…è‡ªç”±å†…å­˜å—çš„æ•°é‡ã€‚</td></tr><tr><td>Qcache_free_memory</td><td>Global</td><td>ç”¨äºæŸ¥è¯¢ç¼“å­˜çš„è‡ªç”±å†…å­˜çš„æ•°é‡ã€‚</td></tr><tr><td>Qcache_hits</td><td>Global</td><td>æŸ¥è¯¢ç¼“å­˜è¢«è®¿é—®çš„æ¬¡æ•°ã€‚</td></tr><tr><td>Qcache_inserts</td><td>Global</td><td>åŠ å…¥åˆ°ç¼“å­˜çš„æŸ¥è¯¢æ•°é‡ã€‚</td></tr><tr><td>Qcache_lowmem_prunes</td><td>Global</td><td>ç”±äºå†…å­˜è¾ƒå°‘ä»ç¼“å­˜åˆ é™¤çš„æŸ¥è¯¢æ•°é‡ã€‚</td></tr><tr><td>Qcache_not_cached</td><td>Global</td><td>éç¼“å­˜æŸ¥è¯¢æ•°(ä¸å¯ç¼“å­˜ï¼Œæˆ–ç”±äºquery_cache_typeè®¾å®šå€¼æœªç¼“å­˜)ã€‚</td></tr><tr><td>Qcache_queries_in_cache</td><td>Global</td><td>ç™»è®°åˆ°ç¼“å­˜å†…çš„æŸ¥è¯¢çš„æ•°é‡ã€‚</td></tr><tr><td>Qcache_total_blocks</td><td>Global</td><td>æŸ¥è¯¢ç¼“å­˜å†…çš„æ€»å—æ•°ã€‚</td></tr><tr><td>Queries</td><td>Both</td><td>æœåŠ¡å™¨æ‰§è¡Œçš„è¯·æ±‚ä¸ªæ•°ï¼ŒåŒ…å«å­˜å‚¨è¿‡ç¨‹ä¸­çš„è¯·æ±‚ã€‚</td></tr><tr><td>Questions</td><td>Both</td><td>å·²ç»å‘é€ç»™æœåŠ¡å™¨çš„æŸ¥è¯¢çš„ä¸ªæ•°ã€‚</td></tr><tr><td>Rpl_status</td><td>Global</td><td>å¤±è´¥å®‰å…¨å¤åˆ¶çŠ¶æ€(è¿˜æœªä½¿ç”¨)ã€‚</td></tr><tr><td>Select_full_join</td><td>Both</td><td>æ²¡æœ‰ä½¿ç”¨ç´¢å¼•çš„è”æ¥çš„æ•°é‡ã€‚å¦‚æœè¯¥å€¼ä¸ä¸º0,ä½ åº”ä»”ç»†æ£€æŸ¥è¡¨çš„ç´¢å¼•</td></tr><tr><td>Select_full_range_join</td><td>Both</td><td>åœ¨å¼•ç”¨çš„è¡¨ä¸­ä½¿ç”¨èŒƒå›´æœç´¢çš„è”æ¥çš„æ•°é‡ã€‚</td></tr><tr><td>Select_range</td><td>Both</td><td>åœ¨ç¬¬ä¸€ä¸ªè¡¨ä¸­ä½¿ç”¨èŒƒå›´çš„è”æ¥çš„æ•°é‡ã€‚ä¸€èˆ¬æƒ…å†µä¸æ˜¯å…³é”®é—®é¢˜ï¼Œå³ä½¿è¯¥å€¼ç›¸å½“å¤§ã€‚</td></tr><tr><td>Select_range_check</td><td>Both</td><td>åœ¨æ¯ä¸€è¡Œæ•°æ®åå¯¹é”®å€¼è¿›è¡Œæ£€æŸ¥çš„ä¸å¸¦é”®å€¼çš„è”æ¥çš„æ•°é‡ã€‚å¦‚æœä¸ä¸º0ï¼Œä½ åº”ä»”ç»†æ£€æŸ¥è¡¨çš„ç´¢å¼•ã€‚</td></tr><tr><td>Select_scan</td><td>Both</td><td>å¯¹ç¬¬ä¸€ä¸ªè¡¨è¿›è¡Œå®Œå…¨æ‰«æçš„è”æ¥çš„æ•°é‡ã€‚</td></tr><tr><td>Slave_heartbeat_period</td><td>Global</td><td>å¤åˆ¶çš„å¿ƒè·³é—´éš”</td></tr><tr><td>Slave_open_temp_tables</td><td>Global</td><td>ä»æœåŠ¡å™¨æ‰“å¼€çš„ä¸´æ—¶è¡¨æ•°é‡</td></tr><tr><td>Slave_received_heartbeats</td><td>Global</td><td>ä»æœåŠ¡å™¨å¿ƒè·³æ•°</td></tr><tr><td>Slave_retried_transactions</td><td>Global</td><td>æœ¬æ¬¡å¯åŠ¨ä»¥æ¥ä»æœåŠ¡å™¨å¤åˆ¶çº¿ç¨‹é‡è¯•æ¬¡æ•°</td></tr><tr><td>Slave_running</td><td>Global</td><td>å¦‚æœè¯¥æœåŠ¡å™¨æ˜¯è¿æ¥åˆ°ä¸»æœåŠ¡å™¨çš„ä»æœåŠ¡å™¨ï¼Œåˆ™è¯¥å€¼ä¸ºONã€‚</td></tr><tr><td>Slow_launch_threads</td><td>Both</td><td>åˆ›å»ºæ—¶é—´è¶…è¿‡slow_launch_timeç§’çš„çº¿ç¨‹æ•°ã€‚</td></tr><tr><td>Slow_queries</td><td>Both</td><td>æŸ¥è¯¢æ—¶é—´è¶…è¿‡long_query_timeç§’çš„æŸ¥è¯¢çš„ä¸ªæ•°ã€‚</td></tr><tr><td>Sort_merge_passes</td><td>Both</td><td>æ’åºç®—æ³•å·²ç»æ‰§è¡Œçš„åˆå¹¶çš„æ•°é‡ã€‚å¦‚æœè¿™ä¸ªå˜é‡å€¼è¾ƒå¤§ï¼Œåº”è€ƒè™‘å¢åŠ sort_buffer_sizeç³»ç»Ÿå˜é‡çš„å€¼ã€‚</td></tr><tr><td>Sort_range</td><td>Both</td><td>åœ¨èŒƒå›´å†…æ‰§è¡Œçš„æ’åºçš„æ•°é‡ã€‚</td></tr><tr><td>Sort_rows</td><td>Both</td><td>å·²ç»æ’åºçš„è¡Œæ•°ã€‚</td></tr><tr><td>Sort_scan</td><td>Both</td><td>é€šè¿‡æ‰«æè¡¨å®Œæˆçš„æ’åºçš„æ•°é‡ã€‚</td></tr><tr><td>sslï¼Š</td><td></td><td>sslè¿æ¥ç›¸å…³</td></tr><tr><td>Table_locks_immediate</td><td>Global</td><td>ç«‹å³è·å¾—çš„è¡¨çš„é”çš„æ¬¡æ•°ã€‚</td></tr><tr><td>Table_locks_waited</td><td>Global</td><td>ä¸èƒ½ç«‹å³è·å¾—çš„è¡¨çš„é”çš„æ¬¡æ•°ã€‚å¦‚æœè¯¥å€¼è¾ƒé«˜ï¼Œå¹¶ä¸”æœ‰æ€§èƒ½é—®é¢˜ï¼Œä½ åº”é¦–å…ˆä¼˜åŒ–æŸ¥è¯¢ï¼Œç„¶åæ‹†åˆ†è¡¨æˆ–ä½¿ç”¨å¤åˆ¶ã€‚</td></tr><tr><td>Threads_cached</td><td>Global</td><td>çº¿ç¨‹ç¼“å­˜å†…çš„çº¿ç¨‹çš„æ•°é‡ã€‚</td></tr><tr><td>Threads_connected</td><td>Global</td><td>å½“å‰æ‰“å¼€çš„è¿æ¥çš„æ•°é‡ã€‚</td></tr><tr><td>Threads_created</td><td>Global</td><td>åˆ›å»ºç”¨æ¥å¤„ç†è¿æ¥çš„çº¿ç¨‹æ•°ã€‚å¦‚æœThreads_createdè¾ƒå¤§ï¼Œä½ å¯èƒ½è¦å¢åŠ thread_cache_sizeå€¼ã€‚ç¼“å­˜è®¿é—®ç‡çš„è®¡ç®—æ–¹æ³•Threads_created/Connectionsã€‚</td></tr><tr><td>Threads_running</td><td>Global</td><td>æ¿€æ´»çš„ï¼ˆéç¡çœ çŠ¶æ€ï¼‰çº¿ç¨‹æ•°ã€‚</td></tr><tr><td>Uptime</td><td>Global</td><td>æœåŠ¡å™¨å·²ç»è¿è¡Œçš„æ—¶é—´ï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰ã€‚</td></tr><tr><td>Uptime_since_flush_status</td><td>Global</td><td>æœ€è¿‘ä¸€æ¬¡ä½¿ç”¨FLUSH STATUSçš„æ—¶é—´ï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰ã€‚</td></tr></tbody></table><!--ä»¥ä¸‹æ˜¯è„šæ³¨-->]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;ä¼˜åŒ–æ­¥éª¤&quot;&gt;&lt;a href=&quot;#ä¼˜åŒ–æ­¥éª¤&quot; class=&quot;head
      
    
    </summary>
    
      <category term="2-å¼€å‘æŠ€èƒ½" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/"/>
    
      <category term="æ•°æ®åº“" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="Mysql" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql/"/>
    
    
      <category term="mysql" scheme="http://yoursite.com/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>åˆ†æé—®é¢˜</title>
    <link href="http://yoursite.com/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql/%E5%88%86%E6%9E%90%E9%97%AE%E9%A2%98/"/>
    <id>http://yoursite.com/2-å¼€å‘æŠ€èƒ½/æ•°æ®åº“/Mysql/åˆ†æé—®é¢˜/</id>
    <published>2017-11-17T02:15:00.000Z</published>
    <updated>2017-12-03T16:04:44.529Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="åŸºæœ¬è®¤è¯†"><a href="#åŸºæœ¬è®¤è¯†" class="headerlink" title="åŸºæœ¬è®¤è¯†"></a>åŸºæœ¬è®¤è¯†</h1><ul><li>è¦å­¦ä¼šæ€æ ·åˆ†æé—®é¢˜ï¼Œè€Œä¸æ˜¯å•çº¯æ‹è„‘è¢‹ä¼˜åŒ–</li><li>æ…¢æŸ¥è¯¢åªæ˜¯æœ€åŸºç¡€çš„ä¸œè¥¿ï¼Œè¦å­¦ä¼šä¼˜åŒ–0.01ç§’çš„æŸ¥è¯¢è¯·æ±‚ã€‚</li><li>å½“å‘ç”Ÿè¿æ¥é˜»å¡æ—¶ï¼Œä¸åŒçŠ¶æ€çš„é˜»å¡æœ‰ä¸åŒçš„åŸå› ï¼Œè¦æ‰¾åˆ°åŸå› ï¼Œå¦‚æœä¸å¯¹ç—‡ä¸‹è¯ï¼Œå°±ä¼šå—è¾•åŒ—è¾™<ul><li>èŒƒä¾‹ï¼šå¦‚æœæœ¬èº«ç³»ç»Ÿå†…å­˜å·²ç»è¶…è½½ï¼Œå·²ç»ä½¿ç”¨åˆ°äº†swapï¼Œè€Œè¿˜åœ¨è€ƒè™‘åŠ å¤§ç¼“å­˜æ¥ä¼˜åŒ–æŸ¥è¯¢ï¼Œé‚£å°±æ˜¯è‡ªå¯»æ­»è·¯äº†ã€‚</li></ul></li><li>å½±å“ç»“æœé›†æ˜¯éå¸¸é‡è¦çš„ä¸­é—´æ•°æ®å’Œä¼˜åŒ–æŒ‡æ ‡ï¼Œå­¦ä¼šç†è§£è¿™ä¸€æ¦‚å¿µï¼Œç†è®ºä¸Šå½±å“ç»“æœé›†ä¸æŸ¥è¯¢æ•ˆç‡å‘ˆç°éå¸¸ç´§å¯†çš„çº¿æ€§ç›¸å…³ã€‚</li><li>ç›‘æµ‹ä¸è·Ÿè¸ªè¦ç»å¸¸åšï¼Œè€Œä¸æ˜¯å‡ºé—®é¢˜æ‰åš<ul><li>è¯»å–é¢‘ç¹åº¦æŠ½æ ·ç›‘æµ‹<ul><li>å…¨ç›‘æµ‹ä¸è¦æï¼Œi/oå“æ­»äººã€‚</li><li>æŒ‰ç…§ä¸€ä¸ªæŠ½æ ·æ¯”ä¾‹æŠ½æ ·å³å¯ã€‚</li><li>é’ˆå¯¹æŠ½æ ·ä¸­å‘ç°çš„é—®é¢˜ï¼Œå¯ä»¥æŒ‰ç…§ç‰¹å®šSQLåœ¨ç‰¹å®šæ—¶é—´å†…ç›‘æµ‹ä¸€æ®µå…¨æŸ¥è¯¢è®°å½•ï¼Œä½†ä»è¦è€ƒè™‘i/oå½±å“ã€‚</li></ul></li><li>å†™å…¥é¢‘ç¹åº¦ç›‘æµ‹<ul><li>åŸºäºbinlogè§£å¼€å³å¯ï¼Œå¯å®šæ—¶æˆ–ä¸å®šæ—¶åˆ†æã€‚</li></ul></li><li>å¾®æ…¢æŸ¥è¯¢æŠ½æ ·ç›‘æµ‹<ul><li>é«˜å¹¶å‘æƒ…å†µä¸‹ï¼ŒæŸ¥è¯¢è¯·æ±‚æ—¶é—´è¶…è¿‡0.01ç§’ç”šè‡³0.005ç§’çš„ï¼Œå»ºè®®é…Œæƒ…æŠ½æ ·è®°å½•ã€‚</li></ul></li><li>è¿æ¥æ•°é¢„è­¦ç›‘æµ‹<ul><li>è¿æ¥æ•°è¶…è¿‡ç‰¹å®šé˜ˆå€¼çš„æƒ…å†µä¸‹ï¼Œè™½ç„¶æ•°æ®åº“æ²¡æœ‰å´©æºƒï¼Œå»ºè®®è®°å½•ç›¸å…³è¿æ¥çŠ¶æ€ã€‚</li></ul></li></ul></li><li>å­¦ä¼šé€šè¿‡æ•°æ®å’Œç›‘æ§å‘ç°é—®é¢˜ï¼Œåˆ†æé—®é¢˜ï¼Œè€Œåè§£å†³é—®é¢˜é¡ºç†æˆç« ã€‚ç‰¹åˆ«æ˜¯è¦å­¦ä¼šåœ¨æ—¥å¸¸ç›‘æ§ä¸­å‘ç°éšæ‚£ï¼Œè€Œä¸æ˜¯é—®é¢˜çˆ†å‘äº†æ‰å»å¤„ç†å’Œè§£å†³ã€‚</li></ul><h1 id="å¸¸è§å…³æ³¨çš„é‡ç‚¹"><a href="#å¸¸è§å…³æ³¨çš„é‡ç‚¹" class="headerlink" title="å¸¸è§å…³æ³¨çš„é‡ç‚¹"></a>å¸¸è§å…³æ³¨çš„é‡ç‚¹</h1><h2 id="æ…¢æŸ¥è¯¢æ—¥å¿—"><a href="#æ…¢æŸ¥è¯¢æ—¥å¿—" class="headerlink" title="æ…¢æŸ¥è¯¢æ—¥å¿—"></a>æ…¢æŸ¥è¯¢æ—¥å¿—</h2><ul><li><p>æ˜¯å¦é”å®šï¼ŒåŠé”å®šæ—¶é—´<br>å¦‚å­˜åœ¨é”å®šï¼Œåˆ™è¯¥æ…¢æŸ¥è¯¢é€šå¸¸æ˜¯å› é”å®šå› ç´ å¯¼è‡´ï¼Œæœ¬èº«æ— éœ€ä¼˜åŒ–ï¼Œéœ€è§£å†³é”å®šé—®é¢˜ã€‚</p></li><li><p>å½±å“ç»“æœé›†<br>å¦‚å½±å“ç»“æœé›†è¾ƒå¤§ï¼Œæ˜¾ç„¶æ˜¯ç´¢å¼•é¡¹å‘½ä¸­å­˜åœ¨é—®é¢˜ï¼Œéœ€è¦è®¤çœŸå¯¹å¾…ã€‚</p></li></ul><h2 id="Explain-æ“ä½œ"><a href="#Explain-æ“ä½œ" class="headerlink" title="Explain æ“ä½œ"></a>Explain æ“ä½œ</h2><ul><li><p>ç´¢å¼•é¡¹ä½¿ç”¨<br>ä¸å»ºè®®ç”¨using indexåšå¼ºåˆ¶ç´¢å¼•ï¼Œå¦‚æœªå¦‚é¢„æœŸä½¿ç”¨ç´¢å¼•ï¼Œå»ºè®®é‡æ–°æ–Ÿé…Œè¡¨ç»“æ„å’Œç´¢å¼•è®¾ç½®ã€‚</p></li><li><p>å½±å“ç»“æœé›†<br>è¿™é‡Œæ˜¾ç¤ºçš„æ•°å­—ä¸ä¸€å®šå‡†ç¡®ï¼Œç»“åˆä¹‹å‰æåˆ°å¯¹æ•°æ®ç´¢å¼•çš„ç†è§£æ¥çœ‹ï¼Œè¿˜è®°å¾—å˜›ï¼Ÿå°±æŠŠç´¢å¼•å½“ä½œæœ‰åºåºåˆ—æ¥ç†è§£ï¼Œåæ€SQLã€‚</p></li></ul><h2 id="Set-profiling-show-profiles-for-queryæ“ä½œ"><a href="#Set-profiling-show-profiles-for-queryæ“ä½œ" class="headerlink" title="Set profiling , show profiles for queryæ“ä½œ"></a>Set profiling , show profiles for queryæ“ä½œ</h2><ul><li>æ‰§è¡Œå¼€é”€<ul><li>æ³¨æ„ï¼Œæœ‰é—®é¢˜çš„SQLå¦‚æœé‡å¤æ‰§è¡Œï¼Œå¯èƒ½åœ¨ç¼“å­˜é‡Œï¼Œè¿™æ—¶è¦æ³¨æ„é¿å…ç¼“å­˜å½±å“ã€‚é€šè¿‡è¿™é‡Œå¯ä»¥çœ‹åˆ°ã€‚</li><li>æ‰§è¡Œæ—¶é—´è¶…è¿‡0.005ç§’çš„é¢‘ç¹æ“ä½œSQLå»ºè®®éƒ½åˆ†æä¸€ä¸‹ã€‚</li><li>æ·±å…¥ç†è§£æ•°æ®åº“æ‰§è¡Œçš„è¿‡ç¨‹å’Œå¼€é”€çš„åˆ†å¸ƒ</li></ul></li></ul><h2 id="Show-processlist-æ‰§è¡ŒçŠ¶æ€ç›‘æ§"><a href="#Show-processlist-æ‰§è¡ŒçŠ¶æ€ç›‘æ§" class="headerlink" title="Show processlist æ‰§è¡ŒçŠ¶æ€ç›‘æ§"></a>Show processlist æ‰§è¡ŒçŠ¶æ€ç›‘æ§</h2><p>è¿™æ˜¯åœ¨æ•°æ®åº“è´Ÿè½½æ³¢åŠ¨æ—¶ç»å¸¸è¿›è¡Œçš„ä¸€é¡¹æ“ä½œ<br>å…·ä½“å‚è§ï¼š<a href="/æŠ€æœ¯ä¹‹è·¯/æ•°æ®åº“/Mysql/ä¼˜åŒ–/#æ‰§è¡ŒçŠ¶æ€">æŸ¥çœ‹æ‰§è¡ŒçŠ¶æ€</a></p><h1 id="æ’æŸ¥æ­¥éª¤"><a href="#æ’æŸ¥æ­¥éª¤" class="headerlink" title="æ’æŸ¥æ­¥éª¤"></a>æ’æŸ¥æ­¥éª¤</h1><h2 id="ç¡®è®¤é—®é¢˜"><a href="#ç¡®è®¤é—®é¢˜" class="headerlink" title="ç¡®è®¤é—®é¢˜"></a>ç¡®è®¤é—®é¢˜</h2><p><strong>è¯¦ç»†äº†è§£é—®é¢˜çŠ¶å†µ</strong></p><ul><li>Too many connections æ˜¯å¸¸è§è¡¨è±¡ï¼Œæœ‰å¾ˆå¤šç§åŸå› ã€‚</li><li>ç´¢å¼•æŸåçš„æƒ…å†µåœ¨innodbæƒ…å†µä¸‹å¾ˆå°‘å‡ºç°ã€‚</li><li>å¦‚å‡ºç°å…¶ä»–æƒ…å†µåº”è¿½æº¯æ—¥å¿—å’Œé”™è¯¯ä¿¡æ¯ã€‚</li></ul><h2 id="ç¡®è®¤ç“¶é¢ˆ"><a href="#ç¡®è®¤ç“¶é¢ˆ" class="headerlink" title="ç¡®è®¤ç“¶é¢ˆ"></a>ç¡®è®¤ç“¶é¢ˆ</h2><p><strong>å¸¸è§çš„ç“¶é¢ˆ</strong></p><ul><li><p>cpu éå¸¸é«˜â€“ç´¢å¼•é—®é¢˜ or å¹¶å‘å¤ªé«˜ï¼ˆé€šå¸¸æ˜¯ç´¢å¼•é—®é¢˜ï¼‰<br>å¹¶å‘é—®é¢˜ï¼šthread_pool é™åˆ¶è¿æ¥æ•°ï¼ˆå…¶ä»–åˆ†æ”¯éƒ½æ”¯æŒçº¿ç¨‹æ± ï¼‰</p></li><li><p>å†…å­˜ swapé«˜ â€“ å†…å­˜åˆ†é…ä¸è¶³ï¼ˆè¿‡å¤šä¼š oomï¼‰<br>é€‚é‡è°ƒæ•´å†…å­˜ï¼Œä¸è¦å¤ªå¤§ä¹Ÿä¸è¦å¤ªå°ï¼Œ50%-70%æ¯”è¾ƒä¿å®ˆï¼Œ80%å¤ªåæ¿€ï¼Œå°½é‡è¦†ç›–å…¨éƒ¨çƒ­ç‚¹æ•°æ®<br>mysql ä¸“ç”¨æœåŠ¡å™¨ï¼Œå…³é—­ swap</p></li><li><p>iowait å¤ªé«˜ â€“ å†…å­˜ä¸è¶³ or io è®¾å¤‡æ€§èƒ½å¤ªä½ or ç´¢å¼•ä¸å½“ or é¢‘ç¹è¯»å– select  or é¢‘ç¹æ’åº/åˆ†ç»„</p></li></ul><h3 id="äº†è§£åŸºæœ¬è¿è¥çŠ¶å†µ"><a href="#äº†è§£åŸºæœ¬è¿è¥çŠ¶å†µ" class="headerlink" title="äº†è§£åŸºæœ¬è¿è¥çŠ¶å†µ"></a>äº†è§£åŸºæœ¬è¿è¥çŠ¶å†µ</h3><ul><li>å½“å‰æ¯ç§’è¯»è¯·æ±‚</li><li>å½“å‰æ¯ç§’å†™è¯·æ±‚</li><li>å½“å‰åœ¨çº¿ç”¨æˆ·</li><li>å½“å‰æ•°æ®å®¹é‡</li></ul><h3 id="äº†è§£åŸºæœ¬è´Ÿè½½æƒ…å†µ"><a href="#äº†è§£åŸºæœ¬è´Ÿè½½æƒ…å†µ" class="headerlink" title="äº†è§£åŸºæœ¬è´Ÿè½½æƒ…å†µ"></a>äº†è§£åŸºæœ¬è´Ÿè½½æƒ…å†µ</h3><p>å­¦ä¼šä½¿ç”¨è¿™äº›æŒ‡ä»¤</p><ul><li>Top â€“ç³»ç»ŸçŠ¶æ€ï¼Œå“ªä¸ªæœåŠ¡/è¿›ç¨‹æ¶ˆè€—çš„ cpu ã€å†…å­˜</li><li>Vmstat â€“ æŸ¥çœ‹ cpuã€ioã€å†…å­˜è´Ÿè½½</li><li>dstat â€“ å’Œ vmstat ç±»ä¼¼ï¼Œç»“æœæ›´å‹å¥½</li><li>sar â€“ systat å·¥å…·åŒ…çš„ä¸€ä¸ªå‘½ä»¤ï¼›å…³æ³¨ï¼ˆsar  -u / -d / -rï¼‰cpu/io/å†…å­˜</li><li>iotop â€“ æŸ¥çœ‹å“ªä¸ªè¿›ç¨‹ io æ¶ˆè€—æœ€é«˜</li><li>oprofile â€“ ç¥å™¨ï¼Œä¸€èˆ¬ç”¨ä¸ä¸Šï¼Œç”¨æ³•è‡ªå·±æŸ¥</li><li>strace â€“ è·Ÿè¸ªè¿›ç¨‹æ‰§è¡Œæ—¶çš„ç³»ç»Ÿè°ƒç”¨å’Œæ‰€æ¥æ”¶çš„ä¿¡å·</li><li>uptime</li><li>iostat</li><li>df</li></ul><p>Cpuè´Ÿè½½æ„æˆ</p><ul><li>ç‰¹åˆ«å…³æ³¨i/oå‹åŠ›( wa%)</li><li>å¤šæ ¸è´Ÿè½½åˆ†é…</li></ul><p>å†…å­˜å ç”¨</p><ul><li>Swapåˆ†åŒºæ˜¯å¦è¢«ä¾µå ï¼Œè‹¥Swapåˆ†åŒºè¢«ä¾µå ï¼Œç‰©ç†å†…å­˜æ˜¯å¦è¾ƒå¤šç©ºé—²</li></ul><p>ç£ç›˜çŠ¶æ€</p><ul><li>ç¡¬ç›˜æ»¡å’ŒinodeèŠ‚ç‚¹æ»¡çš„æƒ…å†µè¦è¿…é€Ÿå®šä½å’Œè¿…é€Ÿå¤„ç†</li></ul><h3 id="æŸ¥çœ‹-mysql-çš„çŠ¶æ€"><a href="#æŸ¥çœ‹-mysql-çš„çŠ¶æ€" class="headerlink" title="æŸ¥çœ‹ mysql çš„çŠ¶æ€"></a>æŸ¥çœ‹ mysql çš„çŠ¶æ€</h3><p><strong>å½“å‰è¿æ¥æ•°</strong></p><ul><li>Netstat â€“an|grep 3306|wc â€“l</li><li>Show processlist</li></ul><p><strong>å½“å‰è¿æ¥åˆ†å¸ƒ show processlist</strong></p><ul><li>å‰ç«¯åº”ç”¨è¯·æ±‚æ•°æ®åº“ä¸è¦ä½¿ç”¨rootå¸å·ï¼<ul><li>Rootå¸å·æ¯”å…¶ä»–æ™®é€šå¸å·å¤šä¸€ä¸ªè¿æ¥æ•°è®¸å¯ã€‚</li><li>å‰ç«¯ä½¿ç”¨æ™®é€šå¸å·ï¼Œåœ¨too many connectionsçš„æ—¶å€™rootå¸å·ä»å¯ä»¥ç™»å½•æ•°æ®åº“æŸ¥è¯¢ show processlist!</li><li>è®°ä½ï¼Œå‰ç«¯åº”ç”¨ç¨‹åºä¸è¦è®¾ç½®ä¸€ä¸ªä¸å«rootçš„rootå¸å·æ¥ç³Šå¼„ï¼érootè´¦æˆ·æ˜¯éª¨å­é‡Œçš„ï¼Œè€Œä¸æ˜¯åä¹‰ä¸Šçš„ã€‚</li></ul></li><li>çŠ¶æ€åˆ†å¸ƒ<ul><li>ä¸åŒçŠ¶æ€ä»£è¡¨ä¸åŒçš„é—®é¢˜ï¼Œæœ‰ä¸åŒçš„ä¼˜åŒ–ç›®æ ‡ã€‚</li></ul></li><li>é›·åŒSQLçš„åˆ†å¸ƒ<ul><li>æ˜¯å¦è¾ƒå¤šé›·åŒSQLå‡ºç°åœ¨åŒä¸€çŠ¶æ€</li></ul></li></ul><p><strong>å½“å‰æ˜¯å¦æœ‰è¾ƒå¤šæ…¢æŸ¥è¯¢æ—¥å¿—</strong></p><ul><li>æ˜¯å¦é”å®š</li><li>å½±å“ç»“æœé›†</li></ul><p><strong>å¸¸ç”¨å‘½ä»¤</strong></p><ul><li><p>slow log<br>ä¼˜å…ˆé¢‘æ¬¡é«˜ï¼Œå…¶æ¬¡è€—æ—¶ä¹…</p></li><li><p>show global status</p><ol><li>æŸ¥çœ‹è¿æ¥æ•°ï¼ˆæ´»è·ƒã€ä¸æ´»è·ƒï¼‰ï¼Œè®¾ç½® interactive_timeoutã€wait_timeout çš„ timecountå€¼ï¼Œå‡å°‘ä¸æ´»è·ƒè¿æ¥</li><li>TPSã€QPSã€DML_Active<ul><li>tps=(handler_commit_d+handler_rollback_d)/uptime_d</li><li>qps=(questions_d2 - questions_d1)/uptime_d</li><li>dml_active=(com_select_d+com_insert_d+com_update_d+com_delete_d)/uptime_d</li></ul></li><li>å„ç§ bufferã€cache çš„åˆ©ç”¨ç‡ã€å‘½ä¸­ç‡<ul><li>innodb_buffer_pool_wait_free&gt;0 è¯´æ˜ innodb_buffer ä¸å¤Ÿç”¨,æœ‰ waitã€wait_free å‘ç”Ÿï¼Œéƒ½è¦å…³æ³¨ä¸‹</li><li>innodb_row_lock_current_waits å½“å‰è¡Œé”çš„ä¸ªæ•°</li><li>slow_queries æ…¢æŸ¥è¯¢çš„æ¬¡æ•°</li><li>table_locks_immediate è¡¨é”çš„æ¬¡æ•°</li><li>table_locks_waited è¡¨é”ç­‰å¾…çš„æ¬¡æ•°</li></ul></li></ol></li><li><p>show processlist</p></li><li><p>show engine innodb status<br>ä¸»è¦çœ‹é”ï¼Œäº‹åŠ¡ï¼Œç­‰å¾…</p></li><li><p>pt-ioprofile<br>å¯ä»¥æŸ¥çœ‹å“ªä¸ªè¡¨åœ¨é¢‘ç¹çš„è¯»å†™</p></li></ul><h3 id="é¢‘ç¹åº¦åˆ†æ"><a href="#é¢‘ç¹åº¦åˆ†æ" class="headerlink" title="é¢‘ç¹åº¦åˆ†æ"></a>é¢‘ç¹åº¦åˆ†æ</h3><ul><li>å†™é¢‘ç¹åº¦<ul><li>å¦‚æœi/oå‹åŠ›é«˜ï¼Œä¼˜å…ˆåˆ†æå†™å…¥é¢‘ç¹åº¦</li><li>Mysqlbinlog è¾“å‡ºæœ€æ–°binlogæ–‡ä»¶ï¼Œç¼–å†™è„šæœ¬æ‹†åˆ†</li><li>æœ€å¤šå†™å…¥çš„æ•°æ®è¡¨æ˜¯å“ªä¸ª</li><li>æœ€å¤šå†™å…¥çš„æ•°æ®SQLæ˜¯ä»€ä¹ˆ</li><li>æ˜¯å¦å­˜åœ¨åŸºäºåŒä¸€ä¸»é”®çš„æ•°æ®å†…å®¹é«˜é¢‘é‡å¤å†™å…¥ï¼Ÿ<ul><li>æ¶‰åŠæ¶æ„ä¼˜åŒ–éƒ¨åˆ†ï¼Œå‚è§æ¶æ„ä¼˜åŒ–-ç¼“å­˜å¼‚æ­¥æ›´æ–°</li></ul></li></ul></li><li>è¯»å–é¢‘ç¹åº¦<ul><li>å¦‚æœcpuèµ„æºè¾ƒé«˜ï¼Œè€Œi/oå‹åŠ›ä¸é«˜ï¼Œä¼˜å…ˆåˆ†æè¯»å–é¢‘ç¹åº¦</li><li>ç¨‹åºä¸­åœ¨å°è£…çš„dbç±»å¢åŠ æŠ½æ ·æ—¥å¿—å³å¯ï¼ŒæŠ½æ ·æ¯”ä¾‹é…Œæƒ…è€ƒè™‘ï¼Œä»¥ä¸æ˜¾è‘—å½±å“ç³»ç»Ÿè´Ÿè½½å‹åŠ›ä¸ºåº•çº¿ã€‚</li><li>æœ€å¤šè¯»å–çš„æ•°æ®è¡¨æ˜¯å“ªä¸ª</li><li>æœ€å¤šè¯»å–çš„æ•°æ®SQLæ˜¯ä»€ä¹ˆ<ul><li>è¯¥SQLè¿›è¡Œexplain å’Œset profilingåˆ¤å®š</li><li>æ³¨æ„åˆ¤å®šæ—¶éœ€è¦é¿å…query cacheå½±å“<ul><li>æ¯”å¦‚ï¼Œåœ¨è¿™ä¸ªSQLæœ«å°¾å¢åŠ ä¸€ä¸ªæ¡ä»¶å­å¥ and 1=1 å°±å¯ä»¥é¿å…ä»query cacheä¸­è·å–æ•°æ®ï¼Œè€Œå¾—åˆ°çœŸå®çš„æ‰§è¡ŒçŠ¶æ€åˆ†æã€‚</li></ul></li></ul></li><li>æ˜¯å¦å­˜åœ¨åŒä¸€ä¸ªæŸ¥è¯¢çŸ­æœŸå†…é¢‘ç¹å‡ºç°çš„æƒ…å†µ<ul><li>æ¶‰åŠå‰ç«¯ç¼“å­˜ä¼˜åŒ–</li></ul></li></ul></li></ul><h2 id="åˆ¶å®šæ–¹æ¡ˆ"><a href="#åˆ¶å®šæ–¹æ¡ˆ" class="headerlink" title="åˆ¶å®šæ–¹æ¡ˆ"></a>åˆ¶å®šæ–¹æ¡ˆ</h2><p>æŠ“å¤§æ”¾å°ï¼Œè§£å†³æ˜¾è‘—é—®é¢˜</p><ul><li>ä¸è‹›æ±‚è§£å†³æ‰€æœ‰ä¼˜åŒ–é—®é¢˜ï¼Œä½†æ˜¯åº”ä»¥ä¿è¯çº¿ä¸ŠæœåŠ¡ç¨³å®šå¯é ä¸ºç›®æ ‡ã€‚</li><li>è§£å†³ä¸è¯„ä¼°è¦åŒæ—¶è¿›è¡Œï¼Œæ–°çš„ç­–ç•¥æˆ–è§£å†³æ–¹æ¡ˆåŠ¡å¿…ç»è¿‡è¯„ä¼°åä¸Šçº¿ã€‚</li></ul><h2 id="æµ‹è¯•æ–¹æ¡ˆ"><a href="#æµ‹è¯•æ–¹æ¡ˆ" class="headerlink" title="æµ‹è¯•æ–¹æ¡ˆ"></a>æµ‹è¯•æ–¹æ¡ˆ</h2><p>ç¡®è®¤ä¼˜åŒ–æ–¹æ¡ˆçš„è¦†ç›–èŒƒå›´ï¼Œä¸è¦ä¸ºäº†è§£å†³1%çš„é—®é¢˜è€Œå¿½ç•¥äº†99%çš„é—®é¢˜ï¼Œå¹¶ä¸”ä¸èƒ½å¸¦æ¥æ–°çš„é—®é¢˜ï¼ˆç´¢å¼•æ»¥ç”¨ï¼Œå¤ªå¤šç´¢å¼•ï¼Œå¯¼è‡´ dml æ•ˆç‡é™ä½ï¼‰è€Œä¸”æœ€å¥½å†æµ‹è¯•ç¯å¢ƒéªŒè¯é€šè¿‡åå†ä¸Šçº¿</p><h2 id="å®æ–½æ–¹æ¡ˆ"><a href="#å®æ–½æ–¹æ¡ˆ" class="headerlink" title="å®æ–½æ–¹æ¡ˆ"></a>å®æ–½æ–¹æ¡ˆ</h2><h2 id="å›é¡¾åé¦ˆ"><a href="#å›é¡¾åé¦ˆ" class="headerlink" title="å›é¡¾åé¦ˆ"></a>å›é¡¾åé¦ˆ</h2><h1 id="æ¡ˆä¾‹åˆ†æ"><a href="#æ¡ˆä¾‹åˆ†æ" class="headerlink" title="æ¡ˆä¾‹åˆ†æ"></a>æ¡ˆä¾‹åˆ†æ</h1><h2 id="æœåŠ¡å™¨å‡ºç°too-many-connections-é˜»å¡"><a href="#æœåŠ¡å™¨å‡ºç°too-many-connections-é˜»å¡" class="headerlink" title="æœåŠ¡å™¨å‡ºç°too many connections é˜»å¡"></a>æœåŠ¡å™¨å‡ºç°too many connections é˜»å¡</h2><p>å…¥æ‰‹ç‚¹ï¼š</p><ul><li>æŸ¥çœ‹æœåŠ¡å™¨çŠ¶æ€ï¼Œcpuå ç”¨ï¼Œå†…å­˜å ç”¨ï¼Œç¡¬ç›˜å ç”¨ï¼Œç¡¬ç›˜i/oå‹åŠ›</li><li>æŸ¥çœ‹ç½‘ç»œæµé‡çŠ¶æ€ï¼Œmysqlä¸åº”ç”¨æœåŠ¡å™¨çš„è¾“å…¥è¾“å‡ºçŠ¶å†µ</li><li>é€šè¿‡Show processlistæŸ¥çœ‹å½“å‰è¿è¡Œæ¸…å•</li><li>æ³¨æ„äº‹é¡¹ï¼Œæ—¥å¸¸åº”ç”¨ç¨‹åºè¿æ¥æ•°æ®åº“ä¸è¦ä½¿ç”¨rootè´¦æˆ·ï¼Œä¿è¯æ•…éšœæ—¶å¯ä»¥é€šè¿‡root è¿›å…¥æ•°æ®åº“æŸ¥çœ‹ show processlistã€‚</li></ul><p>çŠ¶æ€åˆ†æï¼š</p><ul><li>å‚è§å¦‚ä¸Šæ‰§è¡ŒçŠ¶æ€æ¸…å•ï¼Œæ ¹æ®è¿æ¥çŠ¶æ€çš„åˆ†å¸ƒå»ç¡®å®šåŸå› ã€‚</li></ul><p>ç´§æ€¥æ¢å¤</p><ul><li>åœ¨ç¡®å®šæ•…éšœåŸå› åï¼Œåº”é€šè¿‡killæ‰é˜»å¡è¿›ç¨‹çš„æ–¹å¼ ç«‹å³æ¢å¤æ•°æ®åº“ã€‚</li></ul><p>å–„åå¤„ç†ï¼šä»¥ä¸‹é’ˆå¯¹å¸¸è§é—®é¢˜ç®€å•è§£è¯»</p><ul><li>Sleep è¿æ¥è¿‡å¤šå¯¼è‡´ï¼Œåº”ç”¨ç«¯åŠæ—¶é‡Šæ”¾è¿æ¥ï¼Œæ’æŸ¥å…³è”å› ç´ ã€‚</li><li>Lockedè¿æ¥è¿‡å¤šï¼Œå¦‚æºäºmyisamè¡¨çº§é”ï¼Œæ›´innodbå¼•æ“;å¦‚æºäºæ›´æ–°æ“ä½œä½¿ç”¨äº†ä¸æ°å½“çš„ç´¢å¼•æˆ–æœªä½¿ç”¨ç´¢å¼•ï¼Œæ”¹å†™æ›´æ–°æ“ä½œSQLæˆ–å»ºç«‹æ°å½“ç´¢å¼•ã€‚</li><li>Sending dataè¿æ¥è¿‡å¤šï¼Œç”¨å½±å“ç»“æœé›†çš„æ€è·¯ä¼˜åŒ–SQLæŸ¥è¯¢ï¼Œä¼˜åŒ–è¡¨ç´¢å¼•ç»“æ„ã€‚</li><li>Free itemsè¿æ¥è¿‡å¤šï¼Œi/oå‹åŠ›è¿‡å¤§ æˆ–ç¡¬ç›˜æ•…éšœ</li><li>Waiting for net , writing to net è¿æ¥è¿‡å¤šï¼Œ mysqlä¸åº”ç”¨æœåŠ¡å™¨è¿æ¥é˜»å¡ã€‚</li><li>å…¶ä»–ä»å‚è§å¦‚ä¸Šæ‰§è¡ŒçŠ¶æ€æ¸…å•æ‰€ç¤ºåˆ†æã€‚</li><li>å¦‚æ¶‰åŠä¸ååˆ†ä¸¥æ ¼å®‰å…¨è¦æ±‚çš„æ•°æ®å†…å®¹ï¼Œå¯ç”¨å®šæœŸè„šæœ¬è·Ÿè¸ªè¯·æ±‚è¿›ç¨‹ï¼Œå¹¶killæ‰åƒµæ­»è¿›ç¨‹ã€‚å¦‚æ•°æ®å®‰å…¨è¦æ±‚è¾ƒä¸¥æ ¼ï¼Œåˆ™ä¸èƒ½å¦‚æ­¤è¿›è¡Œã€‚</li></ul><h2 id="æ•°æ®åº“è´Ÿè½½è¿‡é«˜ï¼Œå“åº”ç¼“æ…¢"><a href="#æ•°æ®åº“è´Ÿè½½è¿‡é«˜ï¼Œå“åº”ç¼“æ…¢" class="headerlink" title="æ•°æ®åº“è´Ÿè½½è¿‡é«˜ï¼Œå“åº”ç¼“æ…¢"></a>æ•°æ®åº“è´Ÿè½½è¿‡é«˜ï¼Œå“åº”ç¼“æ…¢</h2><p><strong>å…¥æ‰‹ç‚¹ï¼š</strong></p><ul><li>æŸ¥çœ‹cpuçŠ¶æ€ï¼ŒæœåŠ¡å™¨è´Ÿè½½æ„æˆ</li></ul><p><strong>å¯èƒ½é—®é¢˜1ï¼ši/oå ç”¨è¿‡é«˜</strong></p><ul><li>æ­¥éª¤1ï¼š æ£€æŸ¥å†…å­˜æ˜¯å¦å ç”¨swapåˆ†åŒºï¼Œæ’é™¤å› å†…å­˜ä¸è¶³å¯¼è‡´çš„i/oå¼€é”€ã€‚</li><li>æ­¥éª¤2ï¼šé€šè¿‡iostat æŒ‡ä»¤åˆ†æi/oæ˜¯å¦é›†ä¸­äºæ•°æ®åº“ç¡¬ç›˜ï¼Œæ˜¯å¦æ˜¯å†™å…¥åº¦è¾ƒé«˜ã€‚</li><li>æ­¥éª¤3ï¼šå¦‚æœå‹åŠ›æ¥è‡ªäºå†™ï¼Œä½¿ç”¨mysqlbinlog è§£å¼€æœ€æ–°çš„binlogæ–‡ä»¶ã€‚</li><li>æ­¥éª¤4ï¼šç¼–å†™æ—¥å¿—åˆ†æè„šæœ¬æˆ–grepæŒ‡ä»¤ï¼Œåˆ†ææ¯ç§’å†™å…¥é¢‘åº¦å’Œå†™å…¥å†…å®¹ã€‚<ul><li>å†™å…¥é¢‘åº¦ä¸é«˜ï¼Œåˆ™è¯´æ˜i/oå‹åŠ›å¦æœ‰åŸå› æˆ–æ•°æ®åº“é…ç½®ä¸åˆç†ã€‚</li></ul></li><li>æ­¥éª¤5ï¼šç¼–å†™æ—¥å¿—åˆ†æè„šæœ¬æˆ–grep æŒ‡ä»¤ï¼Œåˆ†æå†™å…¥çš„æ•°æ®è¡¨æ„æˆï¼Œå’Œå†™å…¥çš„ç›®æ ‡æ„æˆã€‚</li><li>æ­¥éª¤6ï¼šç¼–å†™æ—¥å¿—åˆ†æè„šæœ¬ï¼Œåˆ†ææ˜¯å¦å­˜åœ¨åŒä¸€ä¸»é”®çš„é‡å¤å†™å…¥ã€‚ æ¯”å¦‚å‡ºç°å¤§é‡ update post set views=views+1 where tagid=çš„æ“ä½œï¼Œå‡è®¾åœ¨ä¸€æ®µæ—¶é—´å†…å‡ºç°äº†2ä¸‡æ¬¡ï¼Œè€Œå…¶ä¸­ä¸åŒçš„tagidæœ‰1ä¸‡æ¬¡ï¼Œé‚£ä¹ˆå°±æ˜¯æœ‰50%çš„è¯·æ±‚æ˜¯é‡å¤updateè¯·æ±‚ï¼Œæœ‰å¯ä»¥é€šè¿‡å¼‚æ­¥æ›´æ–°åˆå¹¶çš„ç©ºé—´ã€‚</li></ul><p>æç¤ºä¸€ä¸‹ï¼Œä»¥ä¸Šæ‰€æåŠçš„æ—¥å¿—åˆ†æè„šæœ¬ç¼–å†™ï¼Œæ­£å¸¸æƒ…å†µä¸‹ä¸åº”è¶…è¿‡1ä¸ªå°æ—¶ï¼Œè€Œå¯¹ç³»ç»Ÿè´Ÿè½½åˆ†ææ‰€æä¾›çš„æ•°æ®æ”¯æŒä»·å€¼æ˜¯å·¨å¤§çš„ï¼Œå¯¹æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆçš„é€‰æ‹©æ˜¯éå¸¸æœ‰æ„ä¹‰çš„ï¼Œå¦‚æœæ‚¨è®¤ä¸ºè¿™é¡¹å·¥ä½œæ˜¯ç¹å†—è€Œä¸”å¤æ‚çš„å·¥ä½œï¼Œé‚£ä¹ˆä¸€å®šæ˜¯åœ¨åˆ†ææ€è·¯å’Œç›®æ ‡æŠŠæ¡ä¸Šå‡ºç°äº†åå·®ã€‚</p><p><strong>å¯èƒ½é—®é¢˜2ï¼ši/oå ç”¨ä¸é«˜ï¼ŒCPU å ç”¨è¿‡é«˜</strong></p><ul><li>æ­¥éª¤1ï¼šæŸ¥çœ‹æ…¢æŸ¥è¯¢æ—¥å¿—</li><li>æ­¥éª¤2ï¼šä¸æ–­åˆ·æ–°æŸ¥çœ‹Show processlistæ¸…å•ï¼Œå¹¶æŠŠæ¡å¯èƒ½é¢‘ç¹å‡ºç°çš„å¤„äºSending dataçŠ¶æ€çš„SQLã€‚</li><li>æ­¥éª¤3ï¼šè®°å½•å‰ç«¯æ‰§è¡ŒSQL<ul><li>äºå‰ç«¯åº”ç”¨ç¨‹åºæ‰§è¡ŒæŸ¥è¯¢çš„å°è£…å¯¹è±¡å†…ï¼Œè®¾ç½®éšæœºé‡‡æ ·ï¼Œè®°å½•å‰ç«¯æ‰§è¡Œçš„SQLï¼Œä¿è¯æœ‰ä¸€å®šçš„æ ·æœ¬è§„æ¨¡ï¼Œå¹¶ä¸”ä¸ä¼šå¸¦æ¥å‰ç«¯i/oè´Ÿè½½çš„æ¿€å¢ã€‚</li><li>åŸºäºé‡‡æ ·ç‡å’Œè®°å½•é¢‘ç‡ï¼Œè·å¾—æ¯ç§’è¯»è¯·æ±‚æ¬¡æ•°æ•°æ®æŒ‡æ ‡ã€‚</li><li>ç¼–å†™æ—¥å¿—åˆ†æè„šæœ¬ï¼Œåˆ†æé‡‡æ ·çš„SQLæ„æˆï¼Œæ‰€æ“ä½œçš„æ•°æ®è¡¨ï¼Œæ‰€æ“ä½œçš„ä¸»é”®ã€‚</li><li>å¯¹é¢‘ç¹é‡å¤è¯»å–çš„SQL(å®Œå…¨ä¸€è‡´çš„SQL)è¿›è¡Œåˆ¤å®šï¼Œæ˜¯å¦æ•°æ®å­˜åœ¨é¢‘ç¹å˜åŠ¨ï¼Œæ˜¯å¦éœ€è¦å®æ—¶å±•ç°æœ€æ–°æ•°æ®ï¼Œå¦‚æœ‰å¯èƒ½ï¼Œç¼“å­˜åŒ–ï¼Œå¹¶é¢„ä¼°ç¼“å­˜å‘½ä¸­ç‡ã€‚</li><li>å¯¹é¢‘ç¹è¯»å–ä½†ä¸é‡å¤çš„(SQLç»“æ„ä¸€è‡´ï¼Œä½†æ¡ä»¶ä¸­çš„æ•°æ®ä¸ä¸€è‡´)SQLè¿›è¡Œåˆ¤å®šï¼Œæ˜¯å¦ç´¢å¼•è¶³å¤Ÿä¼˜åŒ–ï¼Œå½±å“ç»“æœé›†ä¸è¾“å‡ºç»“æœæ˜¯å¦è¶³å¤Ÿæ¥è¿‘ã€‚</li></ul></li><li>æ­¥éª¤4ï¼šå°†å¯¼è‡´æ…¢æŸ¥è¯¢çš„SQLæˆ–é¢‘ç¹å‡ºç°äºshow processlistçŠ¶æ€çš„SQLï¼Œæˆ–é‡‡æ ·è®°å½•çš„é¢‘ç¹åº¦SQLè¿›è¡Œåˆ†æï¼ŒæŒ‰ç…§å½±å“ç»“æœé›†çš„æ€è·¯å’Œç´¢å¼•ç†è§£æ¥ä¼˜åŒ–ã€‚</li><li>æ­¥éª¤5ï¼šå¯¹å¦‚ä¸Šéš¾ä»¥ç•Œå®šé—®é¢˜çš„SQLè¿›è¡Œ set profiling åˆ†æã€‚</li><li>æ­¥éª¤6ï¼šä¼˜åŒ–ååˆ†æç»§ç»­é‡‡æ ·è·Ÿè¸ªåˆ†æã€‚å¹¶è·Ÿè¸ªæ¯”å¯¹ç»“æœã€‚</li></ul><p><strong>å–„åå¤„ç†</strong></p><ul><li>æ—¥å¸¸è·Ÿè¸ªè„šæœ¬ï¼Œä¸æ–­è®°å½•ä¸€äº›çŠ¶æ€ä¿¡æ¯ã€‚ä¿è¯æ¯ä¸ªæ—¶é—´èŠ‚ç‚¹éƒ½èƒ½å›æº¯ã€‚</li><li>ç¡®ä¿éšæ—¶èƒ½äº†è§£æœåŠ¡å™¨çš„è¯·æ±‚é¢‘æ¬¡ï¼Œè¯»å†™è¯·æ±‚çš„åˆ†å¸ƒã€‚</li><li>è®°å½•ä¸€äº›æœªé€ æˆè‡´å‘½å½±å“çš„éšæ‚£ç‚¹ï¼Œå¯æš‚ä¸è§£å†³ï¼Œä½†éœ€è¦è®°å½•ã€‚</li><li>å¦‚ç¡®ç³»æœåŠ¡å™¨è¯·æ±‚é¢‘æ¬¡è¿‡é«˜ï¼Œå¯åŸºäºè´Ÿè½½åˆ†å¸ƒå†³å®šç¡¬ä»¶æ‰©å®¹æ–¹æ¡ˆï¼Œæ¯”å¦‚i/oå‹åŠ›è¿‡é«˜å¯è€ƒè™‘å›ºæ€ç¡¬ç›˜ï¼›å†…å­˜å ç”¨swapå¯è€ƒè™‘å¢åŠ å†…å®¹å®¹é‡ç­‰ã€‚ç”¨å°½å¯èƒ½å°‘çš„æŠ•å…¥å®ç°æœ€å¥½çš„è´Ÿè½½æ”¯æ’‘èƒ½åŠ›ï¼Œè€Œä¸æ˜¯ç®€å•çš„ä¹°æ›´å¤šæœåŠ¡å™¨ã€‚</li></ul><!--ä»¥ä¸‹æ˜¯è„šæ³¨-->]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;åŸºæœ¬è®¤è¯†&quot;&gt;&lt;a href=&quot;#åŸºæœ¬è®¤è¯†&quot; class=&quot;head
      
    
    </summary>
    
      <category term="2-å¼€å‘æŠ€èƒ½" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/"/>
    
      <category term="æ•°æ®åº“" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="Mysql" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql/"/>
    
    
      <category term="mysql" scheme="http://yoursite.com/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title> æ¶æ„ä¸è¡¨è®¾è®¡</title>
    <link href="http://yoursite.com/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql/%E6%9E%B6%E6%9E%84%E4%B8%8E%E8%A1%A8%E8%AE%BE%E8%AE%A1/"/>
    <id>http://yoursite.com/2-å¼€å‘æŠ€èƒ½/æ•°æ®åº“/Mysql/æ¶æ„ä¸è¡¨è®¾è®¡/</id>
    <published>2017-11-16T15:35:00.000Z</published>
    <updated>2017-12-03T16:04:44.532Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="æ•°æ®è¡¨è®¾è®¡"><a href="#æ•°æ®è¡¨è®¾è®¡" class="headerlink" title="æ•°æ®è¡¨è®¾è®¡"></a>æ•°æ®è¡¨è®¾è®¡</h1><h2 id="å­˜å‚¨å¼•æ“"><a href="#å­˜å‚¨å¼•æ“" class="headerlink" title="å­˜å‚¨å¼•æ“"></a>å­˜å‚¨å¼•æ“</h2><ol><li><strong>é»˜è®¤ä½¿ç”¨innodb å¼•æ“</strong>ï¼ŒåŸºæœ¬æŠ›å¼ƒ myisamï¼ˆåªè¯»ä¹Ÿä¸ä¸€å®šæ¯” innodb å¿«ï¼‰</li><li><strong>text/blob å‚ç›´æ‹†åˆ†åï¼Œè½¬æˆ myisam è¡¨</strong>ï¼Œinnodb å­˜ blob ä¼šäº§ç”Ÿå¤§é‡çš„ç£ç›˜ç¢ç‰‡</li></ol><p>å„å­˜å‚¨å¼•æ“åŒºåˆ«ï¼š<a href="/æŠ€æœ¯ä¹‹è·¯/æ•°æ®åº“/Mysql/åŸºç¡€çŸ¥è¯†/#æ•°æ®å¼•æ“">å­˜å‚¨å¼•æ“</a></p><h2 id="å­—ç¬¦é›†"><a href="#å­—ç¬¦é›†" class="headerlink" title="å­—ç¬¦é›†"></a>å­—ç¬¦é›†</h2><p><strong>é»˜è®¤ä½¿ç”¨utf-8</strong></p><p>æ³¨æ„å­—ç¬¦é›†é—®é¢˜ï¼Œserver=&gt;database(triggerã€stored procedureã€event scheduler)=&gt;table=&gt;column<br>ä¸è¦åŒæ—¶æŒ‡å®šå­—ç¬¦é›†ï¼ˆcharacter setï¼‰å’Œæ ¡éªŒé›†ï¼ˆcollect setï¼‰ï¼Œé¿å…å‡ºç°å’Œé»˜è®¤å¯¹åº”å…³ç³»ä¸ä¸€è‡´</p><h2 id="å­—æ®µç±»å‹"><a href="#å­—æ®µç±»å‹" class="headerlink" title="å­—æ®µç±»å‹"></a>å­—æ®µç±»å‹</h2><h3 id="åŸºæœ¬åŸåˆ™"><a href="#åŸºæœ¬åŸåˆ™" class="headerlink" title="åŸºæœ¬åŸåˆ™"></a>åŸºæœ¬åŸåˆ™</h3><ol><li>è¶Šå°è¶Šå¥½</li><li>å­—æ®µéƒ½NOT NULL<ul><li>é»˜è®¤éƒ½åŠ ä¸ŠNOT NULLçº¦æŸï¼Œå¿…é¡»ä¸ºNULLç”¨0è¡¨ç¤º</li><li>åœ¨å¯¹è¯¥å­—æ®µè¿›è¡ŒCOUNT(*)ç»Ÿè®¡æ—¶ï¼Œç»Ÿè®¡ç»“æœæ›´å‡†ç¡®ï¼ˆå€¼ä¸ºNULLçš„ä¸ä¼šè¢«COUNTç»Ÿè®¡è¿›å»ï¼‰</li></ul></li></ol><h3 id="å­˜å‚¨æŠ€å·§"><a href="#å­˜å‚¨æŠ€å·§" class="headerlink" title="å­˜å‚¨æŠ€å·§"></a>å­˜å‚¨æŠ€å·§</h3><ol><li><p><strong>å¯ä½¿ç”¨æšä¸¾ç±»å‹</strong><br>ENUMçš„å†…éƒ¨å­˜å‚¨æœºåˆ¶æ˜¯é‡‡ç”¨TINYINTæˆ–SMALLINTï¼ˆå¹¶éCHAR/VARCHARï¼‰ï¼Œæ€§èƒ½ä¸€ç‚¹éƒ½ä¸å·®</p></li><li><p><strong>å­˜å‚¨ipv4åœ°å€</strong><br>ç”¨INT UNSIGNEDå­˜å‚¨IPV4åœ°å€ï¼Œç”¨INET_ATON()ã€INET_NTOA()è¿›è¡Œè½¬æ¢</p></li><li><p><strong>å­˜å‚¨æ—¥æœŸæ—¶é—´</strong><br><strong>ä¸€ä¸ªå¸¸è¯†æ€§è¯¯å¯¼ï¼šå»ºè®®ç”¨TIMESTAMPå–ä»£DATETIMEã€‚</strong><br>ä»5.6å¼€å§‹ï¼Œå»ºè®®ä¼˜å…ˆé€‰æ‹©DATETIMEå­˜å‚¨æ—¥æœŸæ—¶é—´ã€‚å› ä¸ºå®ƒçš„å¯ç”¨èŒƒå›´æ¯”TIMESTAMPæ›´å¤§ï¼Œç‰©ç†å­˜å‚¨ä¸Šä»…æ¯”TIMESTAMPå¤š1ä¸ªå­—èŠ‚ï¼Œæ•´ä½“æ€§èƒ½ä¸Šçš„æŸå¤±å¹¶ä¸å¤§ã€‚</p></li><li><p><strong>InnoDBè¡¨è¡Œè®°å½•ç‰©ç†é•¿åº¦ä¸è¶…è¿‡8KB</strong><br><strong>InnoDBçš„data pageé»˜è®¤æ˜¯16KBçš„æƒ…å†µä¸‹ã€‚</strong><br>å½“å®é™…å­˜å‚¨é•¿åº¦è¶…è¿‡8KBï¼ˆå°¤å…¶æœ‰TEXT/BLOBåˆ—ï¼‰ä¸”è¯»å†™é¢‘ç¹çš„è¯, åˆ™æœ€å¥½æŠŠè¿™äº›åˆ—æ‹†åˆ†åˆ°å­è¡¨ä¸­ï¼Œä¸è¦å’Œä¸»è¡¨æ”¾åœ¨ä¸€èµ·å­˜å‚¨ã€‚å¦‚æœä¸å¤ªé¢‘ç¹ï¼Œå¯ä»¥è€ƒè™‘ç»§ç»­ä¿ç•™åœ¨ä¸»è¡¨ä¸­<sup id="fnref:1"><a href="#fn:1" rel="footnote"><span class="hint--top-right hint--error hint--large" aria-label="[MySQLä¼˜åŒ–æ¡ˆä¾‹]ç³»åˆ— â€” ä¼˜åŒ–InnoDBè¡¨BLOBåˆ—çš„å­˜å‚¨æ•ˆç‡">[1]</span></a></sup>ã€‚</p></li></ol><h2 id="ç´¢å¼•"><a href="#ç´¢å¼•" class="headerlink" title="ç´¢å¼•"></a>ç´¢å¼•</h2><ol><li>æ˜¾å¼æŒ‡å®šè‡ªå¢ int/bigint unsigned not null ä½œä¸ºä¸»é”®(æœ‰ä¸»é”® TPS æå‡9%ï¼Œä¸è¦ä½¿ç”¨ uuidï¼Œæ€§èƒ½å·®)</li><li>é€‰æ‹©é€‚å½“çš„ç´¢å¼•é¡ºåºï¼Œé€‰æ‹©æ€§é«˜æ¡ä»¶é å‰</li><li>åŸºæ•°ï¼ˆ Cardinality ï¼‰å¾ˆä½ï¼ˆ30%ä»¥ä¸‹ï¼‰çš„å­—æ®µä¸åˆ›å»ºç´¢å¼•ï¼ˆMySQLè¿˜ä¸æ”¯æŒ bitmap ç´¢å¼•ï¼‰</li><li>å¸¸ç”¨æ’åºï¼ˆORDER BYï¼‰ã€åˆ†ç»„ï¼ˆGROUP BYï¼‰ã€å–å”¯ä¸€ï¼ˆDISTINCTï¼‰å­—æ®µä¸Šåˆ›å»ºç´¢å¼•</li><li>å•è¡¨ç´¢å¼•æ•°é‡ä¸è¶…è¿‡5ä¸ª</li><li>ä¸ä½¿ç”¨å¤–é”®</li><li>è¶…è¿‡20ä¸ªé•¿åº¦çš„å­—ç¬¦ä¸²åˆ—ï¼ˆä¸éœ€è¦æ’åºï¼‰ï¼Œåˆ›å»ºå‰ç¼€ç´¢å¼•è€Œéæ•´åˆ—ç´¢å¼•<sup id="fnref:6"><a href="#fn:6" rel="footnote"><span class="hint--top-right hint--error hint--large" aria-label="ä¾‹å¦‚ï¼š`ALTER TABLE t1 ADD INDEX(user(20))`å‰ç¼€ç´¢å¼•çš„é•¿åº¦å¯ä»¥åŸºäºå¯¹è¯¥å­—æ®µçš„ç»Ÿè®¡å¾—å‡ºï¼Œä¸€èˆ¬ç•¥å¤§äºå¹³å‡é•¿åº¦ä¸€ç‚¹å°±å¯ä»¥äº†ã€‚">[6]</span></a></sup><ul><li>ä¼˜ç‚¹:æœ‰æ•ˆæé«˜ç´¢å¼•åˆ©ç”¨ç‡</li><li>ç¼ºç‚¹:å¯¹è¿™ä¸ªåˆ—æ’åºæ—¶ç”¨ä¸åˆ°å‰ç¼€ç´¢å¼•</li></ul></li></ol><h2 id="é«˜çº§ç‰¹æ€§ä½¿ç”¨"><a href="#é«˜çº§ç‰¹æ€§ä½¿ç”¨" class="headerlink" title="é«˜çº§ç‰¹æ€§ä½¿ç”¨"></a>é«˜çº§ç‰¹æ€§ä½¿ç”¨</h2><ol><li><p><strong>æ˜¯å¦ä½¿ç”¨åˆ†åŒºè¡¨ï¼Ÿ</strong><br>åœ¨å¯ä»¥æå‡æ€§èƒ½æˆ–è€…è¿ç»´ä¾¿åˆ©æ€§çš„åœºæ™¯ä¸‹ï¼Œè¿˜æ˜¯å»ºè®®ä½¿ç”¨åˆ†åŒºè¡¨ã€‚ä¾‹å¦‚ï¼šæ—¥å¿—ç³»ç»Ÿï¼ŒæŒ‰æ—¶é—´çº¬åº¦è¿›è¡Œåˆ†åŒºï¼Œæ–¹ä¾¿åˆ é™¤å†å²æ•°æ®</p></li><li><p><strong>æ˜¯å¦ä½¿ç”¨å­˜å‚¨è¿‡ç¨‹ã€è§¦å‘å™¨ï¼Ÿ</strong><br>å•æœºå¯ç”¨ï¼Œåˆ†å¸ƒå¼èˆå¼ƒã€‚ï¼ˆå­˜å‚¨å™¨åœºæ™¯ï¼šä¸å˜çš„ä¸šåŠ¡é€»è¾‘ï¼‰</p></li><li><p><strong>æ˜¯å¦ä½¿ç”¨è§†å›¾ï¼Ÿ</strong><br>MySQLå› ä¸ºæ²¡æœ‰ç‰©åŒ–è§†å›¾ï¼Œå› æ­¤è§†å›¾å°½é‡å°‘ç”¨ï¼ˆä¸ç”¨ï¼‰</p></li></ol><h1 id="ç¼“å­˜ä¸æ•°æ®åº“ç»“åˆ"><a href="#ç¼“å­˜ä¸æ•°æ®åº“ç»“åˆ" class="headerlink" title="ç¼“å­˜ä¸æ•°æ®åº“ç»“åˆ"></a>ç¼“å­˜ä¸æ•°æ®åº“ç»“åˆ</h1><h2 id="è¯»å–"><a href="#è¯»å–" class="headerlink" title="è¯»å–"></a>è¯»å–</h2><h3 id="ä¼˜ç¼ºç‚¹"><a href="#ä¼˜ç¼ºç‚¹" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h3><p>ä¼˜ç‚¹ï¼šå¯ä»¥å‡å°‘æ•°æ®åº“è¯»å–è¯·æ±‚<br>ç¼ºç‚¹ï¼šå¢åŠ ä»£ç å¤æ‚åº¦ã€å¢åŠ ç»´æŠ¤éš¾åº¦</p><h3 id="å¦‚ä½•ä½¿ç”¨ï¼Ÿ"><a href="#å¦‚ä½•ä½¿ç”¨ï¼Ÿ" class="headerlink" title="å¦‚ä½•ä½¿ç”¨ï¼Ÿ"></a>å¦‚ä½•ä½¿ç”¨ï¼Ÿ</h3><ul><li>è¯„ä¼°è¿›å…¥ç¼“å­˜çš„æ•°æ®è§„æ¨¡ï¼Œä»¥åŠå‘½ä¸­ç‡ä¼˜åŒ–<sup id="fnref:2"><a href="#fn:2" rel="footnote"><span class="hint--top-right hint--error hint--large" aria-label="å®æ™¯åˆ†æï¼š å‰ç«¯è¯·æ±‚å…ˆè¿æ¥ç¼“å­˜ï¼Œç¼“å­˜æœªå‘½ä¸­è¿æ¥æ•°æ®åº“ï¼Œè¿›è¡ŒæŸ¥è¯¢ï¼Œæœªå‘½ä¸­çŠ¶æ€æ¯”å•çº¯è¿æ¥æ•°æ®åº“æŸ¥è¯¢å¤šäº†ä¸€æ¬¡è¿æ¥å’ŒæŸ¥è¯¢çš„æ“ä½œï¼›å¦‚æœç¼“å­˜å‘½ä¸­ç‡å¾ˆä½ï¼Œåˆ™è¿™ä¸ªé¢å¤–çš„æ“ä½œéä½†ä¸èƒ½æé«˜æŸ¥è¯¢æ•ˆç‡ï¼Œåè€Œä¸ºç³»ç»Ÿå¸¦æ¥äº†é¢å¤–çš„è´Ÿè½½å’Œå¤æ‚æ€§ï¼Œå¾—ä¸å¿å¤±ã€‚">[2]</span></a></sup><ul><li>ä¸æ˜¯æ‰€æœ‰æ•°æ®éƒ½é€‚åˆè¢«ç¼“å­˜ï¼Œä¹Ÿå¹¶ä¸æ˜¯è¿›å…¥äº†ç¼“å­˜å°±æ„å‘³ç€æ•ˆç‡æå‡</li><li>å‘½ä¸­ç‡æ˜¯ç¬¬ä¸€è¦è¯„ä¼°çš„æ•°æ®ï¼›<strong>æ ¸å¿ƒåœ¨äºå¦‚ä½•åˆ¤æ–­å“ªäº›å±äºçƒ­ç‚¹æ•°æ®</strong></li></ul></li><li>å–„äºåˆ©ç”¨å†…å­˜ï¼Œè¯·æ³¨æ„æ•°æ®å­˜å‚¨çš„æ ¼å¼åŠå‹ç¼©ç®—æ³•ã€‚</li></ul><h3 id="å¦‚ä½•ç¡®å®šçƒ­ç‚¹æ•°æ®"><a href="#å¦‚ä½•ç¡®å®šçƒ­ç‚¹æ•°æ®" class="headerlink" title="å¦‚ä½•ç¡®å®šçƒ­ç‚¹æ•°æ®"></a>å¦‚ä½•ç¡®å®šçƒ­ç‚¹æ•°æ®</h3><p>è§<a href="#çƒ­ç‚¹æ•°æ®åˆ†è¡¨">ä¸‹æ–‡</a></p><h2 id="å†™å…¥"><a href="#å†™å…¥" class="headerlink" title="å†™å…¥"></a>å†™å…¥</h2><h3 id="ä¼˜ç¼ºç‚¹-1"><a href="#ä¼˜ç¼ºç‚¹-1" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h3><p>ä¼˜ç‚¹ï¼šå‡å°‘æ•°æ®åº“å†™å…¥<code>i/o</code>å‹åŠ›<br>ç¼ºç‚¹ï¼šæ•°æ®ä¸èƒ½ç¬¬ä¸€æ—¶é—´æŒä¹…åŒ–ï¼Œæœ‰ä¸¢å¤±é£é™©</p><h3 id="å¦‚ä½•ä½¿ç”¨"><a href="#å¦‚ä½•ä½¿ç”¨" class="headerlink" title="å¦‚ä½•ä½¿ç”¨?"></a>å¦‚ä½•ä½¿ç”¨?</h3><p>ç¼“å­˜å®æ—¶æ›´æ–°ï¼Œæ•°æ®åº“å¼‚æ­¥æ›´æ–°ï¼ˆä½¿ç”¨é˜Ÿåˆ—,è¯·æ³¨æ„ä½¿ç”¨<code>increment</code>æ¥ç»´æŒé˜Ÿåˆ—åºå·ï¼‰</p><ul><li>ä¸è¦é€šè¿‡<code>get-&gt;å¤„ç†æ•°æ®-&gt;set-&gt;æ›´æ–°æ•°æ®</code>çš„æ–¹å¼ç»´æŠ¤é˜Ÿåˆ—<sup id="fnref:3"><a href="#fn:3" rel="footnote"><span class="hint--top-right hint--error hint--large" aria-label="èŒƒä¾‹:`$var=Memcache_get($memcon,â€varâ€);$var++;memcache_set($memcon,â€varâ€,$var);`è¿™æ ·ä¸€ä¸ªè„šæœ¬ï¼Œä½¿ç”¨apache abå»è·‘ï¼Œ100ä¸ªå¹¶å‘ï¼Œè·‘10000æ¬¡ï¼Œç„¶åè¾“å‡ºç¼“å­˜å­˜å–çš„æ•°æ®ï¼Œå¾ˆé—æ†¾ï¼Œå¹¶ä¸æ˜¯1000ï¼Œè€Œæ˜¯5000å¤šï¼Œ6000å¤šè¿™æ ·çš„æ•°å­—ï¼Œä¸­é—´çš„æ•°å­—å…¨åœ¨ get & setçš„è¿‡ç¨‹ä¸­ä¸¢æ‰äº†ã€‚åŸå› ï¼šè¯»å†™é—´éš”ä¸­å…¶ä»–å¹¶å‘å†™å…¥ï¼Œå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚">[3]</span></a></sup>ã€‚ ä½¿ç”¨<code>increment</code>å­˜å‚¨é˜Ÿåˆ—ç¼–å·ï¼Œç”¨æ ‡è®°+ç¼–å·ä½œä¸º<code>key</code>å­˜å‚¨é˜Ÿåˆ—å†…å®¹<sup id="fnref:4"><a href="#fn:4" rel="footnote"><span class="hint--top-right hint--error hint--large" aria-label="èŒƒä¾‹2:ç”¨memcache_incrementæ¥åšè¿™ä¸ªæ“ä½œï¼ŒåŒæ ·è·‘æµ‹è¯•ä¼šå¾—åˆ°å®Œæ•´çš„10000ï¼Œä¸€æ¡æ•°æ®ä¸ä¼šä¸¢ã€‚">[4]</span></a></sup>ã€‚</li><li>åå°åŸºäºç¼“å­˜é˜Ÿåˆ—è¯»å–æ›´æ–°æ•°æ®å¹¶æ›´æ–°æ•°æ®åº“<sup id="fnref:5"><a href="#fn:5" rel="footnote"><span class="hint--top-right hint--error hint--large" aria-label="å®æˆ˜èŒƒä¾‹ï¼šæŸè®ºå›çƒ­é—¨è´´ï¼Œå‰ç«¯ä¸æ–­æœ‰views=views+1æ•°æ®æ›´æ–°è¯·æ±‚ã€‚ç¼“å­˜å®æ—¶æ›´æ–°è¯¥çŠ¶æ€åå°ä»»åŠ¡å¯¹æ•°æ®åº“åšå¼‚æ­¥æ›´æ–°æ—¶ï¼Œå‡è®¾æ‰§è¡Œå‘¨æœŸæ˜¯5åˆ†é’Ÿï¼Œé‚£ä¹ˆäº”åˆ†é’Ÿå¯èƒ½ä¼šæ¥æ”¶åˆ°è¿™æ ·çš„è¯·æ±‚å¤šè¾¾æ•°åæ¬¡ä¹ƒè‡³æ•°ç™¾æ¬¡ï¼Œåˆå¹¶æ›´æ–°ååªæ‰§è¡Œä¸€æ¬¡updateå³å¯ã€‚ç±»ä¼¼æ“ä½œè¿˜åŒ…æ‹¬æ¸¸æˆæ‰“æ€ªï¼Œç”Ÿå‘½å’Œç»éªŒçš„å˜åŒ–ï¼›ä¸ªäººä¸»é¡µè®¿é—®æ¬¡æ•°çš„å˜åŒ–ç­‰ã€‚">[5]</span></a></sup><ul><li>åŸºäºé˜Ÿåˆ—è¯»å–åå¯ä»¥åˆå¹¶æ›´æ–°</li><li><strong>æ›´æ–°åˆå¹¶ç‡</strong>æ˜¯é‡è¦æŒ‡æ ‡</li></ul></li></ul><h3 id="å¼‚æ­¥æ›´æ–°é£é™©"><a href="#å¼‚æ­¥æ›´æ–°é£é™©" class="headerlink" title="å¼‚æ­¥æ›´æ–°é£é™©"></a>å¼‚æ­¥æ›´æ–°é£é™©</h3><ul><li><strong>å‰åç«¯åŒæ—¶å†™ï¼Œå¯èƒ½å¯¼è‡´è¦†ç›–é£é™©ã€‚</strong><ul><li>ä½¿ç”¨åç«¯å¼‚æ­¥æ›´æ–°ï¼Œå‰ç«¯åº”ç”¨ç¨‹åºä¸è¦å†™æ•°æ®åº“ï¼Œå¦åˆ™å¯èƒ½é€ æˆå†™å…¥å†²çªã€‚</li><li>ä¸€ç§å…¼å®¹çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œå‰ç«¯å’Œåç«¯ä¸è¦å†™ç›¸åŒçš„å­—æ®µ<sup id="fnref:7"><a href="#fn:7" rel="footnote"><span class="hint--top-right hint--error hint--large" aria-label="å®æˆ˜èŒƒä¾‹ï¼šç”¨æˆ·åœ¨çº¿ä¸Šæ—¶ï¼Œåå°å¼‚æ­¥æ›´æ–°ç”¨æˆ·çŠ¶æ€ã€‚ç®¡ç†å‘˜åå°å±è”½ç”¨æˆ·æ˜¯ç›´æ¥æ›´æ–°æ•°æ®åº“ã€‚ç»“æœç®¡ç†å‘˜å±è”½æŸç”¨æˆ·æ“ä½œå®Œæˆåï¼Œå› è¯¥ç”¨æˆ·åœ¨çº¿æœ‰æ“ä½œï¼Œåå°å¼‚æ­¥æ›´æ–°ç¨‹åºå†æ¬¡åŸºäºç¼“å­˜æ›´æ–°ç”¨æˆ·çŠ¶æ€ï¼Œç”¨æˆ·çŠ¶æ€è¢«å¤æ´»ï¼Œå±è”½å¤±æ•ˆã€‚">[7]</span></a></sup>ã€‚</li></ul></li><li><strong>ç¼“å­˜æ•°æ®ä¸¢å¤±æˆ–æœåŠ¡å´©æºƒå¯èƒ½å¯¼è‡´æ•°æ®ä¸¢å¤±é£é™©ã€‚</strong><ul><li>å¦‚ç¼“å­˜ä¸­é—´å‡ºç°æ•…éšœï¼Œåˆ™ç¼“å­˜é˜Ÿåˆ—æ•°æ®ä¸ä¼šå›å†™åˆ°æ•°æ®åº“ï¼Œè€Œç”¨æˆ·ä¼šè®¤ä¸ºå·²ç»å®Œæˆï¼Œæ­¤æ—¶ä¼šå¸¦æ¥æ¯”è¾ƒæ˜æ˜¾çš„ç”¨æˆ·ä½“éªŒé—®é¢˜ã€‚</li><li>ä¸€ä¸ªä¸å½»åº•çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œç¡®ä¿é«˜å®‰å…¨æ€§ï¼Œé«˜é‡è¦æ€§æ•°æ®å®æ—¶æ•°æ®æ›´æ–°ï¼Œè€Œä½å®‰å…¨æ€§æ•°æ®é€šè¿‡ç¼“å­˜å¼‚æ­¥å›å†™æ–¹å¼å®Œæˆã€‚æ­¤å¤–ï¼Œä½¿ç”¨ç›¸å¯¹æ•°å€¼æ“ä½œè€Œä¸æ˜¯ç»å¯¹æ•°å€¼æ“ä½œæ›´å®‰å…¨<sup id="fnref:8"><a href="#fn:8" rel="footnote"><span class="hint--top-right hint--error hint--large" aria-label="èŒƒä¾‹ï¼šæ”¯ä»˜ä¿¡æ¯ï¼Œé“å…·çš„è´­ä¹°ä¸è·å¾—ï¼Œä¸€æ—¦ä¸¢å¤±ä¼šå¯¹ç”¨æˆ·é€ æˆæå¤§çš„ä¼¤å®³ã€‚è€Œç»éªŒå€¼ï¼Œè®¿é—®æ•°å­—ï¼Œå¦‚æœåªä¸¢å¤±äº†å¾ˆå°‘æ—¶é—´çš„å†…å®¹ï¼Œç”¨æˆ·è¿˜æ˜¯å¯ä»¥å®¹å¿çš„ã€‚">[8]</span></a></sup><sup id="fnref:9"><a href="#fn:9" rel="footnote"><span class="hint--top-right hint--error hint--large" aria-label="èŒƒä¾‹ï¼šå¦‚æœä½¿ç”¨ `Views=Views+â€¦`çš„æ“ä½œï¼Œä¸€æ—¦å‡ºç°æ•°æ®æ ¼å¼é”™è¯¯ï¼Œä»binlogä¸­åæ¨æ˜¯å¯ä»¥è¿›è¡Œæ•°æ®è¿˜åŸï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨Views=ç‰¹å®šå€¼çš„æ“ä½œï¼Œä¸€æ—¦ç¼“å­˜ä¸­æ•°æ®æœ‰é”™è¯¯ï¼Œåˆ™ç›´æ¥è¢«èµ‹äºˆäº†ä¸€ä¸ªé”™è¯¯æ•°æ®ï¼Œæ— æ³•å›æº¯ï¼">[9]</span></a></sup>ã€‚</li></ul></li><li><strong>å¼‚æ­¥æ›´æ–°å¦‚å‡ºç°é˜Ÿåˆ—é˜»å¡å¯èƒ½å¯¼è‡´æ•°æ®ä¸¢å¤±é£é™©ã€‚</strong><ul><li>å¼‚æ­¥æ›´æ–°é€šå¸¸æ˜¯ä½¿ç”¨ç¼“å­˜é˜Ÿåˆ—åï¼Œåœ¨åå°ç”±cronæˆ–å…¶ä»–å®ˆæŠ¤è¿›ç¨‹å†™å…¥æ•°æ®åº“ã€‚</li><li>å¦‚æœé˜Ÿåˆ—ç”Ÿæˆçš„é€Ÿåº¦&gt;åå°æ›´æ–°å†™å…¥æ•°æ®åº“çš„é€Ÿåº¦ï¼Œå°±ä¼šäº§ç”Ÿé˜»å¡ï¼Œå¯¼è‡´æ•°æ®è¶Šç´¯è®¡è¶Šå¤šï¼Œæ•°æ®åº“å“åº”è¿Ÿç¼“ï¼Œè€Œç¼“å­˜é˜Ÿåˆ—æ— æ³•è¿…é€Ÿæ‰§è¡Œï¼Œå¯¼è‡´æº¢å‡ºæˆ–è€…è¿‡æœŸå¤±æ•ˆã€‚</li><li>è§£å†³åŠæ³•ï¼šä½¿ç”¨ MQ é˜Ÿåˆ—äº§å“è€Œä¸ä½¿ç”¨ memcache æ¥è¿›è¡Œç¼“å­˜å¼‚æ­¥æ›´æ–°</li></ul></li></ul><h1 id="åèŒƒå¼è®¾è®¡ï¼ˆå†—ä½™ï¼‰"><a href="#åèŒƒå¼è®¾è®¡ï¼ˆå†—ä½™ï¼‰" class="headerlink" title="åèŒƒå¼è®¾è®¡ï¼ˆå†—ä½™ï¼‰"></a>åèŒƒå¼è®¾è®¡ï¼ˆå†—ä½™ï¼‰</h1><ul><li>é€‚åº¦å†—ä½™å¯ä»¥å‡å°‘æŸ¥è¯¢è¯·æ±‚</li><li>é€‚åº¦å†—ä½™å¯ä»¥è§£å†³åˆ†è¡¨å¸¦æ¥çš„ç´¢å¼•æŸ¥è¯¢é—®é¢˜</li><li>é€‚åº¦å†—ä½™å¯ä»¥è§£å†³ç»Ÿè®¡ç±»è´Ÿè½½è¾ƒé«˜çš„æŸ¥è¯¢é—®é¢˜</li><li>é€‚åº¦å†—ä½™å¯ä»¥å‡å°‘ io è¯·æ±‚é¢‘æ¬¡ï¼Œæé«˜ io æ”¯æ’‘èƒ½åŠ›(cpu æ¢ io)</li></ul><h2 id="åèŒƒå¼è®¾è®¡çš„æ¦‚å¿µ"><a href="#åèŒƒå¼è®¾è®¡çš„æ¦‚å¿µ" class="headerlink" title="åèŒƒå¼è®¾è®¡çš„æ¦‚å¿µ"></a>åèŒƒå¼è®¾è®¡çš„æ¦‚å¿µ</h2><ul><li>æ— å¤–é”®ï¼Œæ— è¿è¡¨æŸ¥è¯¢ï¼Œå¼ºè°ƒç´¢å¼•,å»å…³è”åŒ–</li><li>ä¸è€ƒè™‘è§¦å‘å™¨åŠå…¶ä»–å†…éƒ¨çš„å­˜å‚¨è¿‡ç¨‹</li><li>ä¾¿äºåˆ†å¸ƒå¼è®¾è®¡ï¼Œå…è®¸é€‚åº¦å†—ä½™ï¼Œä¸ºäº†å®¹é‡æ‰©å±•å…è®¸é€‚åº¦å¼€é”€ã€‚</li><li>åŸºäºä¸šåŠ¡è‡ªç”±ä¼˜åŒ–ï¼ŒåŸºäºi/o æˆ–æŸ¥è¯¢è®¾è®¡ï¼Œæ— é¡»éµå¾ªèŒƒå¼ç»“æ„è®¾è®¡ã€‚</li></ul><h2 id="å†—ä½™ç»“æ„è®¾è®¡æ‰€é¢ä¸´çš„å…¸å‹åœºæ™¯"><a href="#å†—ä½™ç»“æ„è®¾è®¡æ‰€é¢ä¸´çš„å…¸å‹åœºæ™¯" class="headerlink" title="å†—ä½™ç»“æ„è®¾è®¡æ‰€é¢ä¸´çš„å…¸å‹åœºæ™¯"></a>å†—ä½™ç»“æ„è®¾è®¡æ‰€é¢ä¸´çš„å…¸å‹åœºæ™¯</h2><ul><li>åŸæœ‰å±•ç°ç¨‹åºæ¶‰åŠå¤šä¸ªè¡¨çš„æŸ¥è¯¢ï¼Œå¸Œæœ›ç²¾ç®€æŸ¥è¯¢ç¨‹åº</li><li>æ•°æ®è¡¨æ‹†åˆ†å¾€å¾€åŸºäºä¸»é”®ï¼Œè€ŒåŸæœ‰æ•°æ®è¡¨å¾€å¾€å­˜åœ¨éåŸºäºä¸»é”®çš„å…³é”®æŸ¥è¯¢ï¼Œæ— æ³•åœ¨åˆ†è¡¨ç»“æ„ä¸­å®Œæˆã€‚</li><li>å­˜åœ¨è¾ƒå¤šæ•°æ®ç»Ÿè®¡éœ€æ±‚ï¼ˆcount, sumç­‰ï¼‰ï¼Œæ•ˆç‡ä½ä¸‹ã€‚</li></ul><h2 id="å†—ä½™é€ æˆçš„é—®é¢˜"><a href="#å†—ä½™é€ æˆçš„é—®é¢˜" class="headerlink" title="å†—ä½™é€ æˆçš„é—®é¢˜"></a>å†—ä½™é€ æˆçš„é—®é¢˜</h2><p>ä¸€è‡´æ€§é—®é¢˜â€“ä¸šåŠ¡å±‚æ ¡éªŒ</p><h2 id="å†—ä½™è®¾è®¡æ–¹æ¡ˆ"><a href="#å†—ä½™è®¾è®¡æ–¹æ¡ˆ" class="headerlink" title="å†—ä½™è®¾è®¡æ–¹æ¡ˆ"></a>å†—ä½™è®¾è®¡æ–¹æ¡ˆ</h2><h3 id="åŸºäºå±•ç°çš„å†—ä½™è®¾è®¡"><a href="#åŸºäºå±•ç°çš„å†—ä½™è®¾è®¡" class="headerlink" title="åŸºäºå±•ç°çš„å†—ä½™è®¾è®¡"></a>åŸºäºå±•ç°çš„å†—ä½™è®¾è®¡</h3><p>å†—ä½™ç‰¹å¾ï¼šå­—æ®µç®€å•ï¼Œæ›´æ”¹åº¦ä¸é«˜<br>ä¸ºäº†ç®€åŒ–å±•ç°ç¨‹åºï¼Œåœ¨ä¸€äº›æ•°æ®è¡¨ä¸­å¾€å¾€å­˜åœ¨å†—ä½™å­—æ®µ<sup id="fnref:13"><a href="#fn:13" rel="footnote"><span class="hint--top-right hint--error hint--large" aria-label="å®æˆ˜èŒƒä¾‹ï¼šè®ºå›æ¿å—çš„å‘å¸–é‡ï¼Œå›å¸–é‡ï¼Œæ¯æ—¥æ–°å¢æ•°æ®ç­‰ã€‚ç½‘ç«™æ¯æ—¥æ–°å¢ç”¨æˆ·æ•°ç­‰ã€‚å‚è§Discuzè®ºå›ç³»ç»Ÿæ•°æ®ç»“æ„ï¼Œæœ‰è¾ƒå¤šç›¸å…³ç»“æ„ã€‚å‚è§å‰æ–‡åˆ†æ®µç§¯åˆ†ç»“æ„ï¼Œæ˜¯å…¸å‹ç”¨äºç»Ÿè®¡çš„å†—ä½™ç»“æ„ã€‚åå°å¯ä»¥é€šè¿‡æºæ•°æ®è¡¨æ›´æ–°è¯¥æ•°å­—ã€‚Redisçš„Zsetç±»å‹å¯ä»¥ç†è§£ä¸ºå­˜åœ¨ä¸€ç§å†—ä½™ç»Ÿè®¡ç»“æ„ã€‚">[13]</span></a></sup></p><h3 id="åŸºäºæŸ¥è¯¢çš„å†—ä½™è®¾è®¡"><a href="#åŸºäºæŸ¥è¯¢çš„å†—ä½™è®¾è®¡" class="headerlink" title="åŸºäºæŸ¥è¯¢çš„å†—ä½™è®¾è®¡"></a>åŸºäºæŸ¥è¯¢çš„å†—ä½™è®¾è®¡</h3><ul><li>æ¶‰åŠåˆ†è¡¨æ“ä½œåï¼Œä¸€äº›å¸¸è§çš„ç´¢å¼•æŸ¥è¯¢å¯èƒ½éœ€è¦è·¨è¡¨ï¼Œå¸¦æ¥ä¸å¿…è¦çš„éº»çƒ¦ã€‚ç¡®è®¤æŸ¥è¯¢è¯·æ±‚è¿œå¤§äºå†™å…¥è¯·æ±‚æ—¶ï¼Œåº”è®¾ç½®ä¾¿äºæŸ¥è¯¢é¡¹çš„å†—ä½™è¡¨ã€‚</li><li>å†—ä½™è¡¨è¦ç‚¹<ul><li>æ•°æ®ä¸€è‡´æ€§ï¼Œç®€å•è¯´ï¼šåŒå¢ï¼ŒåŒåˆ ï¼ŒåŒæ›´æ–°ã€‚</li><li>å¯ä»¥åšå…¨å†—ä½™ï¼Œæˆ–è€…åªåšä¸»é”®å…³è”çš„å†—ä½™ï¼Œæ¯”å¦‚é€šè¿‡ç”¨æˆ·åæŸ¥è¯¢uidï¼Œå†åŸºäºuidæŸ¥è¯¢æºè¡¨ã€‚</li></ul></li></ul><p>å®æˆ˜ç¤ºä¾‹<sup id="fnref:10"><a href="#fn:10" rel="footnote"><span class="hint--top-right hint--error hint--large" aria-label="å®æˆ˜èŒƒä¾‹1: ç”¨æˆ·åˆ†è¡¨å°†ç”¨æˆ·åº“åˆ†æˆè‹¥å¹²æ•°æ®è¡¨;åŸºäºç”¨æˆ·åçš„æŸ¥è¯¢å’ŒåŸºäºuidçš„æŸ¥è¯¢éƒ½æ˜¯é«˜å¹¶å‘è¯·æ±‚ã€‚ç”¨æˆ·åˆ†è¡¨åŸºäºuidåˆ†æˆæ•°æ®è¡¨ï¼ŒåŒæ—¶åŸºäºç”¨æˆ·ååšå¯¹åº”å†—ä½™è¡¨ã€‚å¦‚æœå…è®¸å¤šæ–¹å¼ç™»é™†ï¼Œå¯ä»¥æœ‰å¦‚ä¸‹è®¾è®¡æ–¹æ³•ï¼š`uid,passwd,ç”¨æˆ·ä¿¡æ¯ç­‰ç­‰ï¼Œä¸»æ•°æ®è¡¨ï¼ŒåŸºäºuidåˆ†è¡¨``ukey,ukeytype,uid åŸºäºukeyåˆ†è¡¨ï¼Œä¾¿äºç”¨æˆ·ç™»é™†çš„æŸ¥è¯¢ã€‚åˆ†è§£æˆå¦‚ä¸‹ä¸¤ä¸ªSQL:``select uid from ulist_key_13 where ukey=â€™$usernameâ€™ and ukeytype=â€˜loginâ€™;``select * from ulist_uid_23 where uid=$uid and passwd=â€™$passwdâ€™;``ukeytypeå®šä¹‰ç”¨æˆ·çš„ç™»é™†ä¾æ®ï¼Œæ¯”å¦‚ç”¨æˆ·åï¼Œæ‰‹æœºå·ï¼Œé‚®ä»¶åœ°å€ï¼Œç½‘ç«™æ˜µç§°ç­‰ã€‚ Ukey+ukeytype å¿…é¡»å”¯ä¸€``æ­¤ç§æ–¹å¼éœ€è¦ç™»é™†å¯†ç ç»Ÿä¸€ï¼Œå¯¹äºç¬¬ä¸‰æ–¹connectæ¥å…¥æ¨¡å¼ï¼Œå¯ä»¥é€šè¿‡å¼•ç”³é¢å¤–å­—æ®µå®Œæˆ`">[10]</span></a></sup><sup id="fnref:11"><a href="#fn:11" rel="footnote"><span class="hint--top-right hint--error hint--large" aria-label="å®æˆ˜èŒƒä¾‹2ï¼šç”¨æˆ·æ¸¸æˆç§¯åˆ†æ’åè¡¨ç»“æ„ uid,gameid,score å‚è§å‰æ–‡å®æ—¶ç§¯åˆ†æ’è¡Œã€‚è¡¨å†…å®¹å·¨å¤§ï¼Œéœ€è¦æ‹†è¡¨ã€‚éœ€æ±‚1ï¼šåŸºäºæ¸¸æˆidæŸ¥è¯¢ç§¯åˆ†æ’è¡Œéœ€æ±‚2ï¼šåŸºäºç”¨æˆ·idæŸ¥è¯¢æ¸¸æˆç§¯åˆ†è®°å½•è§£å†³æ–¹æ¡ˆï¼šå»ºç«‹å®Œå…¨ç›¸åŒçš„ä¸¤å¥—è¡¨ç»“æ„ï¼Œå…¶ä¸€ä»¥uidä¸ºæ‹†è¡¨ä¸»é”®ï¼Œå…¶äºŒä»¥gameidä¸ºæ‹†è¡¨ä¸»é”®ï¼Œç”¨æˆ·æäº¤ç§¯åˆ†æ—¶ï¼Œå‘ä¸¤ä¸ªæ•°æ®ç»“æ„åŒæ—¶æäº¤ã€‚">[11]</span></a></sup><sup id="fnref:12"><a href="#fn:12" rel="footnote"><span class="hint--top-right hint--error hint--large" aria-label="å®æˆ˜èŒƒä¾‹3ï¼šå…¨å†—ä½™æŸ¥è¯¢ç»“æ„ä¸»ä¿¡æ¯è¡¨ä»…åŒ…æ‹¬ ä¸»é”®åŠå¤‡æ³¨memoå­—æ®µï¼ˆtextç±»å‹ï¼‰ï¼Œåªæ”¯æŒä¸»é”®æŸ¥è¯¢ï¼Œå¯ä»¥åŸºäºä¸»é”®æ‹†è¡¨ã€‚æ‰€ä»¥éœ€è¦å±•ç°å’Œå­˜å‚¨çš„å†…å®¹å‡åœ¨memoå­—æ®µé‡ä½“ç°ã€‚å¯¹æ¯ä¸€ä¸ªæŸ¥è¯¢æ¡ä»¶ï¼Œå»ºç«‹æŸ¥è¯¢å†—ä½™è¡¨ï¼Œä»¥æŸ¥è¯¢æ¡ä»¶å­—æ®µä¸ºä¸»é”®ï¼Œä»¥ä¸»ä¿¡æ¯è¡¨ä¸»é”®id ä¸ºå†…å®¹ã€‚æ—¥å¸¸æŸ¥è¯¢åªåŸºäºæŸ¥è¯¢å†—ä½™è¡¨ï¼Œç„¶åé€šè¿‡inçš„æ–¹å¼ä»ä¸»ä¿¡æ¯è¡¨è·å¾—å†…å®¹ã€‚ä¼˜ç‚¹æ˜¯ç»“æ„æ‰©å±•éå¸¸æ–¹ä¾¿ï¼Œåªéœ€è¦æ‰©å±•æ–°çš„æŸ¥è¯¢ä¿¡æ¯è¡¨å³å¯ï¼Œæ ¸å¿ƒæ€è·¯æ˜¯ï¼Œåªæœ‰æŸ¥è¯¢æ‰éœ€è¦ç‹¬ç«‹çš„ç´¢å¼•ç»“æ„ï¼Œå±•ç°æ— éœ€ç‹¬ç«‹å­—æ®µã€‚ç¼ºç‚¹æ˜¯åªé€‚åˆäºç›¸å¯¹å›ºå®šçš„æŸ¥è¯¢æ¶æ„ï¼Œå¯¹äºæ›´åŠ çµæ´»çš„ç»„åˆæŸ¥è¯¢æŸæ‰‹æ— ç­–ã€‚">[12]</span></a></sup></p><h3 id="åŸºäºç»Ÿè®¡çš„å†—ä½™ç»“æ„"><a href="#åŸºäºç»Ÿè®¡çš„å†—ä½™ç»“æ„" class="headerlink" title="åŸºäºç»Ÿè®¡çš„å†—ä½™ç»“æ„"></a>åŸºäºç»Ÿè®¡çš„å†—ä½™ç»“æ„</h3><ul><li>ä¸ºäº†å‡å°‘ä¼šæ¶‰åŠå¤§è§„æ¨¡å½±å“ç»“æœé›†çš„è¡¨æ•°æ®æ“ä½œï¼Œæ¯”å¦‚countï¼Œsumæ“ä½œã€‚åº”å°†ä¸€äº›ç»Ÿè®¡ç±»æ•°æ®é€šè¿‡å†—ä½™æ•°æ®ç»“æ„ä¿å­˜ã€‚</li><li>å†—ä½™æ•°æ®ç»“æ„å¯èƒ½ä»¥å­—æ®µæ–¹å¼å­˜åœ¨ï¼Œä¹Ÿå¯èƒ½ä»¥ç‹¬ç«‹æ•°æ®è¡¨ç»“æ„å­˜åœ¨ï¼Œä½†æ˜¯éƒ½åº”èƒ½é€šè¿‡æºæ•°æ®è¡¨æ¢å¤ã€‚</li></ul><p>å®æˆ˜ç¤ºä¾‹<sup id="fnref:13"><a href="#fn:13" rel="footnote"><span class="hint--top-right hint--error hint--large" aria-label="å®æˆ˜èŒƒä¾‹ï¼šè®ºå›æ¿å—çš„å‘å¸–é‡ï¼Œå›å¸–é‡ï¼Œæ¯æ—¥æ–°å¢æ•°æ®ç­‰ã€‚ç½‘ç«™æ¯æ—¥æ–°å¢ç”¨æˆ·æ•°ç­‰ã€‚å‚è§Discuzè®ºå›ç³»ç»Ÿæ•°æ®ç»“æ„ï¼Œæœ‰è¾ƒå¤šç›¸å…³ç»“æ„ã€‚å‚è§å‰æ–‡åˆ†æ®µç§¯åˆ†ç»“æ„ï¼Œæ˜¯å…¸å‹ç”¨äºç»Ÿè®¡çš„å†—ä½™ç»“æ„ã€‚åå°å¯ä»¥é€šè¿‡æºæ•°æ®è¡¨æ›´æ–°è¯¥æ•°å­—ã€‚Redisçš„Zsetç±»å‹å¯ä»¥ç†è§£ä¸ºå­˜åœ¨ä¸€ç§å†—ä½™ç»Ÿè®¡ç»“æ„ã€‚">[13]</span></a></sup></p><h3 id="åŸºäº-io-å‹åŠ›ä¼˜åŒ–çš„å†—ä½™"><a href="#åŸºäº-io-å‹åŠ›ä¼˜åŒ–çš„å†—ä½™" class="headerlink" title="åŸºäº io å‹åŠ›ä¼˜åŒ–çš„å†—ä½™"></a>åŸºäº io å‹åŠ›ä¼˜åŒ–çš„å†—ä½™</h3><p><strong>ç°è±¡ï¼š</strong></p><p>å•æ¬¡è¯·æ±‚å¤šæ¬¡å†™å…¥çš„æƒ…å†µ</p><ul><li>è¯·æ±‚é¢‘æ¬¡è¾ƒé«˜ï¼Œio å‹åŠ›è¾ƒå¤§</li><li>å­˜åœ¨é«˜é¢‘è¯»å–è¯·æ±‚ï¼Œæ•°æ®å¯é æ€§è¦æ±‚é«˜</li></ul><p><strong>å¯ç”¨æ–¹æ¡ˆ:</strong></p><ul><li>æ•°æ®å‹ç¼©å­˜å‚¨</li><li>å†™å…¥ç¼“å­˜é˜Ÿåˆ—</li><li>é€šè¿‡å†—ä½™ç»“æ„ï¼Œåˆå¹¶ä¸ºä¸€æ¬¡å†™å…¥<sup id="fnref:14"><a href="#fn:14" rel="footnote"><span class="hint--top-right hint--error hint--large" aria-label="æ¸¸æˆç»„é˜Ÿï¼Œ5ä¸ªæ­¦å°†ã€‚ï¼ˆå»ºç«‹ä¸´æ—¶çš„æ­¦å°†è¡¨ï¼Œå®šæ—¶æ›´æ–°åˆ°ä¸»è¡¨ï¼‰">[14]</span></a></sup><sup id="fnref:15"><a href="#fn:15" rel="footnote"><span class="hint--top-right hint--error hint--large" aria-label="å®æ—¶ç»Ÿè®¡">[15]</span></a></sup></li></ul><h3 id="å†å²æ•°æ®è¡¨"><a href="#å†å²æ•°æ®è¡¨" class="headerlink" title="å†å²æ•°æ®è¡¨"></a>å†å²æ•°æ®è¡¨</h3><p>å†å²æ•°æ®è¡¨å¯¹åº”äºçƒ­ç‚¹æ•°æ®è¡¨ï¼Œå°†éœ€æ±‚è¾ƒå°‘åˆä¸èƒ½ä¸¢å¼ƒçš„æ•°æ®å­˜å…¥ï¼Œä»…åœ¨å°‘æ•°æƒ…å†µä¸‹è¢«è®¿é—®ã€‚</p><h1 id="ä¸»ä»æ¶æ„"><a href="#ä¸»ä»æ¶æ„" class="headerlink" title="ä¸»ä»æ¶æ„"></a>ä¸»ä»æ¶æ„</h1><h2 id="åŸºæœ¬è®¤è¯†"><a href="#åŸºæœ¬è®¤è¯†" class="headerlink" title="åŸºæœ¬è®¤è¯†"></a>åŸºæœ¬è®¤è¯†</h2><ul><li>è¯»å†™åˆ†ç¦»å¯¹è´Ÿè½½çš„å‡è½»è¿œè¿œä¸å¦‚åˆ†åº“åˆ†è¡¨æ¥çš„ç›´æ¥ã€‚</li><li>å†™å‹åŠ›ä¼šä¼ é€’ç»™ä»è¡¨ï¼Œåªè¯»ä»åº“ä¸€æ ·æœ‰å†™å‹åŠ›ï¼Œä¸€æ ·ä¼šäº§ç”Ÿè¯»å†™é”ï¼</li><li>ä¸€ä¸»å¤šä»ç»“æ„ä¸‹ï¼Œä¸»åº“æ˜¯å•ç‚¹éšæ‚£ï¼Œå¾ˆéš¾è§£å†³ï¼ˆå¦‚ä¸»åº“å½“æœºï¼Œä»åº“å¯ä»¥å“åº”è¯»å†™ï¼Œä½†æ˜¯æ— æ³•è‡ªåŠ¨æ‹…å½“ä¸»åº“çš„åˆ†å‘åŠŸèƒ½ï¼‰</li><li>ä¸»ä»å»¶è¿Ÿä¹Ÿæ˜¯é‡å¤§é—®é¢˜ã€‚ä¸€æ—¦æœ‰è¾ƒå¤§å†™å…¥é—®é¢˜ï¼Œå¦‚è¡¨ç»“æ„æ›´æ–°ï¼Œä¸»ä»ä¼šäº§ç”Ÿå·¨å¤§å»¶è¿Ÿã€‚</li></ul><h2 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h2><p>éƒ¨ç½²ç®€å•</p><h2 id="å±€é™æ€§"><a href="#å±€é™æ€§" class="headerlink" title="å±€é™æ€§"></a>å±€é™æ€§</h2><ul><li>io å‹åŠ›æ— æ³•åˆ†å¸ƒï¼Œæ€§ä»·æ¯”ä¸é«˜ï¼ˆä¸»æ˜¯å¤šçº¿ç¨‹å†™ï¼Œä»æ˜¯å•çº¿ç¨‹å†™ï¼›åˆ†æ‹…è¯»å‹åŠ›ï¼Œä¸èƒ½åˆ†æ‹…å†™å‹åŠ›ï¼‰</li><li>åŒæ­¥å»¶æ—¶é¿å…ä¸äº†</li><li>ä¸€ä¸»å¤šä»ï¼Œä¸»åº“å•ç‚¹ï¼Œå¾ˆéš¾è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼ˆä¸€ä»è½¬ä¸»ï¼Œå…¶ä»–ä»ä¸èƒ½è‡ªåŠ¨å…³è”åˆ°è¿™ä¸ªæ–°ä¸»ï¼‰</li></ul><h2 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h2><p>ä¸€ä¸»ä¸€ä»</p><ul><li>åœ¨çº¿çƒ­å¤‡</li><li>å¼‚åœ°åˆ†å¸ƒ<ul><li>å†™åˆ†å¸ƒï¼Œè¯»ç»Ÿä¸€ã€‚</li><li>ä»ç„¶å›°éš¾é‡é‡ï¼Œå—é™äºç½‘ç»œç¯å¢ƒé—®é¢˜å·¨å¤šï¼</li></ul></li><li>è‡ªåŠ¨éšœç¢è½¬ç§»<ul><li>ä¸»å´©æºƒï¼Œä»è‡ªåŠ¨æ¥ç®¡</li></ul></li><li>ä¸ªäººå»ºè®®ï¼Œè´Ÿè½½å‡è¡¡ä¸»è¦ä½¿ç”¨åˆ†åº“æ–¹æ¡ˆï¼Œä¸»ä»ä¸»è¦ç”¨äºçƒ­å¤‡å’Œéšœç¢è½¬ç§»ã€‚</li></ul><h2 id="æ½œåœ¨ä¼˜åŒ–ç‚¹"><a href="#æ½œåœ¨ä¼˜åŒ–ç‚¹" class="headerlink" title="æ½œåœ¨ä¼˜åŒ–ç‚¹"></a>æ½œåœ¨ä¼˜åŒ–ç‚¹</h2><p>ä¸ºäº†å‡å°‘å†™å‹åŠ›ï¼Œæœ‰äº›äººå»ºè®®ä¸»ä¸å»ºç´¢å¼•æå‡i/oæ€§èƒ½ï¼Œä»å»ºç«‹ç´¢å¼•æ»¡è¶³æŸ¥è¯¢è¦æ±‚ã€‚ä¸ªäººè®¤ä¸ºè¿™æ ·ç»´æŠ¤è¾ƒä¸ºéº»çƒ¦ã€‚è€Œä¸”ä»æœ¬èº«ä¼šç»§æ‰¿ä¸»çš„i/oå‹åŠ›ï¼Œå› æ­¤ä¼˜åŒ–ä»·å€¼æœ‰é™ã€‚è¯¥æ€è·¯ç‰¹æ­¤åˆ†äº«ï¼Œä¸åšæ¨è(caozè§‚ç‚¹)ã€‚</p><h1 id="åˆ†å¸ƒå¼è®¾è®¡"><a href="#åˆ†å¸ƒå¼è®¾è®¡" class="headerlink" title="åˆ†å¸ƒå¼è®¾è®¡"></a>åˆ†å¸ƒå¼è®¾è®¡</h1><ul><li>è®¾è®¡åˆ†å¸ƒå¼ä¹‹å‰ï¼Œå…ˆä¼˜åŒ–å•æœºï¼š</li><li>å•æœºè¯» qps å‡ åƒå¾ˆå®¹æ˜“</li><li>å•æœºå†™ qps å‡ åƒå¾ˆå®¹æ˜“</li><li>æ•°æ®é‡æœ€å°‘åœ¨3000ä¸‡ä»¥ä¸Šï¼ˆå…·ä½“ä¸šåŠ¡å…·ä½“åˆ†æï¼‰</li></ul><h2 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><h3 id="é˜²æ­¢å•ç‚¹éšæ‚£"><a href="#é˜²æ­¢å•ç‚¹éšæ‚£" class="headerlink" title="é˜²æ­¢å•ç‚¹éšæ‚£"></a>é˜²æ­¢å•ç‚¹éšæ‚£</h3><p><strong>lvs nginxï¼ˆè½®è¯¢ï¼Œè‡ªåŠ¨åˆ‡æ¢ï¼‰</strong></p><ul><li>æ‰€è°“å•ç‚¹éšæ‚£ï¼Œå°±æ˜¯æŸå°è®¾å¤‡å‡ºç°æ•…éšœï¼Œä¼šå¯¼è‡´æ•´ä½“ç³»ç»Ÿçš„ä¸å¯ç”¨ï¼Œè¿™ä¸ªè®¾å¤‡å°±æ˜¯å•ç‚¹éšæ‚£ã€‚</li><li>ç†è§£è¿å¸¦æ•ˆåº”ï¼Œæ‰€è°“è¿å¸¦æ•ˆåº”ï¼Œå°±æ˜¯ä¸€ç§é—®é¢˜ä¼šå¼•å‘å¦ä¸€ç§æ•…éšœï¼Œä¸¾ä¾‹è€Œè¨€ï¼Œmemcache+mysqlæ˜¯ä¸€ç§å¸¸è§ç¼“å­˜ç»„åˆï¼Œåœ¨å‰ç«¯å‹åŠ›å¾ˆå¤§æ—¶ï¼Œå¦‚æœmemcacheå´©æºƒï¼Œç†è®ºä¸Šæ•°æ®ä¼šé€šè¿‡mysqlè¯»å–ï¼Œä¸å­˜åœ¨ç³»ç»Ÿä¸å¯ç”¨æƒ…å†µï¼Œä½†æ˜¯mysqlæ— æ³•å¯¹æŠ—å¦‚æ­¤å¤§çš„å‹åŠ›å†²å‡»ï¼Œä¼šå› æ­¤è¿å¸¦å´©æºƒã€‚å› Aç³»ç»Ÿé—®é¢˜å¯¼è‡´Bç³»ç»Ÿå´©æºƒçš„è¿å¸¦é—®é¢˜ï¼Œåœ¨è¿ç»´è¿‡ç¨‹ä¸­ä¼šé¢‘ç¹å‡ºç°ã€‚<sup id="fnref:16"><a href="#fn:16" rel="footnote"><span class="hint--top-right hint--error hint--large" aria-label="å®æˆ˜èŒƒä¾‹ï¼š åœ¨mysqlè¿æ¥ä¸åŠæ—¶é‡Šæ”¾çš„åº”ç”¨ç¯å¢ƒé‡Œï¼Œå½“ç½‘ç»œç¯å¢ƒå¼‚å¸¸ï¼ˆåŒæœºæˆ¿å‹é‚»æœåŠ¡å™¨é­å—æ‹’ç»æœåŠ¡æ”»å‡»ï¼Œå‡ºå£é˜»å¡ï¼‰ï¼Œç½‘ç»œå»¶è¿ŸåŠ å‰§ï¼Œç©ºè¿æ¥æ•°æ€¥å‰§å¢åŠ ï¼Œå¯¼è‡´æ•°æ®åº“è¿æ¥è¿‡å¤šå´©æºƒã€‚">[16]</span></a></sup><sup id="fnref:17"><a href="#fn:17" rel="footnote"><span class="hint--top-right hint--error hint--large" aria-label="å®æˆ˜èŒƒä¾‹ï¼šå‰ç«¯ä»£ç  é€šå¸¸æˆ‘ä»¬å°è£… mysql_connectå’Œmemcache_connectï¼ŒäºŒè€…çš„é¡ºåºä¸åŒï¼Œä¼šäº§ç”Ÿä¸åŒçš„è¿å¸¦æ•ˆåº”ã€‚å¦‚æœmysql_connectåœ¨å‰ï¼Œé‚£ä¹ˆä¸€æ—¦memcacheè¿æ¥é˜»å¡ï¼Œä¼šè¿å¸¦mysqlç©ºè¿æ¥è¿‡å¤šå´©æºƒã€‚">[17]</span></a></sup><ul><li>è¿å¸¦æ•ˆåº”æ˜¯å¸¸è§çš„ç³»ç»Ÿå´©æºƒï¼Œæ—¥å¸¸åˆ†æå´©æºƒåŸå› çš„æ—¶å€™éœ€è¦è®¤çœŸè€ƒè™‘è¿å¸¦æ•ˆåº”çš„å½±å“ï¼Œå¤´ç–¼åŒ»å¤´ï¼Œè„šç–¼åŒ»è„šæ˜¯ä¸è¡Œçš„ã€‚</li></ul></li></ul><h3 id="æ–¹ä¾¿ç³»ç»Ÿæ‰©å®¹"><a href="#æ–¹ä¾¿ç³»ç»Ÿæ‰©å®¹" class="headerlink" title="æ–¹ä¾¿ç³»ç»Ÿæ‰©å®¹"></a>æ–¹ä¾¿ç³»ç»Ÿæ‰©å®¹</h3><ul><li>æ•°æ®å®¹é‡å¢åŠ åï¼Œè¦è€ƒè™‘èƒ½å¤Ÿå°†æ•°æ®åˆ†å¸ƒåˆ°ä¸åŒçš„æœåŠ¡å™¨ä¸Šã€‚</li><li>è¯·æ±‚å‹åŠ›å¢åŠ æ—¶ï¼Œè¦è€ƒè™‘å°†è¯·æ±‚å‹åŠ›åˆ†å¸ƒåˆ°ä¸åŒæœåŠ¡å™¨ä¸Šã€‚</li><li>æ‰©å®¹è®¾è®¡æ—¶éœ€è¦è€ƒè™‘é˜²æ­¢å•ç‚¹éšæ‚£ã€‚</li></ul><h3 id="å®‰å…¨å¯æ§ï¼Œæˆæœ¬å¯æ§"><a href="#å®‰å…¨å¯æ§ï¼Œæˆæœ¬å¯æ§" class="headerlink" title="å®‰å…¨å¯æ§ï¼Œæˆæœ¬å¯æ§"></a>å®‰å…¨å¯æ§ï¼Œæˆæœ¬å¯æ§</h3><ul><li>æ•°æ®å®‰å…¨ï¼Œä¸šåŠ¡å®‰å…¨</li><li>äººåŠ›èµ„æºæˆæœ¬ &gt; å¸¦å®½æµé‡æˆæœ¬ &gt; ç¡¬ä»¶æˆæœ¬<ul><li>æˆæœ¬ä¸æµé‡çš„å…³ç³»æ›²çº¿åº”ä½äºçº¿æ€§å¢é•¿ï¼ˆæµé‡ä¸ºæ¨ªè½´ï¼Œæˆæœ¬ä¸ºçºµè½´ï¼‰ã€‚</li><li>è§„æ¨¡ä¼˜åŠ¿</li></ul></li></ul><h2 id="åˆ†åº“-amp-åˆ†è¡¨"><a href="#åˆ†åº“-amp-åˆ†è¡¨" class="headerlink" title="åˆ†åº“&amp;åˆ†è¡¨"></a>åˆ†åº“&amp;åˆ†è¡¨</h2><h3 id="ä¼˜ç‚¹-1"><a href="#ä¼˜ç‚¹-1" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul><li>è´Ÿè½½åˆ†æ‹…è¾ƒå¥½</li><li>ä¸å­˜åœ¨åŒæ­¥å»¶è¿Ÿ</li><li>æ‹†åˆ†æ–¹æ³•çµæ´»</li></ul><h3 id="å±€é™æ€§-1"><a href="#å±€é™æ€§-1" class="headerlink" title="å±€é™æ€§"></a>å±€é™æ€§</h3><ul><li>éœ€è¦æœ‰å¤‡ä»½å’Œè‡ªåŠ¨æ•…éšœè½¬ç§»çš„æ–¹æ¡ˆ</li><li>éœ€è¦åº”ç”¨ç«¯é…åˆï¼Œæ— æ³•å®Œå…¨æ»¡è¶³å…³è”æŸ¥è¯¢çš„éœ€æ±‚</li></ul><h3 id="æ¨èæ–¹æ¡ˆ"><a href="#æ¨èæ–¹æ¡ˆ" class="headerlink" title="æ¨èæ–¹æ¡ˆ"></a>æ¨èæ–¹æ¡ˆ</h3><ul><li>ä»¥åˆ†åº“ã€åˆ†è¡¨ä¸ºè´Ÿè½½å’Œæ•°æ®æ”¯æ’‘æ–¹æ¡ˆ</li><li>ä»¥ä¸»ä»ç»“æ„ä¸ºçƒ­å¤‡å’Œæ•…éšœè½¬ç§»æ–¹æ¡ˆ</li><li>ä½¿ç”¨ä¸­é—´ä»¶ä½œä¸ºåˆ†å¸ƒå¼æ•°æ®åº“çš„å‰ç«¯ï¼ˆamoebaï¼Œè¦å»å…³è”åŒ–ï¼‰</li><li>æ•°æ®ä¸€è‡´æ€§é—®é¢˜è§£å†³<ul><li>å‰ç«¯æ ¡éªŒ</li><li>åç«¯ cron å®šæ—¶è·‘æ•°æ®</li></ul></li></ul><h3 id="åŸºæœ¬è®¤è¯†-1"><a href="#åŸºæœ¬è®¤è¯†-1" class="headerlink" title="åŸºæœ¬è®¤è¯†"></a>åŸºæœ¬è®¤è¯†</h3><ul><li>ç”¨åˆ†åº“&amp;æ‹†è¡¨æ˜¯è§£å†³æ•°æ®åº“å®¹é‡é—®é¢˜çš„å”¯ä¸€é€”å¾„ã€‚</li><li>åˆ†åº“&amp;æ‹†è¡¨ä¹Ÿæ˜¯è§£å†³æ€§èƒ½å‹åŠ›çš„æœ€ä¼˜é€‰æ‹©ã€‚</li><li>åˆ†åº“ â€“ ä¸åŒçš„æ•°æ®è¡¨æ”¾åˆ°ä¸åŒçš„æ•°æ®åº“æœåŠ¡å™¨ä¸­ï¼ˆä¹Ÿå¯èƒ½æ˜¯è™šæ‹ŸæœåŠ¡å™¨ï¼‰</li><li>æ‹†è¡¨ â€“ ä¸€å¼ æ•°æ®è¡¨æ‹†æˆå¤šå¼ æ•°æ®è¡¨ï¼Œå¯èƒ½ä½äºåŒä¸€å°æœåŠ¡å™¨ï¼Œä¹Ÿå¯èƒ½ä½äºå¤šå°æœåŠ¡å™¨ï¼ˆå«è™šæ‹ŸæœåŠ¡å™¨ï¼‰ã€‚</li></ul><h3 id="å»å…³è”åŒ–åŸåˆ™"><a href="#å»å…³è”åŒ–åŸåˆ™" class="headerlink" title="å»å…³è”åŒ–åŸåˆ™"></a>å»å…³è”åŒ–åŸåˆ™</h3><ul><li>æ‘˜é™¤æ•°æ®è¡¨ä¹‹é—´çš„å…³è”ï¼Œæ˜¯åˆ†åº“çš„åŸºç¡€å·¥ä½œã€‚</li><li>æ‘˜é™¤å…³è”çš„ç›®çš„æ˜¯ï¼Œå½“æ•°æ®è¡¨åˆ†å¸ƒåˆ°ä¸åŒæœåŠ¡å™¨æ—¶ï¼ŒæŸ¥è¯¢è¯·æ±‚å®¹æ˜“åˆ†å‘å’Œå¤„ç†ã€‚</li><li>å­¦ä¼šç†è§£åèŒƒå¼æ•°æ®ç»“æ„è®¾è®¡ï¼Œæ‰€è°“åèŒƒå¼ï¼Œç¬¬ä¸€è¦ç‚¹æ˜¯ä¸ç”¨å¤–é”®ï¼Œä¸å…è®¸Joinæ“ä½œï¼Œä¸å…è®¸ä»»ä½•éœ€è¦è·¨è¶Šä¸¤ä¸ªè¡¨çš„æŸ¥è¯¢è¯·æ±‚ã€‚ç¬¬äºŒè¦ç‚¹æ˜¯é€‚åº¦å†—ä½™å‡å°‘æŸ¥è¯¢è¯·æ±‚<sup id="fnref:18"><a href="#fn:18" rel="footnote"><span class="hint--top-right hint--error hint--large" aria-label="æ¯”å¦‚è¯´ï¼Œä¿¡æ¯è¡¨ï¼Œfromuid, touid, messageå­—æ®µå¤–ï¼Œè¿˜éœ€è¦ä¸€ä¸ªfromunameå­—æ®µè®°å½•ç”¨æˆ·åï¼Œè¿™æ ·æŸ¥è¯¢è€…é€šè¿‡touidæŸ¥è¯¢åï¼Œèƒ½å¤Ÿç«‹å³å¾—åˆ°å‘ä¿¡äººçš„ç”¨æˆ·åï¼Œè€Œæ— éœ€è¿›è¡Œå¦ä¸€ä¸ªæ•°æ®è¡¨çš„æŸ¥è¯¢ã€‚">[18]</span></a></sup></li><li>å»å…³è”åŒ–å¤„ç†ä¼šå¸¦æ¥é¢å¤–çš„è€ƒè™‘ï¼Œæ¯”å¦‚è¯´ï¼ŒæŸä¸€ä¸ªæ•°æ®è¡¨å†…å®¹çš„ä¿®æ”¹ï¼Œå¯¹å¦ä¸€ä¸ªæ•°æ®è¡¨çš„å½±å“ã€‚è¿™ä¸€ç‚¹éœ€è¦åœ¨ç¨‹åºæˆ–å…¶ä»–é€”å¾„å»è€ƒè™‘ã€‚</li></ul><h3 id="åˆ†åº“æ–¹æ¡ˆ"><a href="#åˆ†åº“æ–¹æ¡ˆ" class="headerlink" title="åˆ†åº“æ–¹æ¡ˆ"></a>åˆ†åº“æ–¹æ¡ˆ</h3><h4 id="å®‰å…¨æ€§æ‹†åˆ†"><a href="#å®‰å…¨æ€§æ‹†åˆ†" class="headerlink" title="å®‰å…¨æ€§æ‹†åˆ†"></a>å®‰å…¨æ€§æ‹†åˆ†</h4><p>è¿ç»´ä¼˜åŒ–ï¼Œæ˜“äºç®¡ç†</p><ul><li>å°†é«˜å®‰å…¨æ€§æ•°æ®ä¸ä½å®‰å…¨æ€§æ•°æ®åˆ†åº“ï¼Œè¿™æ ·çš„å¥½å¤„ç¬¬ä¸€æ˜¯ä¾¿äºç»´æŠ¤ï¼Œç¬¬äºŒæ˜¯é«˜å®‰å…¨æ€§æ•°æ®çš„æ•°æ®åº“å‚æ•°é…ç½®å¯ä»¥ä»¥å®‰å…¨ä¼˜å…ˆï¼Œè€Œä½å®‰å…¨æ€§æ•°æ®çš„å‚æ•°é…ç½®ä»¥æ€§èƒ½ä¼˜å…ˆã€‚å‚è§è¿ç»´ä¼˜åŒ–ç›¸å…³éƒ¨åˆ†ã€‚</li><li>å®‰å…¨æ€§å¼€å¯å‚æ•°ï¼šsync_binlogï¼Œinnodb_flush_log_at_trx_commit = 2(ä¸¢å¤±æœ€å1s æ•°æ®);å¼€å¯åæ€§èƒ½ä¸‹é™10~100å€</li></ul><h4 id="åŸºäºä¸šåŠ¡é€»è¾‘æ‹†åˆ†"><a href="#åŸºäºä¸šåŠ¡é€»è¾‘æ‹†åˆ†" class="headerlink" title="åŸºäºä¸šåŠ¡é€»è¾‘æ‹†åˆ†"></a>åŸºäºä¸šåŠ¡é€»è¾‘æ‹†åˆ†</h4><p>æ˜“äºç®¡ç†ï¼Œå¯¹åº”ç”¨ç«¯å‹å¥½ï¼Œè´Ÿè½½ä¸èƒ½å‡åˆ†</p><ul><li>æ ¹æ®æ•°æ®è¡¨çš„å†…å®¹æ„æˆï¼Œä¸šåŠ¡é€»è¾‘æ‹†åˆ†ï¼Œä¾¿äºæ—¥å¸¸ç»´æŠ¤å’Œå‰ç«¯è°ƒç”¨ã€‚</li><li>åŸºäºä¸šåŠ¡é€»è¾‘æ‹†åˆ†ï¼Œå¯ä»¥å‡å°‘å‰ç«¯åº”ç”¨è¯·æ±‚å‘é€åˆ°ä¸åŒæ•°æ®åº“æœåŠ¡å™¨çš„é¢‘æ¬¡ï¼Œä»è€Œå‡å°‘é“¾æ¥å¼€é”€ã€‚</li><li>åŸºäºä¸šåŠ¡é€»è¾‘æ‹†åˆ†ï¼Œå¯ä¿ç•™éƒ¨åˆ†æ•°æ®å…³è”ï¼Œå‰ç«¯webå·¥ç¨‹å¸ˆå¯åœ¨é™åº¦èŒƒå›´å†…æ‰§è¡Œå…³è”æŸ¥è¯¢ã€‚</li></ul><h4 id="åŸºäºè´Ÿè½½å‹åŠ›æ‹†åˆ†"><a href="#åŸºäºè´Ÿè½½å‹åŠ›æ‹†åˆ†" class="headerlink" title="åŸºäºè´Ÿè½½å‹åŠ›æ‹†åˆ†"></a>åŸºäºè´Ÿè½½å‹åŠ›æ‹†åˆ†</h4><p>è´Ÿè½½ç›¸å¯¹å¯ä»¥å‡æ‘Šï¼›ç®¡ç†ä¸æ–¹ä¾¿</p><ul><li>åŸºäºè´Ÿè½½å‹åŠ›å¯¹æ•°æ®ç»“æ„æ‹†åˆ†ï¼Œä¾¿äºç›´æ¥å°†è´Ÿè½½åˆ†æ‹…ç»™ä¸åŒçš„æœåŠ¡å™¨ã€‚</li><li>åŸºäºè´Ÿè½½å‹åŠ›æ‹†åˆ†ï¼Œå¯èƒ½æ‹†åˆ†åçš„æ•°æ®åº“åŒ…å«ä¸åŒä¸šåŠ¡ç±»å‹çš„æ•°æ®è¡¨ï¼Œæ—¥å¸¸ç»´æŠ¤ä¼šæœ‰ä¸€å®šçš„çƒ¦æ¼ã€‚</li></ul><h4 id="æ··åˆæ‹†åˆ†ç»„åˆ"><a href="#æ··åˆæ‹†åˆ†ç»„åˆ" class="headerlink" title="æ··åˆæ‹†åˆ†ç»„åˆ"></a>æ··åˆæ‹†åˆ†ç»„åˆ</h4><ul><li>åŸºäºå®‰å…¨ä¸ä¸šåŠ¡æ‹†åˆ†ä¸ºæ•°æ®åº“å®ä¾‹ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨ä¸åŒç«¯å£æ”¾åœ¨åŒä¸€ä¸ªæœåŠ¡å™¨ä¸Šã€‚</li><li>åŸºäºè´Ÿè½½å¯ä»¥æ‹†åˆ†ä¸ºæ›´å¤šæ•°æ®åº“å®ä¾‹åˆ†å¸ƒåœ¨ä¸åŒæ•°æ®åº“ä¸Š</li></ul><p>ä¾‹å¦‚:</p><ul><li>åŸºäºå®‰å…¨æ‹†åˆ†å‡ºAæ•°æ®åº“å®ä¾‹ï¼Œ</li><li>åŸºäºä¸šåŠ¡æ‹†åˆ†å‡ºB,Cæ•°æ®åº“å®ä¾‹ï¼Œ</li><li>Cæ•°æ®åº“å­˜åœ¨è¾ƒé«˜è´Ÿè½½ï¼ŒåŸºäºè´Ÿè½½æ‹†åˆ†ä¸ºC1,C2,C3,C4ç­‰ å®ä¾‹ã€‚</li><li>æ•°æ®åº“æœåŠ¡å™¨å®Œå…¨å¯ä»¥åšåˆ° A+B+C1ä¸ºä¸€å°ï¼ŒC2,C3,C4å„å•ç‹¬ä¸€å°ã€‚</li></ul><h3 id="åˆ†è¡¨æ–¹æ¡ˆ"><a href="#åˆ†è¡¨æ–¹æ¡ˆ" class="headerlink" title="åˆ†è¡¨æ–¹æ¡ˆ"></a>åˆ†è¡¨æ–¹æ¡ˆ</h3><p>æ•°æ®é‡è¿‡å¤§æˆ–è€…è®¿é—®å‹åŠ›è¿‡å¤§çš„æ•°æ®è¡¨éœ€è¦åˆ‡åˆ†</p><h4 id="çºµå‘åˆ†è¡¨ï¼ˆå¸¸è§ä¸ºå¿™é—²åˆ†è¡¨ï¼‰"><a href="#çºµå‘åˆ†è¡¨ï¼ˆå¸¸è§ä¸ºå¿™é—²åˆ†è¡¨ï¼‰" class="headerlink" title="çºµå‘åˆ†è¡¨ï¼ˆå¸¸è§ä¸ºå¿™é—²åˆ†è¡¨ï¼‰"></a>çºµå‘åˆ†è¡¨ï¼ˆå¸¸è§ä¸ºå¿™é—²åˆ†è¡¨ï¼‰</h4><ul><li>å•æ•°æ®è¡¨å­—æ®µè¿‡å¤šï¼Œå¯å°†é¢‘ç¹æ›´æ–°çš„æ•´æ•°æ•°æ®ä¸éé¢‘ç¹æ›´æ–°çš„å­—ç¬¦ä¸²æ•°æ®åˆ‡åˆ†<sup id="fnref:19"><a href="#fn:19" rel="footnote"><span class="hint--top-right hint--error hint--large" aria-label="èŒƒä¾‹: userè¡¨ ï¼Œä¸ªäººç®€ä»‹ï¼Œåœ°å€ï¼ŒQQå·ï¼Œè”ç³»æ–¹å¼ï¼Œå¤´åƒ è¿™äº›å­—æ®µä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œæ›´æ–°è¯·æ±‚å°‘ï¼› æœ€åç™»å½•æ—¶é—´ï¼Œåœ¨çº¿æ—¶å¸¸ï¼Œè®¿é—®æ¬¡æ•°ï¼Œä¿¡ä»¶æ•°è¿™äº›å­—æ®µä¸ºæ•´æ•°å‹å­—æ®µï¼Œæ›´æ–°é¢‘ç¹ï¼Œå¯ä»¥å°†åé¢è¿™äº›æ›´æ–°é¢‘ç¹çš„å­—æ®µç‹¬ç«‹æ‹†å‡ºä¸€å¼ æ•°æ®è¡¨ï¼Œè¡¨å†…å®¹å˜å°‘ï¼Œç´¢å¼•ç»“æ„å˜å°‘ï¼Œè¯»å†™è¯·æ±‚å˜å¿«ã€‚">[19]</span></a></sup></li><li>è¿‡äºé¢‘ç¹çš„ï¼Œä½¿ç”¨ nosqlï¼ˆmemcachedï¼Œredis ç­‰ï¼‰</li></ul><h4 id="æ¨ªå‘åˆ‡è¡¨"><a href="#æ¨ªå‘åˆ‡è¡¨" class="headerlink" title="æ¨ªå‘åˆ‡è¡¨"></a>æ¨ªå‘åˆ‡è¡¨</h4><ul><li>ç­‰åˆ†åˆ‡è¡¨ï¼Œå¦‚å“ˆå¸Œåˆ‡è¡¨æˆ–å…¶ä»–åŸºäºå¯¹æŸæ•°å­—å–ä½™çš„åˆ‡è¡¨ã€‚ç­‰åˆ†åˆ‡è¡¨çš„ä¼˜ç‚¹æ˜¯è´Ÿè½½å‡åˆ†ï¼›ç¼ºç‚¹æ˜¯å½“å®¹é‡ç»§ç»­å¢åŠ æ—¶æ— æ³•æ–¹ä¾¿çš„æ‰©å®¹ï¼Œéœ€è¦é‡æ–°è¿›è¡Œæ•°æ®çš„åˆ‡åˆ†æˆ–è½¬è¡¨ã€‚è€Œä¸”ä¸€äº›å…³é”®ä¸»é”®ä¸æ˜“å¤„ç†ã€‚ï¼ˆåªèƒ½åŸºäºå·®å­˜æ¡ä»¶è¿›è¡Œæ‹†åˆ†ï¼Œå¦åˆ™æ²¡æ³•æŸ¥è¯¢ï¼‰</li><li>é€’å¢åˆ‡è¡¨ï¼Œæ¯”å¦‚æ¯1kwç”¨æˆ·å¼€ä¸€ä¸ªæ–°è¡¨ï¼Œä¼˜ç‚¹æ˜¯å¯ä»¥é€‚åº”æ•°æ®çš„è‡ªå¢è¶‹åŠ¿ï¼›ç¼ºç‚¹æ˜¯å¾€å¾€æ–°æ•°æ®è´Ÿè½½é«˜ï¼ˆæœ€æ–°çš„è¡¨ï¼‰ï¼Œå‹åŠ›åˆ†é…ä¸å¹³å‡ã€‚</li><li>æ—¥æœŸåˆ‡è¡¨ï¼Œé€‚ç”¨äºæ—¥å¿—è®°å½•å¼æ•°æ®ï¼Œä¼˜ç¼ºç‚¹ç­‰åŒäºé€’å¢åˆ‡è¡¨ã€‚</li><li>ä¸ªäººå€¾å‘äºé€’å¢åˆ‡è¡¨ï¼Œå…·ä½“æ ¹æ®åº”ç”¨åœºæ™¯å†³å®šã€‚</li></ul><h4 id="çƒ­ç‚¹æ•°æ®åˆ†è¡¨"><a href="#çƒ­ç‚¹æ•°æ®åˆ†è¡¨" class="headerlink" title="çƒ­ç‚¹æ•°æ®åˆ†è¡¨"></a>çƒ­ç‚¹æ•°æ®åˆ†è¡¨</h4><p>å°†æ•°æ®é‡è¾ƒå¤§çš„æ•°æ®è¡¨ä¸­å°†è¯»å†™é¢‘ç¹çš„æ•°æ®æŠ½å–å‡ºæ¥ï¼Œå½¢æˆçƒ­ç‚¹æ•°æ®è¡¨ã€‚é€šå¸¸ä¸€ä¸ªåºå¤§æ•°æ®è¡¨ç»å¸¸è¢«è¯»å†™çš„å†…å®¹å¾€å¾€å…·æœ‰ä¸€å®šçš„é›†ä¸­æ€§ï¼Œå¦‚æœè¿™äº›é›†ä¸­æ•°æ®å•ç‹¬å¤„ç†ï¼Œå°±ä¼šæå¤§å‡å°‘æ•´ä½“ç³»ç»Ÿçš„è´Ÿè½½ã€‚</p><p><strong>çƒ­ç‚¹æ•°æ®è¡¨ä¸æ—§æœ‰æ•°æ®å…³ç³»:</strong></p><ul><li>å¯ä»¥æ˜¯ä¸€å¼ å†—ä½™è¡¨ï¼Œå³è¯¥è¡¨æ•°æ®ä¸¢å¤±ä¸ä¼šå¦¨ç¢ä½¿ç”¨ï¼Œå› æºæ•°æ®ä»å­˜åœ¨äºæ—§æœ‰ç»“æ„ä¸­ã€‚ä¼˜ç‚¹æ˜¯å®‰å…¨æ€§é«˜ï¼Œç»´æŠ¤æ–¹ä¾¿ï¼Œç¼ºç‚¹æ˜¯å†™å‹åŠ›ä¸èƒ½åˆ†æ‹…ï¼Œä»éœ€è¦åŒæ­¥å†™å›åŸç³»ç»Ÿã€‚</li><li>å¯ä»¥æ˜¯éå†—ä½™è¡¨ï¼Œå³çƒ­ç‚¹æ•°æ®çš„å†…å®¹åŸæœ‰ç»“æ„ä¸å†ä¿å­˜ï¼Œä¼˜ç‚¹æ˜¯è¯»å†™æ•ˆç‡å…¨éƒ¨ä¼˜åŒ–ï¼›ç¼ºç‚¹æ˜¯å½“çƒ­ç‚¹æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œç»´æŠ¤é‡è¾ƒå¤§ã€‚</li><li>å…·ä½“æ–¹æ¡ˆé€‰æ‹©éœ€è¦æ ¹æ®è¯»å†™æ¯”ä¾‹å†³å®šï¼Œåœ¨è¯»é¢‘ç‡è¿œé«˜äºå†™é¢‘ç‡æƒ…å†µä¸‹ï¼Œä¼˜å…ˆè€ƒè™‘å†—ä½™è¡¨æ–¹æ¡ˆã€‚</li></ul><p><strong>æ•°æ®å­˜å‚¨ï¼š</strong><br>çƒ­ç‚¹æ•°æ®è¡¨å¯ä»¥ç”¨å•ç‹¬çš„ä¼˜åŒ–çš„ç¡¬ä»¶å­˜å‚¨ï¼Œæ¯”å¦‚æ˜‚è´µçš„é—ªå­˜å¡æˆ–å¤§å†…å­˜ç³»ç»Ÿã€‚</p><p><strong>çƒ­ç‚¹æ•°æ®è¡¨çš„é‡è¦æŒ‡æ ‡:</strong></p><ul><li>çƒ­ç‚¹æ•°æ®çš„å®šä¹‰éœ€è¦æ ¹æ®ä¸šåŠ¡æ¨¡å¼è‡ªè¡Œåˆ¶å®šç­–ç•¥ï¼Œå¸¸è§ç­–ç•¥ä¸ºï¼ŒæŒ‰ç…§æœ€æ–°çš„æ“ä½œæ—¶é—´ï¼›æŒ‰ç…§å†…å®¹ä¸°å¯Œåº¦ç­‰ç­‰ã€‚</li><li>æ•°æ®è§„æ¨¡ï¼Œæ¯”å¦‚ä»1000ä¸‡æ¡æ•°æ®ï¼ŒæŠ½å–å‡º100ä¸‡æ¡çƒ­ç‚¹æ•°æ®ã€‚</li><li>çƒ­ç‚¹å‘½ä¸­ç‡ï¼Œæ¯”å¦‚æŸ¥è¯¢10æ¬¡ï¼Œå¤šå°‘æ¬¡å‘½ä¸­åœ¨çƒ­ç‚¹æ•°æ®å†…ã€‚</li><li>ç†è®ºä¸Šï¼Œæ•°æ®è§„æ¨¡è¶Šå°ï¼Œçƒ­ç‚¹å‘½ä¸­ç‡è¶Šé«˜ï¼Œè¯´æ˜æ•ˆæœè¶Šå¥½ã€‚éœ€è¦æ ¹æ®ä¸šåŠ¡è‡ªè¡Œè¯„ä¼°ã€‚</li></ul><p><strong>çƒ­ç‚¹æ•°æ®è¡¨çš„åŠ¨æ€ç»´æŠ¤:</strong></p><ul><li>åŠ è½½çƒ­ç‚¹æ•°æ®æ–¹æ¡ˆé€‰æ‹©<ul><li>å®šæ—¶ä»æ—§æœ‰æ•°æ®ç»“æ„ä¸­æŒ‰ç…§æ–°çš„ç­–ç•¥è·å–</li><li>åœ¨ä»æ—§æœ‰æ•°æ®ç»“æ„è¯»å–æ—¶åŠ¨æ€åŠ è½½åˆ°çƒ­ç‚¹æ•°æ®</li></ul></li><li>å‰”é™¤çƒ­ç‚¹æ•°æ®æ–¹æ¡ˆé€‰æ‹©<ul><li>åŸºäºç‰¹å®šç­–ç•¥ï¼Œå®šæ—¶å°†çƒ­ç‚¹æ•°æ®ä¸­è®¿é—®é¢‘æ¬¡è¾ƒå°‘çš„æ•°æ®å‰”é™¤</li><li>å¦‚çƒ­ç‚¹æ•°æ®æ˜¯å†—ä½™è¡¨ï¼Œåˆ™ç›´æ¥åˆ é™¤å³å¯ï¼Œå¦‚ä¸æ˜¯å†—ä½™è¡¨ï¼Œéœ€è¦å›å†™ç»™æ—§æœ‰æ•°æ®ç»“æ„ã€‚</li></ul></li></ul><p>é€šå¸¸ï¼Œçƒ­ç‚¹æ•°æ®å¾€å¾€æ˜¯åŸºäºç¼“å­˜æˆ–è€…key-valueæ–¹æ¡ˆå†—ä½™å­˜å‚¨ï¼Œæ‰€ä»¥è¿™é‡Œæåˆ°çš„çƒ­ç‚¹æ•°æ®è¡¨ï¼Œå…¶å®æ›´å¤šæ˜¯ç†è§£æ€è·¯ï¼Œç”¨åˆ°çš„åœºåˆå¯èƒ½å¹¶ä¸å¤šã€‚ï¼ˆé€‚åˆç»„åˆæ¡ä»¶åœºæ™¯ï¼Œæ•°æ®è§„æ¨¡ä¸­ç­‰ï¼Œåƒæ·˜å®çš„æ•°æ®é‡å°±éœ€è¦ç¬¬ä¸‰æ–¹æœç´¢å¼•æ“ï¼‰</p><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li><a href="http://imysql.com/2014/09/28/mysql-optimization-case-blob-stored-in-innodb-optimization.shtml" rel="external nofollow noopener noreferrer" target="_blank">[MySQLä¼˜åŒ–æ¡ˆä¾‹]ç³»åˆ— â€” ä¼˜åŒ–InnoDBè¡¨BLOBåˆ—çš„å­˜å‚¨æ•ˆç‡</a></li><li>ã€ŠMysql æ€§èƒ½ä¼˜åŒ–æ•™ç¨‹-æ›¹æ”¿ã€‹</li></ul><!--ä»¥ä¸‹æ˜¯è„šæ³¨--><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style: none; padding-left: 0; margin-left: 40px"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">1.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">[MySQLä¼˜åŒ–æ¡ˆä¾‹]ç³»åˆ— â€” ä¼˜åŒ–InnoDBè¡¨BLOBåˆ—çš„å­˜å‚¨æ•ˆç‡<a href="#fnref:1" rev="footnote"> â†©</a></span></li><li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">2.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">å®æ™¯åˆ†æï¼š å‰ç«¯è¯·æ±‚å…ˆè¿æ¥ç¼“å­˜ï¼Œç¼“å­˜æœªå‘½ä¸­è¿æ¥æ•°æ®åº“ï¼Œè¿›è¡ŒæŸ¥è¯¢ï¼Œæœªå‘½ä¸­çŠ¶æ€æ¯”å•çº¯è¿æ¥æ•°æ®åº“æŸ¥è¯¢å¤šäº†ä¸€æ¬¡è¿æ¥å’ŒæŸ¥è¯¢çš„æ“ä½œï¼›å¦‚æœç¼“å­˜å‘½ä¸­ç‡å¾ˆä½ï¼Œåˆ™è¿™ä¸ªé¢å¤–çš„æ“ä½œéä½†ä¸èƒ½æé«˜æŸ¥è¯¢æ•ˆç‡ï¼Œåè€Œä¸ºç³»ç»Ÿå¸¦æ¥äº†é¢å¤–çš„è´Ÿè½½å’Œå¤æ‚æ€§ï¼Œå¾—ä¸å¿å¤±ã€‚<a href="#fnref:2" rev="footnote"> â†©</a></span></li><li id="fn:3"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">3.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">èŒƒä¾‹:<br><code>$var=Memcache_get($memcon,â€varâ€);$var++;memcache_set($memcon,â€varâ€,$var);</code><br>è¿™æ ·ä¸€ä¸ªè„šæœ¬ï¼Œä½¿ç”¨apache abå»è·‘ï¼Œ100ä¸ªå¹¶å‘ï¼Œè·‘10000æ¬¡ï¼Œç„¶åè¾“å‡ºç¼“å­˜å­˜å–çš„æ•°æ®ï¼Œå¾ˆé—æ†¾ï¼Œå¹¶ä¸æ˜¯1000ï¼Œè€Œæ˜¯5000å¤šï¼Œ6000å¤šè¿™æ ·çš„æ•°å­—ï¼Œä¸­é—´çš„æ•°å­—å…¨åœ¨ get &amp; setçš„è¿‡ç¨‹ä¸­ä¸¢æ‰äº†ã€‚åŸå› ï¼šè¯»å†™é—´éš”ä¸­å…¶ä»–å¹¶å‘å†™å…¥ï¼Œå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚<a href="#fnref:3" rev="footnote"> â†©</a></span></li><li id="fn:4"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">4.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">èŒƒä¾‹2:<br>ç”¨memcache_incrementæ¥åšè¿™ä¸ªæ“ä½œï¼ŒåŒæ ·è·‘æµ‹è¯•ä¼šå¾—åˆ°å®Œæ•´çš„10000ï¼Œä¸€æ¡æ•°æ®ä¸ä¼šä¸¢ã€‚<a href="#fnref:4" rev="footnote"> â†©</a></span></li><li id="fn:5"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">5.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">å®æˆ˜èŒƒä¾‹ï¼š<br>æŸè®ºå›çƒ­é—¨è´´ï¼Œå‰ç«¯ä¸æ–­æœ‰views=views+1æ•°æ®æ›´æ–°è¯·æ±‚ã€‚<br>ç¼“å­˜å®æ—¶æ›´æ–°è¯¥çŠ¶æ€<br>åå°ä»»åŠ¡å¯¹æ•°æ®åº“åšå¼‚æ­¥æ›´æ–°æ—¶ï¼Œå‡è®¾æ‰§è¡Œå‘¨æœŸæ˜¯5åˆ†é’Ÿï¼Œé‚£ä¹ˆäº”åˆ†é’Ÿå¯èƒ½ä¼šæ¥æ”¶åˆ°è¿™æ ·çš„è¯·æ±‚å¤šè¾¾æ•°åæ¬¡ä¹ƒè‡³æ•°ç™¾æ¬¡ï¼Œåˆå¹¶æ›´æ–°ååªæ‰§è¡Œä¸€æ¬¡updateå³å¯ã€‚<br>ç±»ä¼¼æ“ä½œè¿˜åŒ…æ‹¬æ¸¸æˆæ‰“æ€ªï¼Œç”Ÿå‘½å’Œç»éªŒçš„å˜åŒ–ï¼›ä¸ªäººä¸»é¡µè®¿é—®æ¬¡æ•°çš„å˜åŒ–ç­‰ã€‚<a href="#fnref:5" rev="footnote"> â†©</a></span></li><li id="fn:6"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">6.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">ä¾‹å¦‚ï¼š<code>ALTER TABLE t1 ADD INDEX(user(20))</code><br>å‰ç¼€ç´¢å¼•çš„é•¿åº¦å¯ä»¥åŸºäºå¯¹è¯¥å­—æ®µçš„ç»Ÿè®¡å¾—å‡ºï¼Œä¸€èˆ¬ç•¥å¤§äºå¹³å‡é•¿åº¦ä¸€ç‚¹å°±å¯ä»¥äº†ã€‚<a href="#fnref:6" rev="footnote"> â†©</a></span></li><li id="fn:7"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">7.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">å®æˆ˜èŒƒä¾‹ï¼š<br>ç”¨æˆ·åœ¨çº¿ä¸Šæ—¶ï¼Œåå°å¼‚æ­¥æ›´æ–°ç”¨æˆ·çŠ¶æ€ã€‚ç®¡ç†å‘˜åå°å±è”½ç”¨æˆ·æ˜¯ç›´æ¥æ›´æ–°æ•°æ®åº“ã€‚ç»“æœç®¡ç†å‘˜å±è”½æŸç”¨æˆ·æ“ä½œå®Œæˆåï¼Œå› è¯¥ç”¨æˆ·åœ¨çº¿æœ‰æ“ä½œï¼Œåå°å¼‚æ­¥æ›´æ–°ç¨‹åºå†æ¬¡åŸºäºç¼“å­˜æ›´æ–°ç”¨æˆ·çŠ¶æ€ï¼Œç”¨æˆ·çŠ¶æ€è¢«å¤æ´»ï¼Œå±è”½å¤±æ•ˆã€‚<a href="#fnref:7" rev="footnote"> â†©</a></span></li><li id="fn:8"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">8.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">èŒƒä¾‹ï¼šæ”¯ä»˜ä¿¡æ¯ï¼Œé“å…·çš„è´­ä¹°ä¸è·å¾—ï¼Œä¸€æ—¦ä¸¢å¤±ä¼šå¯¹ç”¨æˆ·é€ æˆæå¤§çš„ä¼¤å®³ã€‚è€Œç»éªŒå€¼ï¼Œè®¿é—®æ•°å­—ï¼Œå¦‚æœåªä¸¢å¤±äº†å¾ˆå°‘æ—¶é—´çš„å†…å®¹ï¼Œç”¨æˆ·è¿˜æ˜¯å¯ä»¥å®¹å¿çš„ã€‚<a href="#fnref:8" rev="footnote"> â†©</a></span></li><li id="fn:9"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">9.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">èŒƒä¾‹ï¼šå¦‚æœä½¿ç”¨ <code>Views=Views+â€¦</code>çš„æ“ä½œï¼Œä¸€æ—¦å‡ºç°æ•°æ®æ ¼å¼é”™è¯¯ï¼Œä»binlogä¸­åæ¨æ˜¯å¯ä»¥è¿›è¡Œæ•°æ®è¿˜åŸï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨Views=ç‰¹å®šå€¼çš„æ“ä½œï¼Œä¸€æ—¦ç¼“å­˜ä¸­æ•°æ®æœ‰é”™è¯¯ï¼Œåˆ™ç›´æ¥è¢«èµ‹äºˆäº†ä¸€ä¸ªé”™è¯¯æ•°æ®ï¼Œæ— æ³•å›æº¯ï¼<a href="#fnref:9" rev="footnote"> â†©</a></span></li><li id="fn:10"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">10.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">å®æˆ˜èŒƒä¾‹1: ç”¨æˆ·åˆ†è¡¨<br>å°†ç”¨æˆ·åº“åˆ†æˆè‹¥å¹²æ•°æ®è¡¨;åŸºäºç”¨æˆ·åçš„æŸ¥è¯¢å’ŒåŸºäºuidçš„æŸ¥è¯¢éƒ½æ˜¯é«˜å¹¶å‘è¯·æ±‚ã€‚<br>ç”¨æˆ·åˆ†è¡¨åŸºäºuidåˆ†æˆæ•°æ®è¡¨ï¼ŒåŒæ—¶åŸºäºç”¨æˆ·ååšå¯¹åº”å†—ä½™è¡¨ã€‚<br>å¦‚æœå…è®¸å¤šæ–¹å¼ç™»é™†ï¼Œå¯ä»¥æœ‰å¦‚ä¸‹è®¾è®¡æ–¹æ³•ï¼š<br><code>uid,passwd,ç”¨æˆ·ä¿¡æ¯ç­‰ç­‰ï¼Œä¸»æ•°æ®è¡¨ï¼ŒåŸºäºuidåˆ†è¡¨</code><br><code>ukey,ukeytype,uid åŸºäºukeyåˆ†è¡¨ï¼Œä¾¿äºç”¨æˆ·ç™»é™†çš„æŸ¥è¯¢ã€‚åˆ†è§£æˆå¦‚ä¸‹ä¸¤ä¸ªSQL:</code><br><code>select uid from ulist_key_13 where ukey=â€™$usernameâ€™ and ukeytype=â€˜loginâ€™;</code><br><code>select <em> from ulist_uid_23 where uid=$uid and passwd=â€™$passwdâ€™;</em></code><br><code>ukeytypeå®šä¹‰ç”¨æˆ·çš„ç™»é™†ä¾æ®ï¼Œæ¯”å¦‚ç”¨æˆ·åï¼Œæ‰‹æœºå·ï¼Œé‚®ä»¶åœ°å€ï¼Œç½‘ç«™æ˜µç§°ç­‰ã€‚ Ukey+ukeytype å¿…é¡»å”¯ä¸€</code><br><code>æ­¤ç§æ–¹å¼éœ€è¦ç™»é™†å¯†ç ç»Ÿä¸€ï¼Œå¯¹äºç¬¬ä¸‰æ–¹connectæ¥å…¥æ¨¡å¼ï¼Œå¯ä»¥é€šè¿‡å¼•ç”³é¢å¤–å­—æ®µå®Œæˆ</code><a href="#fnref:10" rev="footnote"> â†©</a></span></li><li id="fn:11"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">11.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">å®æˆ˜èŒƒä¾‹2ï¼šç”¨æˆ·æ¸¸æˆç§¯åˆ†æ’å<br>è¡¨ç»“æ„ uid,gameid,score å‚è§å‰æ–‡å®æ—¶ç§¯åˆ†æ’è¡Œã€‚è¡¨å†…å®¹å·¨å¤§ï¼Œéœ€è¦æ‹†è¡¨ã€‚<br>éœ€æ±‚1ï¼šåŸºäºæ¸¸æˆidæŸ¥è¯¢ç§¯åˆ†æ’è¡Œ<br>éœ€æ±‚2ï¼šåŸºäºç”¨æˆ·idæŸ¥è¯¢æ¸¸æˆç§¯åˆ†è®°å½•<br>è§£å†³æ–¹æ¡ˆï¼šå»ºç«‹å®Œå…¨ç›¸åŒçš„ä¸¤å¥—è¡¨ç»“æ„ï¼Œå…¶ä¸€ä»¥uidä¸ºæ‹†è¡¨ä¸»é”®ï¼Œå…¶äºŒä»¥gameidä¸ºæ‹†è¡¨ä¸»é”®ï¼Œç”¨æˆ·æäº¤ç§¯åˆ†æ—¶ï¼Œå‘ä¸¤ä¸ªæ•°æ®ç»“æ„åŒæ—¶æäº¤ã€‚<a href="#fnref:11" rev="footnote"> â†©</a></span></li><li id="fn:12"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">12.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">å®æˆ˜èŒƒä¾‹3ï¼šå…¨å†—ä½™æŸ¥è¯¢ç»“æ„<br>ä¸»ä¿¡æ¯è¡¨ä»…åŒ…æ‹¬ ä¸»é”®åŠå¤‡æ³¨memoå­—æ®µï¼ˆtextç±»å‹ï¼‰ï¼Œåªæ”¯æŒä¸»é”®æŸ¥è¯¢ï¼Œå¯ä»¥åŸºäºä¸»é”®æ‹†è¡¨ã€‚æ‰€ä»¥éœ€è¦å±•ç°å’Œå­˜å‚¨çš„å†…å®¹å‡åœ¨memoå­—æ®µé‡ä½“ç°ã€‚<br>å¯¹æ¯ä¸€ä¸ªæŸ¥è¯¢æ¡ä»¶ï¼Œå»ºç«‹æŸ¥è¯¢å†—ä½™è¡¨ï¼Œä»¥æŸ¥è¯¢æ¡ä»¶å­—æ®µä¸ºä¸»é”®ï¼Œä»¥ä¸»ä¿¡æ¯è¡¨ä¸»é”®id ä¸ºå†…å®¹ã€‚<br>æ—¥å¸¸æŸ¥è¯¢åªåŸºäºæŸ¥è¯¢å†—ä½™è¡¨ï¼Œç„¶åé€šè¿‡inçš„æ–¹å¼ä»ä¸»ä¿¡æ¯è¡¨è·å¾—å†…å®¹ã€‚<br>ä¼˜ç‚¹æ˜¯ç»“æ„æ‰©å±•éå¸¸æ–¹ä¾¿ï¼Œåªéœ€è¦æ‰©å±•æ–°çš„æŸ¥è¯¢ä¿¡æ¯è¡¨å³å¯ï¼Œæ ¸å¿ƒæ€è·¯æ˜¯ï¼Œåªæœ‰æŸ¥è¯¢æ‰éœ€è¦ç‹¬ç«‹çš„ç´¢å¼•ç»“æ„ï¼Œå±•ç°æ— éœ€ç‹¬ç«‹å­—æ®µã€‚<br>ç¼ºç‚¹æ˜¯åªé€‚åˆäºç›¸å¯¹å›ºå®šçš„æŸ¥è¯¢æ¶æ„ï¼Œå¯¹äºæ›´åŠ çµæ´»çš„ç»„åˆæŸ¥è¯¢æŸæ‰‹æ— ç­–ã€‚<a href="#fnref:12" rev="footnote"> â†©</a></span></li><li id="fn:13"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">13.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">ä¸¾ä¾‹ï¼Œä¿¡æ¯è¡¨ messageï¼Œå­˜åœ¨å­—æ®µ fromuid,touid,msg,sendtime å››ä¸ªå­—æ®µï¼Œå…¶ä¸­ touid+sendtimeæ˜¯å¤åˆç´¢å¼•ã€‚å­˜åœ¨æŸ¥è¯¢ä¸º select  from message where touid=$uid order by sendtime desc limit 0,30;<br>å±•ç¤ºç¨‹åºéœ€è¦æ˜¾ç¤ºå‘é€è€…å§“åï¼Œæ­¤æ—¶é€šå¸¸ä¼šåœ¨messageè¡¨ä¸­å¢åŠ å­—æ®µfromusernameï¼Œç”šè‡³æœ‰çš„ä¼šå¢åŠ fromusersexï¼Œä»è€Œæ— éœ€è¿è¡¨æŸ¥è¯¢ç›´æ¥è¾“å‡ºä¿¡æ¯çš„å‘é€è€…å§“åå’Œæ€§åˆ«ã€‚è¿™å°±æ˜¯ä¸€ç§ç®€å•çš„ï¼Œä¸ºäº†é¿å…è¿è¡¨æŸ¥è¯¢è€Œä½¿ç”¨çš„å†—ä½™å­—æ®µè®¾è®¡ã€‚<a href="#fnref:13" rev="footnote"> â†©</a></span></li><li id="fn:13"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">13.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">å®æˆ˜èŒƒä¾‹ï¼š<br>è®ºå›æ¿å—çš„å‘å¸–é‡ï¼Œå›å¸–é‡ï¼Œæ¯æ—¥æ–°å¢æ•°æ®ç­‰ã€‚<br>ç½‘ç«™æ¯æ—¥æ–°å¢ç”¨æˆ·æ•°ç­‰ã€‚<br>å‚è§Discuzè®ºå›ç³»ç»Ÿæ•°æ®ç»“æ„ï¼Œæœ‰è¾ƒå¤šç›¸å…³ç»“æ„ã€‚<br>å‚è§å‰æ–‡åˆ†æ®µç§¯åˆ†ç»“æ„ï¼Œæ˜¯å…¸å‹ç”¨äºç»Ÿè®¡çš„å†—ä½™ç»“æ„ã€‚<br>åå°å¯ä»¥é€šè¿‡æºæ•°æ®è¡¨æ›´æ–°è¯¥æ•°å­—ã€‚<br>Redisçš„Zsetç±»å‹å¯ä»¥ç†è§£ä¸ºå­˜åœ¨ä¸€ç§å†—ä½™ç»Ÿè®¡ç»“æ„ã€‚<a href="#fnref:13" rev="footnote"> â†©</a></span></li><li id="fn:14"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">14.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">æ¸¸æˆç»„é˜Ÿï¼Œ5ä¸ªæ­¦å°†ã€‚ï¼ˆå»ºç«‹ä¸´æ—¶çš„æ­¦å°†è¡¨ï¼Œå®šæ—¶æ›´æ–°åˆ°ä¸»è¡¨ï¼‰<a href="#fnref:14" rev="footnote"> â†©</a></span></li><li id="fn:15"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">15.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">å®æ—¶ç»Ÿè®¡<a href="#fnref:15" rev="footnote"> â†©</a></span></li><li id="fn:16"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">16.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">å®æˆ˜èŒƒä¾‹ï¼š åœ¨mysqlè¿æ¥ä¸åŠæ—¶é‡Šæ”¾çš„åº”ç”¨ç¯å¢ƒé‡Œï¼Œå½“ç½‘ç»œç¯å¢ƒå¼‚å¸¸ï¼ˆåŒæœºæˆ¿å‹é‚»æœåŠ¡å™¨é­å—æ‹’ç»æœåŠ¡æ”»å‡»ï¼Œå‡ºå£é˜»å¡ï¼‰ï¼Œç½‘ç»œå»¶è¿ŸåŠ å‰§ï¼Œç©ºè¿æ¥æ•°æ€¥å‰§å¢åŠ ï¼Œå¯¼è‡´æ•°æ®åº“è¿æ¥è¿‡å¤šå´©æºƒã€‚<a href="#fnref:16" rev="footnote"> â†©</a></span></li><li id="fn:17"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">17.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">å®æˆ˜èŒƒä¾‹ï¼šå‰ç«¯ä»£ç  é€šå¸¸æˆ‘ä»¬å°è£… mysql_connectå’Œmemcache_connectï¼ŒäºŒè€…çš„é¡ºåºä¸åŒï¼Œä¼šäº§ç”Ÿä¸åŒçš„è¿å¸¦æ•ˆåº”ã€‚å¦‚æœmysql_connectåœ¨å‰ï¼Œé‚£ä¹ˆä¸€æ—¦memcacheè¿æ¥é˜»å¡ï¼Œä¼šè¿å¸¦mysqlç©ºè¿æ¥è¿‡å¤šå´©æºƒã€‚<a href="#fnref:17" rev="footnote"> â†©</a></span></li><li id="fn:18"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">18.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">æ¯”å¦‚è¯´ï¼Œä¿¡æ¯è¡¨ï¼Œfromuid, touid, messageå­—æ®µå¤–ï¼Œè¿˜éœ€è¦ä¸€ä¸ªfromunameå­—æ®µè®°å½•ç”¨æˆ·åï¼Œè¿™æ ·æŸ¥è¯¢è€…é€šè¿‡touidæŸ¥è¯¢åï¼Œèƒ½å¤Ÿç«‹å³å¾—åˆ°å‘ä¿¡äººçš„ç”¨æˆ·åï¼Œè€Œæ— éœ€è¿›è¡Œå¦ä¸€ä¸ªæ•°æ®è¡¨çš„æŸ¥è¯¢ã€‚<a href="#fnref:18" rev="footnote"> â†©</a></span></li><li id="fn:19"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">19.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">èŒƒä¾‹: userè¡¨ ï¼Œä¸ªäººç®€ä»‹ï¼Œåœ°å€ï¼ŒQQå·ï¼Œè”ç³»æ–¹å¼ï¼Œå¤´åƒ è¿™äº›å­—æ®µä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œæ›´æ–°è¯·æ±‚å°‘ï¼› æœ€åç™»å½•æ—¶é—´ï¼Œåœ¨çº¿æ—¶å¸¸ï¼Œè®¿é—®æ¬¡æ•°ï¼Œä¿¡ä»¶æ•°è¿™äº›å­—æ®µä¸ºæ•´æ•°å‹å­—æ®µï¼Œæ›´æ–°é¢‘ç¹ï¼Œå¯ä»¥å°†åé¢è¿™äº›æ›´æ–°é¢‘ç¹çš„å­—æ®µç‹¬ç«‹æ‹†å‡ºä¸€å¼ æ•°æ®è¡¨ï¼Œè¡¨å†…å®¹å˜å°‘ï¼Œç´¢å¼•ç»“æ„å˜å°‘ï¼Œè¯»å†™è¯·æ±‚å˜å¿«ã€‚<a href="#fnref:19" rev="footnote"> â†©</a></span></li></ol></div></div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;æ•°æ®è¡¨è®¾è®¡&quot;&gt;&lt;a href=&quot;#æ•°æ®è¡¨è®¾è®¡&quot; class=&quot;he
      
    
    </summary>
    
      <category term="2-å¼€å‘æŠ€èƒ½" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/"/>
    
      <category term="æ•°æ®åº“" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="Mysql" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql/"/>
    
    
      <category term="mysql" scheme="http://yoursite.com/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>åŸºç¡€çŸ¥è¯†</title>
    <link href="http://yoursite.com/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    <id>http://yoursite.com/2-å¼€å‘æŠ€èƒ½/æ•°æ®åº“/Mysql/åŸºç¡€çŸ¥è¯†/</id>
    <published>2017-11-16T15:24:00.000Z</published>
    <updated>2017-12-03T16:04:44.530Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="ç´¢å¼•"><a href="#ç´¢å¼•" class="headerlink" title="ç´¢å¼•"></a>ç´¢å¼•</h1><h2 id="Mysql-å¸¸ç”¨æ•°æ®ç»“æ„"><a href="#Mysql-å¸¸ç”¨æ•°æ®ç»“æ„" class="headerlink" title="Mysql å¸¸ç”¨æ•°æ®ç»“æ„"></a>Mysql å¸¸ç”¨æ•°æ®ç»“æ„</h2><ul><li>B+ Tree</li><li>Hash index</li></ul><h2 id="äºŒè€…åŒºåˆ«"><a href="#äºŒè€…åŒºåˆ«" class="headerlink" title="äºŒè€…åŒºåˆ«"></a>äºŒè€…åŒºåˆ«</h2><h3 id="b-tree"><a href="#b-tree" class="headerlink" title="b+tree"></a>b+tree</h3><p><img src="/images/2017/11/16/b-tree.png" alt="b+tree"><br>B+æ ‘æ˜¯ä¸€ä¸ªå¹³è¡¡çš„å¤šå‰æ ‘ï¼Œä»æ ¹èŠ‚ç‚¹åˆ°æ¯ä¸ªå¶å­èŠ‚ç‚¹çš„é«˜åº¦å·®å€¼ä¸è¶…è¿‡1ï¼Œè€Œä¸”åŒå±‚çº§çš„èŠ‚ç‚¹é—´æœ‰æŒ‡é’ˆç›¸äº’é“¾æ¥ã€‚</p><p>åœ¨B+æ ‘ä¸Šçš„å¸¸è§„æ£€ç´¢ï¼Œä»æ ¹èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹çš„æœç´¢æ•ˆç‡åŸºæœ¬ç›¸å½“ï¼Œä¸ä¼šå‡ºç°å¤§å¹…æ³¢åŠ¨ï¼Œè€Œä¸”åŸºäºç´¢å¼•çš„é¡ºåºæ‰«ææ—¶ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨åŒå‘æŒ‡é’ˆå¿«é€Ÿå·¦å³ç§»åŠ¨ï¼Œæ•ˆç‡éå¸¸é«˜ã€‚</p><p>B+æ ‘ç´¢å¼•çš„å…³é”®å­—æ£€ç´¢æ•ˆç‡æ¯”è¾ƒå¹³å‡ï¼Œä¸åƒBæ ‘é‚£æ ·æ³¢åŠ¨å¹…åº¦å¤§</p><h3 id="Hash-index"><a href="#Hash-index" class="headerlink" title="Hash index"></a>Hash index</h3><p><img src="/images/2017/11/16/hash-index.png" alt="hash-index"><br>ç®€å•åœ°è¯´ï¼Œå“ˆå¸Œç´¢å¼•å°±æ˜¯é‡‡ç”¨ä¸€å®šçš„å“ˆå¸Œç®—æ³•ï¼ŒæŠŠé”®å€¼æ¢ç®—æˆæ–°çš„å“ˆå¸Œå€¼ï¼Œæ£€ç´¢æ—¶ä¸éœ€è¦ç±»ä¼¼B+æ ‘é‚£æ ·ä»æ ¹èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹é€çº§æŸ¥æ‰¾ï¼Œåªéœ€ä¸€æ¬¡å“ˆå¸Œç®—æ³•å³å¯ç«‹åˆ»å®šä½åˆ°ç›¸åº”çš„ä½ç½®ï¼Œé€Ÿåº¦éå¸¸å¿«ã€‚</p><p>å“ˆå¸Œç´¢å¼•åªèƒ½ä½¿ç”¨ in ï¼Œ=ï¼Œ!=</p><h3 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h3><ul><li>å¦‚æœæ˜¯ç­‰å€¼æŸ¥è¯¢ï¼Œé‚£ä¹ˆå“ˆå¸Œç´¢å¼•æ˜æ˜¾æœ‰ç»å¯¹ä¼˜åŠ¿</li><li>å¦‚æœæ˜¯èŒƒå›´æŸ¥è¯¢æ£€ç´¢ï¼Œè¿™æ—¶å€™å“ˆå¸Œç´¢å¼•å°±æ¯«æ— ç”¨æ­¦ä¹‹åœ°äº†</li><li>å“ˆå¸Œç´¢å¼•ä¹Ÿæ²¡åŠæ³•åˆ©ç”¨ç´¢å¼•å®Œæˆæ’åº</li><li>å“ˆå¸Œç´¢å¼•ä¹Ÿä¸æ”¯æŒå¤šåˆ—è”åˆç´¢å¼•çš„æœ€å·¦åŒ¹é…è§„åˆ™</li><li>åœ¨æœ‰å¤§é‡é‡å¤é”®å€¼æƒ…å†µä¸‹ï¼Œå“ˆå¸Œç´¢å¼•çš„æ•ˆç‡ä¹Ÿæ˜¯æä½çš„ï¼Œå› ä¸ºå­˜åœ¨æ‰€è°“çš„å“ˆå¸Œç¢°æ’é—®é¢˜</li></ul><h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><h3 id="ä¸ºä»€ä¹ˆä½¿ç”¨ç´¢å¼•èƒ½æé«˜æ•ˆç‡"><a href="#ä¸ºä»€ä¹ˆä½¿ç”¨ç´¢å¼•èƒ½æé«˜æ•ˆç‡" class="headerlink" title="ä¸ºä»€ä¹ˆä½¿ç”¨ç´¢å¼•èƒ½æé«˜æ•ˆç‡"></a>ä¸ºä»€ä¹ˆä½¿ç”¨ç´¢å¼•èƒ½æé«˜æ•ˆç‡</h3><p>å…³ç³»å‹æ•°æ®åº“çš„æ•°æ®ç´¢å¼•ï¼ˆBtreeåŠå¸¸è§ç´¢å¼•ç»“æ„ï¼‰çš„å­˜å‚¨æ˜¯<strong>æœ‰åº</strong>çš„ï¼ˆåœ¨æœ‰åºçš„æƒ…å†µä¸‹ï¼Œé€šè¿‡ç´¢å¼•æŸ¥è¯¢ä¸€ä¸ªæ•°æ®æ˜¯æ— éœ€éå†ç´¢å¼•è®°å½•çš„ï¼‰ã€‚</p><ul><li>ã€Œé»˜è®¤ b+treeç´¢å¼•ã€æŸ¥è¯¢æ•ˆç‡è¶‹è¿‘äºäºŒåˆ†æ³•ï¼Œè¶‹è¿‘äº log2(N)ã€‚</li><li>ã€Œhash ç´¢å¼•ã€æŸ¥è¯¢æ•ˆç‡æ˜¯å¯»å€æ“ä½œï¼Œè¶‹è¿‘äº1æ¬¡æŸ¥è¯¢ï¼Œæ¯”æœ‰åºç´¢å¼•æŸ¥è¯¢æ•ˆç‡æ›´é«˜</li></ul><h3 id="å¦‚ä½•ç†è§£æ•°æ®ç´¢å¼•çš„ç»“æ„"><a href="#å¦‚ä½•ç†è§£æ•°æ®ç´¢å¼•çš„ç»“æ„" class="headerlink" title="å¦‚ä½•ç†è§£æ•°æ®ç´¢å¼•çš„ç»“æ„"></a>å¦‚ä½•ç†è§£æ•°æ®ç´¢å¼•çš„ç»“æ„</h3><p><strong>ä»ç»“æ„</strong></p><ul><li>æ•°æ®ç´¢å¼•é€šå¸¸é»˜è®¤é‡‡ç”¨b+treeç´¢å¼•ï¼Œï¼ˆå†…å­˜è¡¨ä½¿ç”¨äº†hashç´¢å¼•ï¼‰ã€‚</li><li>å•å‘ <strong>æœ‰åº</strong> æ’åºåºåˆ—æ˜¯æŸ¥æ‰¾æ•ˆç‡æœ€é«˜çš„ï¼ˆäºŒåˆ†æŸ¥æ‰¾ï¼‰ï¼Œä½¿ç”¨æ ‘å½¢ç´¢å¼•çš„ç›®çš„æ˜¯ä¸ºäº†è¾¾åˆ°å¿«é€Ÿçš„æ›´æ–°å’Œå¢åˆ æ“ä½œã€‚</li><li>åœ¨æç«¯æƒ…å†µä¸‹ï¼ˆæ¯”å¦‚æ•°æ®æŸ¥è¯¢éœ€æ±‚é‡éå¸¸å¤§ï¼Œè€Œæ•°æ®æ›´æ–°éœ€æ±‚æå°‘ï¼Œå®æ—¶æ€§è¦æ±‚ä¸é«˜ï¼Œæ•°æ®è§„æ¨¡æœ‰é™ï¼‰ï¼Œç›´æ¥ä½¿ç”¨ <strong>å•ä¸€æ’åºåºåˆ—</strong>ï¼ŒæŠ˜åŠæŸ¥æ‰¾é€Ÿåº¦æœ€å¿«ã€‚</li></ul><p><strong>ä»ä¼˜åŒ–</strong></p><ul><li>åœ¨è¿›è¡Œç´¢å¼•åˆ†æå’ŒSQLä¼˜åŒ–æ—¶ï¼Œå¯ä»¥å°†æ•°æ®ç´¢å¼•å­—æ®µæƒ³è±¡ä¸ºå•ä¸€æœ‰åºåºåˆ—ï¼Œå¹¶ä»¥æ­¤ä½œä¸ºåˆ†æçš„åŸºç¡€ã€‚</li><li>æ¶‰åŠåˆ°å¤åˆç´¢å¼•æƒ…å†µï¼Œå¤åˆç´¢å¼•æŒ‰ç…§ç´¢å¼•é¡ºåºæ‹¼å‡‘æˆä¸€ä¸ªå­—æ®µï¼Œæƒ³è±¡ä¸ºå•ä¸€æœ‰åºåºåˆ—ï¼Œå¹¶ä»¥æ­¤ä½œä¸ºåˆ†æçš„åŸºç¡€ã€‚</li></ul><p><strong>ä»æŸ¥è¯¢ä¼˜åŒ–å™¨</strong></p><ul><li>ä¸€æ¡æ•°æ®æŸ¥è¯¢åªèƒ½ä½¿ç”¨ä¸€ä¸ªç´¢å¼•ï¼Œç´¢å¼•å¯ä»¥æ˜¯å¤šä¸ªå­—æ®µåˆå¹¶çš„å¤åˆç´¢å¼•ã€‚ä½†æ˜¯ä¸€æ¡æ•°æ®æŸ¥è¯¢ä¸èƒ½ä½¿ç”¨å¤šä¸ªç´¢å¼•ã€‚</li></ul><h2 id="æ‹“å±•é˜…è¯»"><a href="#æ‹“å±•é˜…è¯»" class="headerlink" title="æ‹“å±•é˜…è¯»"></a>æ‹“å±•é˜…è¯»</h2><ol><li><a href="http://blog.codinglabs.org/articles/theory-of-mysql-index.html" rel="external nofollow noopener noreferrer" target="_blank">MySQLç´¢å¼•èƒŒåçš„æ•°æ®ç»“æ„åŠç®—æ³•åŸç†</a></li><li><a href="http://blog.codinglabs.org/articles/index-condition-pushdown.html" rel="external nofollow noopener noreferrer" target="_blank">MySQLç´¢å¼•ä¸Index Condition Pushdown</a></li><li><a href="http://imysql.com/2015/10/29/mysql-faq-clustered-index.shtml" rel="external nofollow noopener noreferrer" target="_blank">FAQç³»åˆ— | MySQLç´¢å¼•ä¹‹èšé›†ç´¢å¼•</a></li><li><a href="http://imysql.com/2015/11/11/mysql-faq-primary-key-vs-secondary-key.shtml" rel="external nofollow noopener noreferrer" target="_blank">FAQç³»åˆ— | MySQLç´¢å¼•ä¹‹ä¸»é”®ç´¢å¼•</a></li></ol><h1 id="MysqlåŠ å¯†"><a href="#MysqlåŠ å¯†" class="headerlink" title="MysqlåŠ å¯†"></a>MysqlåŠ å¯†</h1><h2 id="mysqlç”¨æˆ·åå¯†ç å…¬å¼-5-7ä»¥å‰-ï¼š"><a href="#mysqlç”¨æˆ·åå¯†ç å…¬å¼-5-7ä»¥å‰-ï¼š" class="headerlink" title="mysqlç”¨æˆ·åå¯†ç å…¬å¼(5.7ä»¥å‰)ï¼š"></a>mysqlç”¨æˆ·åå¯†ç å…¬å¼(5.7ä»¥å‰)ï¼š</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">concat('*',sha1(unhex(sha1('mypassword')))) //ç­‰äº password('mypassword')</span><br></pre></td></tr></table></figure><h2 id="è®°å½•å¯†ç æ–¹å¼"><a href="#è®°å½•å¯†ç æ–¹å¼" class="headerlink" title="è®°å½•å¯†ç æ–¹å¼"></a>è®°å½•å¯†ç æ–¹å¼</h2><ul><li>binlog è®°å½•å¯†ç æ–¹å¼</li><li>5.6ä»¥å‰ binlog ä¼šæ‰“å°æ˜æ–‡å¯†ç </li><li>5.6ä»¥å ä»¥å¯†æ–‡æ–¹å¼è®°å½• binlog çš„å‘½ä»¤</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> â€¦ <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> â€¦</span><br><span class="line"><span class="keyword">GRANT</span> â€¦ <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> â€¦</span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">PASSWORD</span> â€¦</span><br><span class="line"><span class="keyword">SLAVE</span> <span class="keyword">START</span> â€¦ <span class="keyword">PASSWORD</span> = â€¦ (<span class="keyword">as</span> <span class="keyword">of</span> <span class="number">5.6</span><span class="number">.4</span>)</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">SERVER</span> â€¦ OPTIONS(â€¦ <span class="keyword">PASSWORD</span> â€¦) (<span class="keyword">as</span> <span class="keyword">of</span> <span class="number">5.6</span><span class="number">.9</span>)</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">SERVER</span> â€¦ OPTIONS(â€¦ <span class="keyword">PASSWORD</span> â€¦) (<span class="keyword">as</span> <span class="keyword">of</span> <span class="number">5.6</span><span class="number">.9</span>)</span><br><span class="line">//<span class="keyword">change</span> <span class="keyword">master</span> <span class="keyword">to</span> ä¸åœ¨æ­¤èŒƒç•´ä¸­ï¼Œåœ¨å¯åŠ¨ä¸»ä»æ—¶ä¼šæœ‰ <span class="keyword">warning</span> æç¤º</span><br></pre></td></tr></table></figure><h1 id="å½±å“ç»“æœé›†"><a href="#å½±å“ç»“æœé›†" class="headerlink" title="å½±å“ç»“æœé›†"></a>å½±å“ç»“æœé›†</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">explain</span> [<span class="keyword">sql</span>]</span><br></pre></td></tr></table></figure><h2 id="å½±å“å› ç´ "><a href="#å½±å“å› ç´ " class="headerlink" title="å½±å“å› ç´ "></a>å½±å“å› ç´ </h2><p>æŸ¥è¯¢æ¡ä»¶ä¸ç´¢å¼•çš„å…³ç³»å†³å®šå½±å“ç»“æœé›†ã€‚</p><h2 id="å½±å“ç»“æœé›†æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#å½±å“ç»“æœé›†æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="å½±å“ç»“æœé›†æ˜¯ä»€ä¹ˆï¼Ÿ"></a>å½±å“ç»“æœé›†æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>å½±å“ç»“æœé›†ä¸æ˜¯è¾“å‡ºç»“æœæ•°ï¼Œä¸æ˜¯æŸ¥è¯¢è¿”å›çš„è®°å½•æ•°ï¼Œè€Œæ˜¯<strong>ç´¢å¼•æ‰€æ‰«æçš„ç»“æœæ•°</strong>ã€‚</p><h2 id="ä¼˜åŒ–ç›®æ ‡"><a href="#ä¼˜åŒ–ç›®æ ‡" class="headerlink" title="ä¼˜åŒ–ç›®æ ‡"></a>ä¼˜åŒ–ç›®æ ‡</h2><ul><li>å½±å“ç»“æœé›†è¶Šè¶‹è¿‘äº<strong>å®é™…è¾“å‡º</strong>æˆ–æ“ä½œçš„<strong>ç›®æ ‡ç»“æœé›†</strong>ï¼Œç´¢å¼•æ•ˆç‡è¶Šé«˜ã€‚</li><li><strong>å½±å“ç»“æœé›†ä¸æŸ¥è¯¢å¼€é”€çš„å…³ç³»å¯ä»¥ç†è§£ä¸ºçº¿æ€§ç›¸å…³</strong>ã€‚å‡å°‘ä¸€åŠå½±å“ç»“æœé›†ï¼Œå³å¯æå‡ä¸€å€æŸ¥è¯¢æ•ˆç‡ï¼å½“ä¸€æ¡æœç´¢queryå¯ä»¥ç¬¦åˆå¤šä¸ªç´¢å¼•æ—¶ï¼Œé€‰æ‹©å½±å“ç»“æœé›†æœ€å°‘çš„ç´¢å¼•ã€‚</li></ul><h2 id="å¦‚ä½•ä¼˜åŒ–ï¼Ÿ"><a href="#å¦‚ä½•ä¼˜åŒ–ï¼Ÿ" class="headerlink" title="å¦‚ä½•ä¼˜åŒ–ï¼Ÿ"></a>å¦‚ä½•ä¼˜åŒ–ï¼Ÿ</h2><p><strong>SQLçš„ä¼˜åŒ–ï¼Œæ ¸å¿ƒå°±æ˜¯å¯¹ç»“æœé›†çš„ä¼˜åŒ–</strong>ï¼Œè®¤è¯†ç´¢å¼•æ˜¯å¢å¼ºå¯¹ç»“æœé›†çš„åˆ¤æ–­ï¼ŒåŸºäºç´¢å¼•çš„è®¤è¯†ï¼Œå¯ä»¥åœ¨ç¼–å†™SQLçš„æ—¶å€™ï¼Œå¯¹è¯¥SQLå¯èƒ½çš„å½±å“ç»“æœé›†æœ‰é¢„åˆ¤ï¼Œå¹¶åšå‡ºé€‚å½“çš„ä¼˜åŒ–å’Œè°ƒæ•´ã€‚</p><h2 id="Limit-çš„å½±å“"><a href="#Limit-çš„å½±å“" class="headerlink" title="Limit çš„å½±å“"></a>Limit çš„å½±å“</h2><ul><li>å¦‚æœ<strong>ç´¢å¼•ä¸æŸ¥è¯¢æ¡ä»¶å’Œæ’åºæ¡ä»¶å®Œå…¨å‘½ä¸­</strong>ï¼Œå½±å“ç»“æœé›†å°±æ˜¯limitåé¢çš„æ•°å­—ï¼ˆ$start + $endï¼‰ï¼Œæ¯”å¦‚ limit 200,30 å½±å“ç»“æœé›†æ˜¯230. è€Œä¸æ˜¯30.</li><li><p>å¦‚æœç´¢å¼•åªå‘½ä¸­éƒ¨åˆ†æŸ¥è¯¢æ¡ä»¶ï¼Œç”šè‡³æ— å‘½ä¸­æ¡ä»¶ï¼Œåœ¨<strong>æ— æ’åºæ¡ä»¶</strong>æƒ…å†µä¸‹ï¼Œä¼šåœ¨ç´¢å¼•å‘½ä¸­çš„ç»“æœé›† ä¸­éå†åˆ°æ»¡è¶³æ‰€æœ‰å…¶ä»–æ¡ä»¶ä¸ºæ­¢ã€‚</p><blockquote><p>æ¯”å¦‚ select * from user limit 10; è™½ç„¶æ²¡ç”¨åˆ°ç´¢å¼•ï¼Œä½†æ˜¯å› ä¸ºä¸æ¶‰åŠäºŒæ¬¡ç­›é€‰å’Œæ’åºï¼Œç³»ç»Ÿç›´æ¥è¿”å›å‰10æ¡ç»“æœï¼Œå½±å“ç»“æœé›†ä¾ç„¶åªæœ‰10æ¡ï¼Œå°±ä¸å­˜åœ¨æ•ˆç‡å½±å“ã€‚</p></blockquote></li><li><p>å¦‚æœæœç´¢æ‰€åŒ…å«çš„<strong>æ’åºæ¡ä»¶æ²¡æœ‰è¢«ç´¢å¼•å‘½ä¸­</strong>ï¼Œåˆ™ç³»ç»Ÿä¼šéå†æ‰€æœ‰ç´¢å¼•å‘½ä¸­çš„ç»“æœï¼Œå¹¶ä¸”æ’åºã€‚</p><blockquote><p>ä¾‹å¦‚ Select <em> from user order by timeline desc limit 10; å¦‚æœtimelineä¸æ˜¯ç´¢å¼•ï¼Œå½±å“ç»“æœé›†æ˜¯å…¨è¡¨ï¼Œå°±å­˜åœ¨éœ€è¦å…¨è¡¨æ•°æ®æ’åºï¼Œè¿™ä¸ªæ•ˆç‡å½±å“å°±å·¨å¤§ã€‚å†æ¯”å¦‚ Select </em> from user where area=â€™å¦é—¨â€™ order by timeline desc limit 10; å¦‚æœareaæ˜¯ç´¢å¼•ï¼Œè€Œarea+timelineæœªå»ºç«‹ç´¢å¼•ï¼Œåˆ™å½±å“ç»“æœé›†æ˜¯æ‰€æœ‰å‘½ä¸­ area=â€™å¦é—¨â€™çš„ç”¨æˆ·ï¼Œç„¶ååœ¨å½±å“ç»“æœé›†å†…æ’åºã€‚</p></blockquote></li></ul><h1 id="Cpu-å†…å­˜-ç£ç›˜åˆ©ç”¨ç‰¹ç‚¹"><a href="#Cpu-å†…å­˜-ç£ç›˜åˆ©ç”¨ç‰¹ç‚¹" class="headerlink" title="Cpu/å†…å­˜/ç£ç›˜åˆ©ç”¨ç‰¹ç‚¹"></a>Cpu/å†…å­˜/ç£ç›˜åˆ©ç”¨ç‰¹ç‚¹</h1><h2 id="Cpuåˆ©ç”¨ç‰¹ç‚¹"><a href="#Cpuåˆ©ç”¨ç‰¹ç‚¹" class="headerlink" title="Cpuåˆ©ç”¨ç‰¹ç‚¹"></a>Cpuåˆ©ç”¨ç‰¹ç‚¹</h2><p>æ¯ä¸ªè¿æ¥å¯¹åº”ä¸€ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªå¹¶å‘queryåªèƒ½ä½¿ç”¨åˆ°ä¸€ä¸ªæ ¸</p><ul><li>&lt;5.1ï¼Œå¤šæ ¸å¿ƒæ”¯æŒè¾ƒå¼±</li><li>5.1ï¼Œå¯åˆ©ç”¨4ä¸ªæ ¸</li><li>5.5ï¼Œå¯åˆ©ç”¨24ä¸ªæ ¸</li><li>5.6ï¼Œå¯åˆ©ç”¨64ä¸ªæ ¸</li></ul><h2 id="å†…å­˜åˆ©ç”¨ç‰¹ç‚¹"><a href="#å†…å­˜åˆ©ç”¨ç‰¹ç‚¹" class="headerlink" title="å†…å­˜åˆ©ç”¨ç‰¹ç‚¹"></a>å†…å­˜åˆ©ç”¨ç‰¹ç‚¹</h2><ul><li><p>ç±»ä¼¼ORACLEçš„SGA(å…¨å±€)ã€PGAï¼ˆä¼šè¯ï¼‰æ¨¡å¼ï¼Œæ³¨æ„PGAä¸å®œåˆ†é…è¿‡å¤§</p><blockquote><p>SGAï¼šSystem Global Areaæ˜¯Oracle Instanceçš„åŸºæœ¬ç»„æˆéƒ¨åˆ†ï¼Œåœ¨å®ä¾‹å¯åŠ¨æ—¶åˆ†é…;ç³»ç»Ÿå…¨å±€åŸŸSGAä¸»è¦ç”±ä¸‰éƒ¨åˆ†æ„æˆï¼šå…±äº«æ± ã€æ•°æ®ç¼“å†²åŒºã€æ—¥å¿—ç¼“å†²åŒºã€‚<br>PGAï¼šProcess Global Areaæ˜¯ä¸ºæ¯ä¸ªè¿æ¥åˆ°Oracle databaseçš„ç”¨æˆ·è¿›ç¨‹ä¿ç•™çš„å†…å­˜<br>Mysql ä¸­ä¼šè¯å†…å­˜åˆ†é…ä¸è¦å¤ªå¤§ï¼Œå¦åˆ™ä¼šé€ æˆ OOMï¼ˆout of memoryï¼‰</p></blockquote></li><li><p>å†…å­˜ç®¡ç†ç®€å•ã€æœ‰æ•ˆã€‚<strong>åœ¨é«˜TPSã€é«˜å¹¶å‘ç¯å¢ƒä¸‹ï¼Œå¯å¢åŠ ç‰©ç†å†…å­˜ä»¥å‡å°‘ç‰©ç†IOï¼Œæé«˜å¹¶å‘æ€§èƒ½</strong></p></li><li><p>Mysql é”å¹¶å‘ç«äº‰æ¯”è¾ƒä¸¥é‡ï¼ŒMariaDBã€Perconaè¿›è¡Œä¼˜åŒ–</p><blockquote><p>2014å¹´å»ºè®®ä½¿ç”¨ Percona &gt; MariaDB &gt; Mysql</p></blockquote></li><li><p>æœ‰ç±»ä¼¼ORACLE library cacheçš„query cacheï¼Œä½†æ•ˆæœä¸ä½³ï¼Œå»ºè®®å…³é—­</p><blockquote><p>Qcacheæœ‰ä¸ªå…¨å±€é”,æœ‰æ•°æ®å˜æ›´ï¼Œåˆ™ä¼šæ›´æ–° Qcacheï¼›<br>Dml ä¸é¢‘ç¹æ—¶ï¼ˆåªè¯»ï¼‰ï¼ŒQcache è¿˜æ˜¯æœ‰ç”¨çš„â€“æ²¡æœ‰åªè¯»çš„åœºæ™¯ï¼Œä»æœåŠ¡ä¹Ÿè¦å†™</p></blockquote></li><li><p>æ‰§è¡Œè®¡åˆ’æ²¡æœ‰ç¼“å­˜ï¼Œæ¯æ¬¡éƒ½éœ€è¦è§£æ SQL</p></li><li>é€šå¸¸å†…å­˜å»ºè®®æŒ‰çƒ­ç‚¹æ•°æ®æ€»é‡çš„15%-20%æ¥è§„åˆ’ï¼Œä¸“ç”¨å•å®ä¾‹åˆ™å¯ä»¥åˆ†é…ç‰©ç†å†…å­˜çš„50~70%å·¦å³</li></ul><h2 id="ç£ç›˜åˆ©ç”¨ç‰¹ç‚¹"><a href="#ç£ç›˜åˆ©ç”¨ç‰¹ç‚¹" class="headerlink" title="ç£ç›˜åˆ©ç”¨ç‰¹ç‚¹"></a>ç£ç›˜åˆ©ç”¨ç‰¹ç‚¹</h2><ul><li>binlogã€redo logã€undo logä¸»è¦é¡ºåºIO</li><li>datafileæ˜¯ä¸»è¦æ˜¯ ã€Œ<strong>éšæœºIO</strong>ã€ å’Œé¡ºåºIOä¹Ÿæœ‰</li><li>OLTPä¸šåŠ¡ï¼ˆæ•°æ®æŸ¥è¯¢ï¼‰ä»¥éšæœºIOä¸ºä¸»ï¼Œå»ºè®®åŠ å¤§å†…å­˜ï¼Œå°½é‡åˆå¹¶éšæœºIOä¸ºé¡ºåºIO<blockquote><p>é€šè¿‡ innodb buffer è¿›è¡Œåˆå¹¶</p></blockquote></li><li>OLAPä¸šåŠ¡ï¼ˆæ•°æ®åˆ†æï¼‰ä»¥é¡ºåºIOä¸ºä¸»ï¼ŒåŠ å¤§å†…å­˜çš„åŒæ—¶å¢åŠ ç¡¬ç›˜æ•°é‡æé«˜é¡ºåºIOæ€§èƒ½</li><li><p>MyISAMæ˜¯å †ç»„ç»‡è¡¨ï¼ˆHOTï¼‰ï¼ŒInnoDBæ˜¯ç´¢å¼•ç»„ç»‡è¡¨ï¼ˆIOTï¼‰</p><blockquote><p>MYISAM ï¼šæ–°å†™çš„æ•°æ®æ”¾å…¥å †çš„æœ€å<br>Innodb ï¼šB+tree çš„ç´¢å¼•ç»“æ„</p></blockquote></li><li><p>InnoDBç›¸æ¯”MyISAMæ›´æ¶ˆè€—ç£ç›˜ç©ºé—´</p><blockquote><p>Innodb çš„å ç”¨ç©ºé—´é€šå¸¸æ¯” MyISAM å¤š1.5~2å€<br>innodb ä¿å­˜æ›´å¤šçš„æ•°æ®ï¼Œæ¯”å¦‚ï¼šäº‹åŠ¡ä¿¡æ¯</p></blockquote></li></ul><h1 id="æ•°æ®å¼•æ“"><a href="#æ•°æ®å¼•æ“" class="headerlink" title="æ•°æ®å¼•æ“"></a>æ•°æ®å¼•æ“</h1><h2 id="Myisam"><a href="#Myisam" class="headerlink" title="Myisam"></a>Myisam</h2><p>é€Ÿåº¦å¿«ï¼Œå“åº”å¿«ã€‚è¡¨çº§é”æ˜¯è‡´å‘½é—®é¢˜</p><ul><li>è¡¨çº§é” â€“ è¯»å’Œå†™æ˜¯ä¸²è¡Œçš„</li><li>ä¸æ”¯æŒäº‹åŠ¡</li><li>å†…å­˜åªç¼“å­˜ç´¢å¼•</li></ul><h2 id="Innodb"><a href="#Innodb" class="headerlink" title="Innodb"></a>Innodb</h2><p>ç›®å‰ä¸»æµå­˜å‚¨å¼•æ“</p><ul><li>è¡Œçº§é” â€“ ä¸åŒæ•°æ®è¯»å†™å¯å¹¶è¡Œå¤„ç†</li><li>æ”¯æŒäº‹åŠ¡</li><li>å†…å­˜ç¼“å­˜æ•°æ®å’Œç´¢å¼•</li><li>Crash Recovery â€“ æ•…éšœè‡ªåŠ¨ä¿®å¤ï¼Œä¿®å¤ç›¸æ¯”MyISAMé€Ÿåº¦æ›´å¿«</li></ul><h2 id="Memory"><a href="#Memory" class="headerlink" title="Memory"></a>Memory</h2><p>ä½¿ç”¨ hash ç´¢å¼•</p><ul><li>é¢‘ç¹æ›´æ–°å’Œæµ·é‡è¯»å–æƒ…å†µä¸‹ä»ä¼šå­˜åœ¨é”å®šçŠ¶å†µ</li><li>ä¸æ”¯æŒèŒƒå›´æŸ¥è¯¢åŠæ’åºï¼Œåªèƒ½=,!=,in</li></ul><h1 id="è®¾è®¡è§„èŒƒ"><a href="#è®¾è®¡è§„èŒƒ" class="headerlink" title="è®¾è®¡è§„èŒƒ"></a>è®¾è®¡è§„èŒƒ</h1><h2 id="åŸºæœ¬åŸåˆ™"><a href="#åŸºæœ¬åŸåˆ™" class="headerlink" title="åŸºæœ¬åŸåˆ™"></a>åŸºæœ¬åŸåˆ™</h2><ul><li>å‡å°‘ç‰©ç†I/Oï¼Œè®©MySQLé—²ä¸‹æ¥ (å‡å°‘è´Ÿè½½ï¼ˆå‰ç«¯+å„çº§cacheï¼‰)</li><li>è½¬å˜éšæœºI/Oä¸ºé¡ºåºI/O ï¼ˆæœ¬åœ°å†™é˜Ÿåˆ—ï¼Œæœ€ååˆå¹¶å†™ï¼‰</li><li>å‡å°æ´»è·ƒæ•°æ® (å†·çƒ­æ•°æ®åˆ†ç¦»)</li><li>åˆ†åº“åˆ†è¡¨ (å‚ç›´ã€æ°´å¹³æ‹†åˆ†ã€åˆ†å¸ƒå¼é›†ç¾¤)</li><li>è¯»å†™åˆ†ç¦» (ä»åªè¯»ï¼ŒåŠ å¤§ bufferä½¿è¯»çš„æ€§èƒ½æ›´å¥½äº›)</li><li>OLTPã€OLAPåˆ†ç¦»</li></ul><h2 id="ç¦æ­¢"><a href="#ç¦æ­¢" class="headerlink" title="ç¦æ­¢"></a>ç¦æ­¢</h2><ul><li>ç¦æ­¢ Mysql åšè¿ç®—</li><li>å¿«é€Ÿæ›´æ–°å¤§æ•°æ®è¡¨ï¼Œç¦æ­¢ç›´æ¥è¿è¡Œcount(*)ç»Ÿè®¡</li></ul><h2 id="æ•°æ®é‡æ§åˆ¶"><a href="#æ•°æ®é‡æ§åˆ¶" class="headerlink" title="æ•°æ®é‡æ§åˆ¶"></a>æ•°æ®é‡æ§åˆ¶</h2><ul><li>å•è¡¨è¡Œè®°å½•æ•°æ§åˆ¶åœ¨1000ä¸‡ä»¥å†…ï¼Œè¡Œå¹³å‡é•¿åº¦æ§åˆ¶åœ¨16KBä»¥å†…ï¼Œå•è¡¨20GBä»¥å†…</li><li>å•å®ä¾‹ä¸‹æ•°æ®è¡¨æ•°é‡ä¸è¶…è¿‡2000ä¸ªï¼Œ å•åº“ä¸‹æ•°æ®è¡¨æ•°é‡ä¸è¶…è¿‡500ä¸ª</li></ul><h2 id="è¯»å†™"><a href="#è¯»å†™" class="headerlink" title="è¯»å†™"></a>è¯»å†™</h2><ul><li>è¯»å†™åˆ†ç¦»ï¼Œä¸»åº“åªå†™å’Œå°‘é‡å®æ—¶è¯»å–è¯·æ±‚ï¼Œç»Ÿè®¡åœ¨ä»åº“ä¸Šæ‰§è¡Œ</li><li>é‡‡ç”¨é˜Ÿåˆ—æ–¹å¼åˆå¹¶å¤šæ¬¡å†™è¯·æ±‚ï¼Œ æŒç»­å†™å…¥ï¼Œ é¿å…ç¬é—´å‹åŠ›</li></ul><h2 id="å­˜å‚¨"><a href="#å­˜å‚¨" class="headerlink" title="å­˜å‚¨"></a>å­˜å‚¨</h2><ul><li>ã€Œå‚ç›´æ‹†åˆ†ã€è¶…é•¿text/blobè¿›è¡Œå‚ç›´æ‹†åˆ†ï¼Œå¹¶å…ˆè¡Œå‹ç¼©</li><li>ã€Œæ°´å¹³æ‹†åˆ†ã€å†·çƒ­æ•°æ®è¿›è¡Œæ°´å¹³æ‹†åˆ†ï¼ŒLRUåŸåˆ™</li><li>å‹åŠ›åˆ†æ•£ï¼Œåœ¨çº¿è¡¨å’Œå½’æ¡£è¡¨ï¼ˆæ—¥å¿—è¡¨ï¼‰åˆ†å¼€å­˜å‚¨</li></ul><h2 id="SQLè§„èŒƒ"><a href="#SQLè§„èŒƒ" class="headerlink" title="SQLè§„èŒƒ"></a>SQLè§„èŒƒ</h2><ul><li>æ³¨æ„å¼•å·é—®é¢˜ä¼šå¯¼è‡´ç±»å‹è½¬æ¢ï¼ˆwhere id = â€˜1234â€™ï¼‰</li><li>è¿‡æ»¤ç”¨æˆ·æäº¤SQLï¼Œé˜²æ­¢æ³¨å…¥</li><li>æœç» like â€˜%xxx%â€™ï¼Œä¸ç”¨/å°‘ç”¨ like â€˜xxx%â€™</li><li>ä¸ç”¨/å°‘ç”¨å­æŸ¥è¯¢ï¼Œæ”¹é€ æˆè¿æ¥ï¼ˆJOINï¼‰</li><li>ä¸ç”¨/å°‘ç”¨FOR UPDATEã€LOCK IN SHARE MODEï¼Œé˜²æ­¢é”èŒƒå›´æ‰©å¤§åŒ–</li></ul><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li><a href="http://imysql.com/2016/01/06/mysql-faq-different-between-btree-and-hash-index.shtml" rel="external nofollow noopener noreferrer" target="_blank">FAQç³»åˆ— | B+æ ‘ç´¢å¼•å’Œå“ˆå¸Œç´¢å¼•çš„åŒºåˆ«</a></li></ul><!--ä»¥ä¸‹æ˜¯è„šæ³¨-->]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;ç´¢å¼•&quot;&gt;&lt;a href=&quot;#ç´¢å¼•&quot; class=&quot;headerli
      
    
    </summary>
    
      <category term="2-å¼€å‘æŠ€èƒ½" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/"/>
    
      <category term="æ•°æ®åº“" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="Mysql" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E6%95%B0%E6%8D%AE%E5%BA%93/Mysql/"/>
    
    
      <category term="mysql" scheme="http://yoursite.com/tags/mysql/"/>
    
  </entry>
  
  <entry>
    <title>Git å¸¸ç”¨å‘½ä»¤</title>
    <link href="http://yoursite.com/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/GIT/git/"/>
    <id>http://yoursite.com/2-å¼€å‘æŠ€èƒ½/GIT/git/</id>
    <published>2017-11-16T13:21:00.000Z</published>
    <updated>2017-12-03T16:04:44.528Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="å·¥ä½œæµç¨‹å›¾"><a href="#å·¥ä½œæµç¨‹å›¾" class="headerlink" title="å·¥ä½œæµç¨‹å›¾"></a>å·¥ä½œæµç¨‹å›¾</h1><p><img src="/images/2017/11/16/git.png" alt="git"></p><ul><li>Workspaceï¼šå·¥ä½œåŒº</li><li>Index / Stageï¼šæš‚å­˜åŒº</li><li>Repositoryï¼šä»“åº“åŒºï¼ˆæˆ–æœ¬åœ°ä»“åº“ï¼‰</li><li>Remoteï¼šè¿œç¨‹ä»“åº“</li></ul><h1 id="GIT-é…ç½®"><a href="#GIT-é…ç½®" class="headerlink" title="GIT é…ç½®"></a>GIT é…ç½®</h1><p>Gitçš„è®¾ç½®æ–‡ä»¶ä¸º.git/configï¼Œå®ƒå¯ä»¥åœ¨ç”¨æˆ·ä¸»ç›®å½•ä¸‹ï¼ˆå…¨å±€é…ç½®ï¼‰ï¼Œä¹Ÿå¯ä»¥åœ¨é¡¹ç›®ç›®å½•ä¸‹ï¼ˆé¡¹ç›®é…ç½®ï¼‰ã€‚</p><ul><li>æ˜¾ç¤ºå½“å‰çš„Gité…ç½®:<br><code>git config --list</code></li><li>ç¼–è¾‘Gité…ç½®æ–‡ä»¶:<br><code>git config -e [--global]</code></li><li>è®¾ç½®æäº¤ä»£ç æ—¶çš„ç”¨æˆ·ä¿¡æ¯<br><code>git config [--global] user.name [name]</code><br><code>git config [--global] user.email [email address]</code></li></ul><h1 id="æ–°å»ºä»£ç åº“"><a href="#æ–°å»ºä»£ç åº“" class="headerlink" title="æ–°å»ºä»£ç åº“"></a>æ–°å»ºä»£ç åº“</h1><ul><li>å½“å‰ç›®å½•<br><em>ç©ºç›®å½•/æ‹·è´çš„ git ç›®å½•</em><br><code>git init</code></li><li>åˆ›å»ºç›®å½•<br><code>git init [project-name]</code></li><li>ä¸‹è½½ä¸€ä¸ªé¡¹ç›®(åŒ…å«å†å²)<br><code>git clone [url]</code></li><li>æœ¬åœ°åˆå§‹åŒ–è¿œç«¯<br><code>git remote add origin [http://xxx.git]</code><br><code>git push -u origin master</code></li></ul><h1 id="å¢åŠ -åˆ é™¤æ–‡ä»¶"><a href="#å¢åŠ -åˆ é™¤æ–‡ä»¶" class="headerlink" title="å¢åŠ /åˆ é™¤æ–‡ä»¶"></a>å¢åŠ /åˆ é™¤æ–‡ä»¶</h1><ul><li>æ·»åŠ æŒ‡å®šæ–‡ä»¶åˆ°æš‚å­˜åŒº<br><code>git add [file1] [file2] ...</code></li><li>æ·»åŠ æŒ‡å®šç›®å½•åˆ°æš‚å­˜åŒºï¼ŒåŒ…æ‹¬å­ç›®å½•<br><code>git add [dir]</code></li><li>æ·»åŠ æ–‡ä»¶çš„éƒ¨åˆ†åˆ°æš‚å­˜åŒº<br><code>git add -e [file]</code></li><li>åˆ é™¤å·¥ä½œåŒºæ–‡ä»¶ï¼Œå¹¶ä¸”å°†è¿™æ¬¡åˆ é™¤æ”¾å…¥æš‚å­˜åŒº<br><code>git rm [file1] [file2] ...</code></li><li>åœæ­¢è¿½è¸ªæŒ‡å®šæ–‡ä»¶ï¼Œä½†è¯¥æ–‡ä»¶ä¼šä¿ç•™åœ¨å·¥ä½œåŒº<br><code>git rm --cached [file]</code></li><li>æ”¹åæ–‡ä»¶ï¼Œå¹¶ä¸”å°†è¿™ä¸ªæ”¹åæ”¾å…¥æš‚å­˜åŒº<br><code>git mv [file-original] [file-renamed]</code></li></ul><h1 id="ä»£ç æäº¤"><a href="#ä»£ç æäº¤" class="headerlink" title="ä»£ç æäº¤"></a>ä»£ç æäº¤</h1><ul><li>æäº¤æš‚å­˜åŒºåˆ°ä»“åº“åŒº<br><code>git commit -m [message]</code></li><li>æäº¤æš‚å­˜åŒºçš„æŒ‡å®šæ–‡ä»¶åˆ°ä»“åº“åŒº<br><code>git commit [file1] [file2] ... -m [message]</code></li><li>æäº¤å·¥ä½œåŒºè‡ªä¸Šæ¬¡commitä¹‹åçš„å˜åŒ–ï¼Œç›´æ¥åˆ°ä»“åº“åŒº<br><code>git commit -a</code></li><li>æäº¤æ—¶æ˜¾ç¤ºæ‰€æœ‰diffä¿¡æ¯<br><code>git commit -v</code></li><li>ä½¿ç”¨ä¸€æ¬¡æ–°çš„commitï¼Œæ›¿ä»£ä¸Šä¸€æ¬¡æäº¤<br><em>å¦‚æœä»£ç æ²¡æœ‰ä»»ä½•æ–°å˜åŒ–ï¼Œåˆ™ç”¨æ¥æ”¹å†™ä¸Šä¸€æ¬¡commitçš„æäº¤ä¿¡æ¯</em><br><code>git commit --amend -m [message]</code></li><li>é‡åšä¸Šä¸€æ¬¡commitï¼Œå¹¶åŒ…æ‹¬æŒ‡å®šæ–‡ä»¶çš„æ–°å˜åŒ–<br><code>git commit --amend ...</code></li><li>ä¿®æ”¹æäº¤ä¿¡æ¯<br><code>git rebase HEAD^^ -i</code><br><code>//-i æ˜¯äº¤äº’æ¨¡å¼</code><br><code>//reword ä¿®æ”¹æ³¨é‡Šä¿¡æ¯</code><br><code>//squash ä¸ä¹‹å‰çš„æ³¨é‡Šåˆå¹¶</code></li></ul><h1 id="æš‚å­˜æ•°æ®ï¼ˆStageï¼‰"><a href="#æš‚å­˜æ•°æ®ï¼ˆStageï¼‰" class="headerlink" title="æš‚å­˜æ•°æ®ï¼ˆStageï¼‰"></a>æš‚å­˜æ•°æ®ï¼ˆStageï¼‰</h1><ul><li>æŠŠæ–‡ä»¶å†™å…¥ Stage<br><code>git stash save [file]</code></li><li>æŸ¥çœ‹ Stage åˆ—è¡¨<br><code>git stash list</code></li><li>åº”ç”¨æœ€åä¸€ä¸ª Stage<br><code>git stash pop</code></li><li>åº”ç”¨æŒ‡å®šçš„ Stage<br><code>git stash apply [stash@{1}]</code></li></ul><h1 id="è¿œç¨‹åŒæ­¥"><a href="#è¿œç¨‹åŒæ­¥" class="headerlink" title="è¿œç¨‹åŒæ­¥"></a>è¿œç¨‹åŒæ­¥</h1><ul><li>ä¸‹è½½è¿œç¨‹ä»“åº“çš„æ‰€æœ‰å˜åŠ¨<br><code>git fetch [remote]</code></li><li>ä¸‹è½½è¿œç¨‹ä»“åº“çš„æ‰€æœ‰tag<br><code>git fetch â€”tags</code></li><li>åªä¸‹è½½è¿œç¨‹ä»“åº“çš„åˆ†æ”¯<br><code>git fetch [remote] &lt;æœ¬åœ°master&gt;:&lt;æ–°å»ºåˆ†æ”¯å&gt;</code></li><li>æ˜¾ç¤ºæ‰€æœ‰è¿œç¨‹ä»“åº“<br><code>git remote -v</code></li><li>æ˜¾ç¤ºæŸä¸ªè¿œç¨‹ä»“åº“çš„ä¿¡æ¯<br><code>git remote show [remote]</code></li><li>å¢åŠ ä¸€ä¸ªæ–°çš„è¿œç¨‹ä»“åº“ï¼Œå¹¶å‘½å<br><code>git remote add [shortname] [url]</code></li><li>å–å›è¿œç¨‹ä»“åº“çš„å˜åŒ–ï¼Œå¹¶ä¸æœ¬åœ°åˆ†æ”¯åˆå¹¶<br><code>git pull [remote] [branch]</code></li><li>ä¸Šä¼ æœ¬åœ°æŒ‡å®šåˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“<br><code>git push [remote] [branch]</code></li><li>å¼ºè¡Œæ¨é€å½“å‰åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“ï¼Œå³ä½¿æœ‰å†²çª<br><code>git push [remote] --force</code></li><li>æ¨é€æ‰€æœ‰åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“<br><code>git push [remote] --all</code></li><li>åœ¨å·²æœ‰é¡¹ç›®ä¸­æ·»åŠ å­é¡¹ç›®<br><code>git submodule add [remote] [dir]</code></li></ul><h1 id="æ’¤é”€"><a href="#æ’¤é”€" class="headerlink" title="æ’¤é”€"></a>æ’¤é”€</h1><ul><li>æ¢å¤æš‚å­˜åŒºçš„æŒ‡å®šæ–‡ä»¶åˆ°å·¥ä½œåŒº<br><code>git checkout [file]</code></li><li>æ¢å¤æŸä¸ªcommitçš„æŒ‡å®šæ–‡ä»¶åˆ°å·¥ä½œåŒº<br><code>git checkout [commit] [file]</code></li><li>æ¢å¤ä¸Šä¸€ä¸ªcommitçš„æ‰€æœ‰æ–‡ä»¶åˆ°å·¥ä½œåŒº<br><code>git checkout .</code></li><li>é‡ç½®æš‚å­˜åŒºçš„æŒ‡å®šæ–‡ä»¶ï¼Œä¸ä¸Šä¸€æ¬¡commitä¿æŒä¸€è‡´ï¼Œä½†å·¥ä½œåŒºä¸å˜<br><code>git reset [file]</code></li><li>é‡ç½®æš‚å­˜åŒºä¸å·¥ä½œåŒºï¼Œä¸ä¸Šä¸€æ¬¡commitä¿æŒä¸€è‡´<br><code>git reset --hard</code></li><li>é‡ç½®æš‚å­˜åŒºï¼Œä¿ç•™å·²ä¿®æ”¹<br><code>git reset â€”soft</code></li><li>é‡ç½®å½“å‰åˆ†æ”¯çš„æŒ‡é’ˆä¸ºæŒ‡å®šcommitï¼ŒåŒæ—¶é‡ç½®æš‚å­˜åŒºï¼Œä½†å·¥ä½œåŒºä¸å˜<br><code>git reset [commit]</code></li><li>é‡ç½®å½“å‰åˆ†æ”¯çš„HEADä¸ºæŒ‡å®šcommitï¼ŒåŒæ—¶é‡ç½®æš‚å­˜åŒºå’Œå·¥ä½œåŒºï¼Œä¸æŒ‡å®šcommitä¸€è‡´<br><code>git reset --hard [commit]</code></li><li>é‡ç½®å½“å‰HEADä¸ºæŒ‡å®šcommitï¼Œä½†ä¿æŒæš‚å­˜åŒºå’Œå·¥ä½œåŒºä¸å˜<br><code>git reset --keep [commit]</code></li><li>æ–°å»ºä¸€ä¸ªcommitï¼Œç”¨æ¥æ’¤é”€æŒ‡å®šcommit<br><code>#_åè€…çš„æ‰€æœ‰å˜åŒ–éƒ½å°†è¢«å‰è€…æŠµæ¶ˆï¼Œå¹¶ä¸”åº”ç”¨åˆ°å½“å‰åˆ†æ”¯_</code><br><code>git revert [commit]</code></li></ul><h1 id="åˆ†æ”¯"><a href="#åˆ†æ”¯" class="headerlink" title="åˆ†æ”¯"></a>åˆ†æ”¯</h1><ul><li>åˆ—å‡ºæ‰€æœ‰æœ¬åœ°åˆ†æ”¯<br><code>git branch</code></li><li>åˆ—å‡ºæ‰€æœ‰è¿œç¨‹åˆ†æ”¯<br><code>git branch -r</code></li><li>åˆ—å‡ºæ‰€æœ‰æœ¬åœ°åˆ†æ”¯å’Œè¿œç¨‹åˆ†æ”¯<br><code>git branch -a</code></li><li>æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œä½†ä¾ç„¶åœç•™åœ¨å½“å‰åˆ†æ”¯<br><code>git branch [branch-name]</code></li><li>æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œå¹¶åˆ‡æ¢åˆ°è¯¥åˆ†æ”¯<br><code>git checkout -b [branch]</code></li><li>æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼ŒæŒ‡å‘æŒ‡å®šcommit<br><code>git branch [branch] [commit]</code></li><li>æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼Œä¸æŒ‡å®šçš„è¿œç¨‹åˆ†æ”¯å»ºç«‹è¿½è¸ªå…³ç³»<br><code>git branch --track [branch] [remote-branch]</code></li><li>åˆ‡æ¢åˆ°æŒ‡å®šåˆ†æ”¯ï¼Œå¹¶æ›´æ–°å·¥ä½œåŒº<br><code>git checkout [branch-name]</code></li><li>å»ºç«‹è¿½è¸ªå…³ç³»ï¼Œåœ¨ç°æœ‰åˆ†æ”¯ä¸æŒ‡å®šçš„è¿œç¨‹åˆ†æ”¯ä¹‹é—´<br><code>git branch --set-upstream [branch] [remote-branch]</code></li><li>åˆå¹¶æŒ‡å®šåˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯<br><code>git merge [branch]</code></li><li>ä¿ç•™ commit ä¿¡æ¯ï¼ˆå³ä½¿åœ¨ fast-forwardæ¨¡å¼ï¼‰<br><code>git merge â€“no-ff [branch]</code></li><li>åˆå¹¶å¤šä¸ªcommitä¸ºä¸€æ¬¡æäº¤<br><code>git merge â€”squash [branch]</code></li><li>é€‰æ‹©ä¸€ä¸ªcommitï¼Œåˆå¹¶è¿›å½“å‰åˆ†æ”¯<br><code>git cherry-pick [commit]</code></li><li>åˆ é™¤åˆ†æ”¯<br><code>git branch -d [branch-name]</code></li><li>åˆ é™¤è¿œç¨‹åˆ†æ”¯<br><code>git push origin --delete</code><br><code>git branch -dr</code></li><li>è¡åˆåˆ†æ”¯åˆ°ä¸»å¹²<br><code>git checkout [branch]</code><br><code>git rebase [master]</code></li><li>åˆå¹¶åˆ†æ”¯åˆ°ä¸»å¹²<br><code>git checkout [master]</code><br><code>git merge [branch]</code></li></ul><h1 id="æ ‡ç­¾"><a href="#æ ‡ç­¾" class="headerlink" title="æ ‡ç­¾"></a>æ ‡ç­¾</h1><p><strong>è‹¥ tag å’Œ branch é‡åï¼Œæ“ä½œæ—¶å¯æŒ‡å®šï¼Œæ¯”å¦‚ï¼štags/v2</strong></p><ul><li>åˆ—å‡ºæ‰€æœ‰tag<br><code>git tag</code></li><li>æ–°å»ºä¸€ä¸ªtagåœ¨å½“å‰commit<br><code>git tag [tag]</code></li><li>æ–°å»ºä¸€ä¸ªtagåœ¨æŒ‡å®šcommit<br><code>git tag [tag] [commit]</code></li><li>æŸ¥çœ‹tagä¿¡æ¯<br><code>git show [tag]</code></li><li>æäº¤æŒ‡å®štag<br><code>git push [remote] [tag]</code></li><li>æäº¤æ‰€æœ‰tag<br><code>git push [remote] --tags</code></li><li>æ–°å»ºä¸€ä¸ªåˆ†æ”¯ï¼ŒæŒ‡å‘æŸä¸ªtag<br><code>git checkout -b [branch] [tag]</code></li></ul><h1 id="æŸ¥çœ‹ä¿¡æ¯"><a href="#æŸ¥çœ‹ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹ä¿¡æ¯"></a>æŸ¥çœ‹ä¿¡æ¯</h1><p><strong>å¤šä¸ªæ¡ä»¶é»˜è®¤æ˜¯or å…³ç³»ï¼Œä½¿ç”¨ â€“all-match å˜ä¸º AND å…³ç³»</strong></p><ul><li>æ˜¾ç¤ºæœ‰å˜æ›´çš„æ–‡ä»¶<br><code>git status</code></li><li>æ˜¾ç¤ºå½“å‰åˆ†æ”¯çš„ç‰ˆæœ¬å†å²<br><code>git log</code></li><li>æ˜¾ç¤ºcommitå†å²ï¼Œä»¥åŠæ¯æ¬¡commitå‘ç”Ÿå˜æ›´çš„æ–‡ä»¶<br><code>git log --stat</code></li><li>æ˜¾ç¤ºæŸä¸ªæ–‡ä»¶çš„ç‰ˆæœ¬å†å²ï¼ŒåŒ…æ‹¬æ–‡ä»¶æ”¹å<br><code>git log --follow [file]</code><br><code>git whatchanged [file]</code></li><li>æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶ç›¸å…³çš„æ¯ä¸€æ¬¡diff<br><code>git log -p [file]</code></li><li>æ˜¾ç¤ºä¸¤ä¸ª tag ä¹‹é—´çš„ç‰ˆæœ¬å†å²<br><code>git log [tag1]â€¦[tag2]</code></li><li>æ˜¾ç¤ºæŒ‡å®šæ—¶é—´èŒƒå›´çš„ç‰ˆæœ¬å†å²<br><code>git log --since=2.months.ago --until=1.day.ago</code></li><li>æ˜¾ç¤ºåœ¨åˆ†æ”¯2è€Œä¸åœ¨åˆ†æ”¯1ä¸Šçš„ç‰ˆæœ¬å†å²ï¼ˆbranch2æ²¡æœ‰æäº¤çš„å†å²ï¼‰<br><code>git log [old_branch1]â€¦[new_branch2]</code></li><li>æœç´¢ç‰¹å®šæäº¤è€…<br><code>git log â€”author=[name]</code></li><li>æœç´¢å†å²ä¿¡æ¯<br><code>git log â€”grep=&#39;search message&#39;</code></li><li>æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶æ˜¯ä»€ä¹ˆäººåœ¨ä»€ä¹ˆæ—¶é—´ä¿®æ”¹è¿‡<br><code>git blame [file]</code></li><li>æ˜¾ç¤ºæš‚å­˜åŒºå’Œå·¥ä½œåŒºçš„å·®å¼‚<br><code>git diff</code></li><li>æ˜¾ç¤ºæš‚å­˜åŒºå’Œä¸Šä¸€ä¸ªcommitçš„å·®å¼‚<br><code>git diff --cached</code></li><li>æ˜¾ç¤ºå·¥ä½œåŒºä¸å½“å‰åˆ†æ”¯æœ€æ–°commitä¹‹é—´çš„å·®å¼‚<br><code>git diff HEAD</code></li><li>æ˜¾ç¤ºä¸¤æ¬¡æäº¤ä¹‹é—´çš„å·®å¼‚<br><code>git diff [first-branch]...[second-branch]</code></li><li>æ˜¾ç¤ºæŸæ¬¡æäº¤çš„å…ƒæ•°æ®å’Œå†…å®¹å˜åŒ–<br><code>git show [commit]</code></li><li>æ˜¾ç¤ºæŸæ¬¡æäº¤å‘ç”Ÿå˜åŒ–çš„æ–‡ä»¶<br><code>git show --name-only [commit]</code></li><li>æ˜¾ç¤ºæŸæ¬¡æäº¤æ—¶ï¼ŒæŸä¸ªæ–‡ä»¶çš„å†…å®¹<br><code>git show [commit]:[filename]</code></li><li>æ˜¾ç¤ºåˆ†æ”¯å‘ç”Ÿçš„å˜åŒ–<br><code>git show [branch]</code></li><li>æ˜¾ç¤ºæœ€åä¸€æ¬¡æäº¤å‘ç”Ÿçš„å˜åŒ–<br><code>git show HEAD</code></li><li>æ˜¾ç¤ºå½“å‰åˆ†æ”¯çš„æœ€è¿‘å‡ æ¬¡æäº¤<br><code>git reflog</code></li><li>æŸ¥æ‰¾ä¿¡æ¯<br><code>git grep [pattern] [search_scope]</code></li><li>æŸ¥çœ‹åˆ†æ”¯é—´çš„å…³ç³»<br><code>git show-branch</code><br><code>//(åŠ å·)è¡¨ç¤ºæ‰€åœ¨åˆ†æ”¯ åŒ…å« æ­¤è¡Œæ‰€æ ‡è¯†çš„ commit</code><br><code>//(ç©ºæ ¼)è¡¨ç¤ºæ‰€åœ¨åˆ†æ”¯ ä¸åŒ…å« æ­¤è¡Œæ‰€æ ‡è¯†çš„ commit</code><br><code>//(å‡å·)è¡¨ç¤ºæ‰€åœ¨åˆ†æ”¯æ˜¯ç»è¿‡ merge å¾—åˆ°çš„,è€Œæ‰€åœ¨è¡Œçš„å†…å®¹å³æ˜¯ merge çš„åŸºæœ¬ä¿¡æ¯</code><br><code>//(æ˜Ÿå·)è¡¨ç¤ºå¦‚æœéœ€è¦åœ¨æŸåˆ—æ ‡è¯†+(åŠ å·),ä¸”æ­¤åˆ—ä¸ºå½“å‰åˆ†æ”¯æ‰€åœ¨åˆ—,é‚£ä¹ˆåˆ™å°†+(åŠ å·)è½¬å˜ä¸º*(æ˜Ÿå·)</code></li><li>æ˜¾ç¤ºä¸¤ä¸ªåˆ†æ”¯çš„å·®å¼‚<br><code>git whatchanged -p [branch1]â€¦[branch2]</code></li></ul><h1 id="å…¶ä»–å‘½ä»¤"><a href="#å…¶ä»–å‘½ä»¤" class="headerlink" title="å…¶ä»–å‘½ä»¤"></a>å…¶ä»–å‘½ä»¤</h1><ul><li>ä»“åº“ç§»äº†ä½ç½®<br><code>git remote set-url origin &lt;new repo addr&gt;</code></li><li>ç”Ÿæˆä¸€ä¸ªå¯ä¾›å‘å¸ƒçš„å‹ç¼©åŒ…<br><code>git archive</code></li><li>å‹ç¼©ä¿¡æ¯ï¼Œæ¸…ç†åƒåœ¾<br><code>git gc</code></li><li>ä¸€è‡´æ€§æ£€æŸ¥<br><code>git fsck</code></li><li>æŸ¥çœ‹å¯¹è±¡æ•°æ®åº“<br><code>#å››ç§å¯¹è±¡ç±»å‹ï¼šblobã€commitã€tagã€tree</code><br><code>#commit æŒ‡å‘ tree</code><br><code>#tree æ˜¾ç¤ºä¸€ä¸ªç›®å½•çš„çŠ¶æ€ï¼ŒæŒ‡å‘ tree æˆ–è€… blob</code></li><li>æ˜¾ç¤ºå¯¹è±¡ç±»å‹<br><code>git cat-file -t [ID]</code></li><li>æ˜¾ç¤ºå¯¹è±¡ä¿¡æ¯<br><code>git cat-file [type] [ID]</code></li><li>æ˜¾ç¤º tree ä¿¡æ¯<br><code>git ls-tree [ID]</code></li></ul><h1 id="å¿½ç•¥æœ¬åœ°ä¿®æ”¹"><a href="#å¿½ç•¥æœ¬åœ°ä¿®æ”¹" class="headerlink" title="å¿½ç•¥æœ¬åœ°ä¿®æ”¹"></a>å¿½ç•¥æœ¬åœ°ä¿®æ”¹</h1><ul><li>å¿½ç•¥æœ¬åœ°ä¿®æ”¹ï¼ˆä»“åº“å­˜åœ¨ï¼‰<br><code>git update-index --assume-unchanged [file]</code></li><li>åˆ é™¤å¿½ç•¥çš„æœ¬åœ°ä¿®æ”¹<br><code>git update-index --no-assume-unchanged [file]</code></li></ul><h1 id="æ„å¤–æƒ…å†µ"><a href="#æ„å¤–æƒ…å†µ" class="headerlink" title="æ„å¤–æƒ…å†µ"></a>æ„å¤–æƒ…å†µ</h1><ul><li>æ‰¾å›åˆ é™¤çš„æ–‡ä»¶<br><code>git reflog / git fsck --lost-found</code><br><code>git checkout [hashå€¼]</code></li><li>ä»æœ¬åœ°åˆ†æ”¯ç”Ÿæˆ patchï¼ˆç”¨äº email æäº¤ï¼‰<br><code>git format-patch origin</code></li><li>ä¸ä¸»å¹²åŒæ­¥<br><code>git fetch origin</code><br><code>git rebase origin/master</code></li><li>æäº¤åˆ°äº†é”™è¯¯çš„åˆ†æ”¯<br><code>git branch experimental //åˆ›å»ºä¸€ä¸ªæŒ‡å‘å½“å‰masterçš„ä½ç½®çš„æŒ‡é’ˆ</code><br><code>git reset --hard master~3 //ç§»åŠ¨masteråˆ†æ”¯çš„æŒ‡é’ˆåˆ°3ä¸ªç‰ˆæœ¬ä¹‹å‰</code><br><code>git checkout experimental</code></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;å·¥ä½œæµç¨‹å›¾&quot;&gt;&lt;a href=&quot;#å·¥ä½œæµç¨‹å›¾&quot; class=&quot;he
      
    
    </summary>
    
      <category term="2-å¼€å‘æŠ€èƒ½" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/"/>
    
      <category term="GIT" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/GIT/"/>
    
    
      <category term="git" scheme="http://yoursite.com/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>TCP/IP åè®®</title>
    <link href="http://yoursite.com/1-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/tcp-ip-%E5%8D%8F%E8%AE%AE/"/>
    <id>http://yoursite.com/1-åŸºç¡€çŸ¥è¯†/è®¡ç®—æœºç½‘ç»œ/tcp-ip-åè®®/</id>
    <published>2017-11-11T03:00:00.000Z</published>
    <updated>2017-12-03T16:04:44.536Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>æŒ‡ä»£æ•´ä¸ªåè®®æ—ï¼›ä¹‹æ‰€ä»¥å«<code>TCP/IPåè®®</code>ï¼Œæ˜¯å› ä¸º<code>TCP</code>ã€<code>IP</code>æ˜¯æ ¸å¿ƒçš„åè®®ã€‚</p><h1 id="ä¼ è¾“å±‚"><a href="#ä¼ è¾“å±‚" class="headerlink" title="ä¼ è¾“å±‚"></a>ä¼ è¾“å±‚</h1><h2 id="TCP-åè®®"><a href="#TCP-åè®®" class="headerlink" title="TCP åè®®"></a>TCP åè®®</h2><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><blockquote><p>TCPï¼ˆTransmission Control Protocol ä¼ è¾“æ§åˆ¶åè®®ï¼‰æ˜¯ä¸€ç§é¢å‘è¿æ¥çš„ã€å¯é çš„ã€åŸºäºå­—èŠ‚æµçš„ä¼ è¾“å±‚é€šä¿¡åè®®ï¼Œç”±IETFçš„RFC 793å®šä¹‰</p></blockquote><h3 id="æ•°æ®ä¼ è¾“"><a href="#æ•°æ®ä¼ è¾“" class="headerlink" title="æ•°æ®ä¼ è¾“"></a>æ•°æ®ä¼ è¾“</h3><p><img src="/images/2017/11/tcp-transfer.png" alt="tcp-transfer"></p><h4 id="ä¸‰æ¬¡æ¡æ‰‹"><a href="#ä¸‰æ¬¡æ¡æ‰‹" class="headerlink" title="ä¸‰æ¬¡æ¡æ‰‹"></a>ä¸‰æ¬¡æ¡æ‰‹</h4><p><strong>WHY</strong></p><blockquote><p><strong>ä¸ºä»€ä¹ˆè¦ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ</strong><br>ä¸ºäº†é˜²æ­¢å·²å¤±æ•ˆçš„å®¢æˆ·ç«¯è¿æ¥è¯·æ±‚çªç„¶åˆä¼ é€åˆ°äº†æœåŠ¡ç«¯ï¼Œè‹¥æ²¡æœ‰å®¢æˆ·ç«¯ç¡®è®¤ï¼Œåˆ™ä¼šå ç”¨æœåŠ¡ç«¯çš„èµ„æºã€‚</p></blockquote><p><strong>HOW</strong></p><p><img src="/images/2017/11/tcp-ä¸‰æ¬¡æ¡æ‰‹.png" alt="tcp ä¸‰æ¬¡æ¡æ‰‹"></p><table><thead><tr><th>å®¢æˆ·ç«¯</th><th>ä¼ è¾“</th><th>æœåŠ¡ç«¯</th></tr></thead><tbody><tr><td>SYN(x)</td><td>-&gt;</td><td>SYN(x)</td></tr><tr><td>SYN(y)-ACK(x+1)</td><td>&lt;-</td><td>SYN(y)+ACK(x+1)</td></tr><tr><td>ACK(y+1)</td><td>-&gt;</td><td>ACK(Y+1)</td></tr></tbody></table><blockquote><p>å¿…é¡»æ˜¯å®¢æˆ·ç«¯å‘èµ·çš„SYN</p></blockquote><p>SYN: åŒæ­¥åºåˆ—ç¼–å·ï¼ˆSynchronize Sequence Numbersï¼‰<br>ACK: ç¡®è®¤ç¼–å·ï¼ˆAcknowledgement Numberï¼‰</p><h4 id="å››æ¬¡æŒ¥æ‰‹"><a href="#å››æ¬¡æŒ¥æ‰‹" class="headerlink" title="å››æ¬¡æŒ¥æ‰‹"></a>å››æ¬¡æŒ¥æ‰‹</h4><p><strong>WHY</strong></p><blockquote><p><strong>ä¸ºä»€ä¹ˆè¦å››æ¬¡æŒ¥æ‰‹ï¼Ÿ</strong><br>å…¨åŒå·¥é€šä¿¡ï¼Œæ‰€ä»¥å¿…é¡»åŒæ–¹éƒ½ç¡®è®¤ FIN æ‰å¯ä»¥å…³é—­è¿æ¥</p></blockquote><p><strong>HOW</strong></p><p><img src="/images/2017/11/tcp-å››æ¬¡æŒ¥æ‰‹.png" alt="tcp-å››æ¬¡æŒ¥æ‰‹"></p><table><thead><tr><th>å®¢æˆ·ç«¯</th><th>ä¼ è¾“</th><th>æœåŠ¡ç«¯</th></tr></thead><tbody><tr><td>FIN(å®¢æˆ·ç«¯ä¼ è¾“å®Œæ¯•)</td><td>-&gt;</td><td>FIN</td></tr><tr><td>ACK</td><td>&lt;-</td><td>ACKï¼ˆå…ˆç¡®è®¤ï¼‰</td></tr><tr><td>FIN</td><td>&lt;-</td><td>FIN ï¼ˆæœåŠ¡ç«¯ä¼ è¾“å®Œæ¯•ï¼‰</td></tr><tr><td>ACK</td><td>-&gt;</td><td>ACK</td></tr></tbody></table><blockquote><p>å®¢æˆ·ç«¯ã€æœåŠ¡ç«¯éƒ½å¯ä»¥å‘èµ· FIN</p></blockquote><p>FIN: æ•°æ®ä¼ è¾“å®Œæ¯• (Finsh)</p><h3 id="åŒ…å¤´ç»“æ„"><a href="#åŒ…å¤´ç»“æ„" class="headerlink" title="åŒ…å¤´ç»“æ„"></a>åŒ…å¤´ç»“æ„</h3><table><thead><tr><th>åç§°</th><th>é•¿åº¦</th></tr></thead><tbody><tr><td>æºç«¯å£</td><td>16ä½</td></tr><tr><td>ç›®æ ‡ç«¯å£</td><td>16ä½</td></tr><tr><td>åºåˆ—å·</td><td>32ä½</td></tr><tr><td>å›åº”åºå·</td><td>32ä½</td></tr><tr><td>TCPå¤´é•¿åº¦</td><td>4ä½</td></tr><tr><td>reserved</td><td>6ä½</td></tr><tr><td>æ§åˆ¶ä»£ç </td><td>6ä½</td></tr><tr><td>çª—å£å¤§å°</td><td>16ä½</td></tr><tr><td>åç§»é‡</td><td>16ä½</td></tr><tr><td>æ ¡éªŒå’Œ</td><td>16ä½</td></tr><tr><td>é€‰é¡¹</td><td>32ä½(å¯é€‰)</td></tr></tbody></table><blockquote><p>TCPåŒ…å¤´çš„æœ€å°é•¿åº¦ï¼Œä¸º20å­—èŠ‚ã€‚</p></blockquote><h2 id="UDP-åè®®"><a href="#UDP-åè®®" class="headerlink" title="UDP åè®®"></a>UDP åè®®</h2><h3 id="å®šä¹‰-1"><a href="#å®šä¹‰-1" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>ä¸€ç§æ— è¿æ¥çš„ä¼ è¾“å±‚åè®®ï¼›å¯é æ€§é€šè¿‡ã€Œåº”ç”¨å±‚ã€ä¿è¯ã€‚</p><h3 id="æ•°æ®ä¼ è¾“-1"><a href="#æ•°æ®ä¼ è¾“-1" class="headerlink" title="æ•°æ®ä¼ è¾“"></a>æ•°æ®ä¼ è¾“</h3><p>ä¸æä¾›æ•°æ®åŒ…åˆ†ç»„ã€ç»„è£…å’Œä¸èƒ½å¯¹æ•°æ®åŒ…è¿›è¡Œæ’åº</p><h3 id="åŒ…å¤´ç»“æ„-1"><a href="#åŒ…å¤´ç»“æ„-1" class="headerlink" title="åŒ…å¤´ç»“æ„"></a>åŒ…å¤´ç»“æ„</h3><table><thead><tr><th>åç§°</th><th>é•¿åº¦</th></tr></thead><tbody><tr><td>æºç«¯å£</td><td>16ä½</td></tr><tr><td>ç›®çš„ç«¯å£</td><td>16ä½</td></tr><tr><td>é•¿åº¦</td><td>16ä½</td></tr><tr><td>æ ¡éªŒå’Œ</td><td>16ä½</td></tr></tbody></table><blockquote><p>UDPåŒ…å¤´åªæœ‰8ä¸ªå­—èŠ‚</p></blockquote><h3 id="å¸¸è§çš„åè®®"><a href="#å¸¸è§çš„åè®®" class="headerlink" title="å¸¸è§çš„åè®®"></a>å¸¸è§çš„åè®®</h3><p>DNS</p><h3 id="åº”ç”¨åœºæ™¯ï¼š"><a href="#åº”ç”¨åœºæ™¯ï¼š" class="headerlink" title="åº”ç”¨åœºæ™¯ï¼š"></a>åº”ç”¨åœºæ™¯ï¼š</h3><ol><li>é¢å‘æ•°æ®æŠ¥æ–¹å¼</li><li>ç½‘ç»œæ•°æ®å¤§å¤šä¸ºçŸ­æ¶ˆæ¯</li><li>æ‹¥æœ‰å¤§é‡Client</li><li>å¯¹æ•°æ®å®‰å…¨æ€§æ— ç‰¹æ®Šè¦æ±‚</li><li>ç½‘ç»œè´Ÿæ‹…éå¸¸é‡ï¼Œä½†å¯¹å“åº”é€Ÿåº¦è¦æ±‚é«˜</li></ol><h2 id="TCP-vs-UDP"><a href="#TCP-vs-UDP" class="headerlink" title="TCP vs UDP"></a>TCP vs UDP</h2><table><thead><tr><th>-</th><th>TCP</th><th>UDP</th></tr></thead><tbody><tr><td>å¯é æ€§</td><td>å¯é ï¼ˆé¢å‘è¿æ¥ï¼‰</td><td>ä¸å¯é ï¼ˆæ— è¿æ¥ï¼‰</td></tr><tr><td>æœ‰åºæ€§</td><td>æœ‰åº</td><td>æ— åº</td></tr><tr><td>å ç”¨èµ„æº</td><td>å¤š</td><td>å°‘</td></tr><tr><td>ç¨‹åºç»“æ„</td><td>å¤æ‚</td><td>ç®€å•</td></tr><tr><td>æ•°æ®æ¨¡å¼</td><td>æ•°æ®æµ<sup id="fnref:1"><a href="#fn:1" rel="footnote"><span class="hint--top-right hint--error hint--large" aria-label="å¯ä»¥åˆå¹¶å¤šä¸ªè¯·æ±‚æ•°æ®(æ”¾åœ¨ç¼“å†²åŒºä¸­)ï¼Œä¸€æ¬¡/å¤šæ¬¡è¯»å–å®Œ">[1]</span></a></sup>ï¼ˆå­—èŠ‚æµï¼‰</td><td>æ•°æ®æŠ¥æ–‡<sup id="fnref:2"><a href="#fn:2" rel="footnote"><span class="hint--top-right hint--error hint--large" aria-label="å‘é€å‡ æ¬¡è¯·æ±‚ï¼Œå°±éœ€è¦æ¥æ”¶å‡ æ¬¡ï¼›ä¸€æ¬¡åªèƒ½è¯»å–ä¸€ä¸ªå®Œæ•´çš„æŠ¥æ–‡">[2]</span></a></sup></td></tr><tr><td>é€šä¿¡æ¨¡å¼</td><td>ç‚¹å¯¹ç‚¹</td><td>ä¸€å¯¹ä¸€ï¼Œä¸€å¯¹å¤šï¼Œå¤šå¯¹ä¸€ï¼Œå¤šå¯¹å¤š</td></tr><tr><td>é¦–éƒ¨å¼€é”€</td><td>20å­—èŠ‚</td><td>8å­—èŠ‚</td></tr><tr><td>é€šä¿¡ä¿¡é“</td><td>å…¨åŒå·¥</td><td>ä¸å¯é ä¿¡é“</td></tr></tbody></table><h1 id="ç½‘ç»œå±‚"><a href="#ç½‘ç»œå±‚" class="headerlink" title="ç½‘ç»œå±‚"></a>ç½‘ç»œå±‚</h1><h2 id="IP-åè®®"><a href="#IP-åè®®" class="headerlink" title="IP åè®®"></a>IP åè®®</h2><h3 id="ä½œç”¨"><a href="#ä½œç”¨" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h3><p>IPåè®®æ˜¯<code>TCP/IPåè®®ç°‡</code>ä¸­çš„æ ¸å¿ƒåè®®ï¼Œä¹Ÿæ˜¯<code>TCP/IP</code>çš„è½½ä½“ã€‚<br>æ‰€æœ‰çš„<code>TCPï¼ŒUDPï¼ŒICMPåŠIGMPæ•°æ®</code>éƒ½ä»¥ <strong>IPæ•°æ®æŠ¥</strong> æ ¼å¼ä¼ è¾“ã€‚<br>IPæä¾›<strong>ä¸å¯é </strong>çš„ï¼Œ<strong>æ— è¿æ¥</strong>çš„æ•°æ®ä¼ é€æœåŠ¡ï¼›å¦‚æœ<strong>å‘ç”ŸæŸç§é”™è¯¯ï¼ŒIPä¼šä¸¢å¤±è¯¥æ•°æ®ï¼Œç„¶åå‘é€ICMPæ¶ˆæ¯ç»™ä¿¡æºç«¯</strong></p><h3 id="IPæ•°æ®æŠ¥"><a href="#IPæ•°æ®æŠ¥" class="headerlink" title="IPæ•°æ®æŠ¥"></a>IPæ•°æ®æŠ¥</h3><p><img src="/images/2017/11/ip1.png" alt="ip1"><br><img src="/images/2017/11/ip2.png" alt="ip2"></p><h3 id="IPè·¯ç”±é€‰æ‹©"><a href="#IPè·¯ç”±é€‰æ‹©" class="headerlink" title="IPè·¯ç”±é€‰æ‹©"></a>IPè·¯ç”±é€‰æ‹©</h3><h4 id="å±€åŸŸç½‘"><a href="#å±€åŸŸç½‘" class="headerlink" title="å±€åŸŸç½‘"></a>å±€åŸŸç½‘</h4><p>ç»è¿‡<strong>ARPåè®®</strong>å°†ç›®çš„ä¸»æœºçš„IPåœ°å€è§£æä¸ºMACåœ°å€</p><h4 id="éå±€åŸŸç½‘"><a href="#éå±€åŸŸç½‘" class="headerlink" title="éå±€åŸŸç½‘"></a>éå±€åŸŸç½‘</h4><p>ä¸»æœºé€šè¿‡IPæ•°æ®æŠ¥è¿æ¥ç›®çš„ä¸»æœºæ—¶ï¼ŒæŒ‰ç…§å¦‚ä¸‹æ­¥éª¤æœç´¢:</p><ol><li>æœç´¢è·¯ç”±è¡¨ï¼Œä¼˜å…ˆæœç´¢<strong>åŒ¹é…ä¸»æœº</strong>ï¼Œå¦‚æœèƒ½æ‰¾åˆ°å’ŒIPåœ°å€å®Œå…¨ä¸€è‡´çš„ç›®æ ‡ä¸»æœºï¼Œåˆ™å°†è¯¥åŒ…å‘å‘ç›®æ ‡ä¸»æœº</li><li>æœç´¢è·¯ç”±è¡¨ï¼Œå¦‚æœåŒ¹é…ä¸»æœºå¤±è´¥ï¼Œåˆ™åŒ¹é…<strong>åŒå­ç½‘çš„è·¯ç”±å™¨</strong>ï¼Œè¿™éœ€è¦å­ç½‘æ©ç çš„ååŠ©ã€‚å¦‚æœæ‰¾åˆ°è·¯ç”±å™¨ï¼Œåˆ™å°†è¯¥åŒ…å‘å‘è·¯ç”±å™¨ã€‚</li><li>æœç´¢è·¯ç”±è¡¨ï¼Œå¦‚æœåŒ¹é…åŒå­ç½‘è·¯ç”±å™¨å¤±è´¥ï¼Œåˆ™åŒ¹é…<strong>åŒç½‘å·è·¯ç”±å™¨</strong>ï¼Œå¦‚æœæ‰¾åˆ°è·¯ç”±å™¨ï¼Œåˆ™å°†è¯¥åŒ…å‘å‘è·¯ç”±å™¨ã€‚</li><li>æœç´¢è·¯ç”±è¡¨ï¼Œå¦‚æœä»¥ä¸Šéƒ½å¤±è´¥äº†ï¼Œå°±<strong>æœç´¢é»˜è®¤è·¯ç”±</strong>ï¼Œå¦‚æœé»˜è®¤è·¯ç”±å­˜åœ¨ï¼Œåˆ™å‘åŒ…</li><li>å¦‚æœéƒ½å¤±è´¥äº†ï¼Œå°±ä¸¢æ‰è¿™ä¸ªåŒ…ã€‚</li></ol><h3 id="å¦‚ä½•æŸ¥çœ‹è·¯ç”±è¡¨"><a href="#å¦‚ä½•æŸ¥çœ‹è·¯ç”±è¡¨" class="headerlink" title="å¦‚ä½•æŸ¥çœ‹è·¯ç”±è¡¨"></a>å¦‚ä½•æŸ¥çœ‹è·¯ç”±è¡¨</h3><p><img src="/images/2017/11/ip-router.png" alt="ip-router"></p><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li><a href="https://en.wikipedia.org/wiki/Transmission_Control_Protocol" rel="external nofollow noopener noreferrer" target="_blank">ç»´åŸºç™¾ç§‘-TCP</a></li><li><a href="https://baike.baidu.com/item/TCP/33012?fr=aladdin" rel="external nofollow noopener noreferrer" target="_blank">ç™¾ç§‘-TCP</a></li><li><a href="http://network.51cto.com/art/201411/456783.htm" rel="external nofollow noopener noreferrer" target="_blank">CDSN-TCP</a></li><li><a href="http://blog.csdn.net/houdong/article/details/1505798" rel="external nofollow noopener noreferrer" target="_blank">IPåè®®-CSDN</a></li><li><a href="https://jingyan.baidu.com/article/36d6ed1f56b9fe1bce48837f.html" rel="external nofollow noopener noreferrer" target="_blank">IPåè®®-ç™¾åº¦ç»éªŒ</a></li></ul><!--ä»¥ä¸‹æ˜¯è„šæ³¨--><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style: none; padding-left: 0; margin-left: 40px"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">1.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">å¯ä»¥åˆå¹¶å¤šä¸ªè¯·æ±‚æ•°æ®(æ”¾åœ¨ç¼“å†²åŒºä¸­)ï¼Œä¸€æ¬¡/å¤šæ¬¡è¯»å–å®Œ<a href="#fnref:1" rev="footnote"> â†©</a></span></li><li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">2.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">å‘é€å‡ æ¬¡è¯·æ±‚ï¼Œå°±éœ€è¦æ¥æ”¶å‡ æ¬¡ï¼›ä¸€æ¬¡åªèƒ½è¯»å–ä¸€ä¸ªå®Œæ•´çš„æŠ¥æ–‡<a href="#fnref:2" rev="footnote"> â†©</a></span></li></ol></div></div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;p&gt;æŒ‡ä»£æ•´ä¸ªåè®®æ—ï¼›ä¹‹æ‰€ä»¥å«&lt;code&gt;TCP/IPåè®®&lt;/code&gt;ï¼Œæ˜¯å› ä¸º&lt;
      
    
    </summary>
    
      <category term="1-åŸºç¡€çŸ¥è¯†" scheme="http://yoursite.com/categories/1-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
      <category term="è®¡ç®—æœºç½‘ç»œ" scheme="http://yoursite.com/categories/1-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"/>
    
    
  </entry>
  
  <entry>
    <title>ç½‘ç»œå‚è€ƒæ¨¡å‹</title>
    <link href="http://yoursite.com/1-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%BB%9C%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B/"/>
    <id>http://yoursite.com/1-åŸºç¡€çŸ¥è¯†/è®¡ç®—æœºç½‘ç»œ/ç½‘ç»œå‚è€ƒæ¨¡å‹/</id>
    <published>2017-11-10T18:52:00.000Z</published>
    <updated>2018-01-01T08:26:51.773Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="OSI-å‚è€ƒæ¨¡å‹"><a href="#OSI-å‚è€ƒæ¨¡å‹" class="headerlink" title="OSI å‚è€ƒæ¨¡å‹"></a>OSI å‚è€ƒæ¨¡å‹</h1><blockquote><p><strong>å›½é™…æ ‡å‡†åŒ–ç»„ç»‡(ISO)</strong> å’Œ <strong>å›½é™…ç”µæŠ¥ç”µè¯å’¨è¯¢å§”å‘˜ä¼š(CCITT)</strong> è”åˆåˆ¶å®šäº† <strong>OSIï¼ˆOpen System Interconnectï¼‰</strong></p></blockquote><h2 id="WHY"><a href="#WHY" class="headerlink" title="WHY"></a>WHY</h2><p>OSIå‚è€ƒæ¨¡å‹æ˜¯è®¡ç®—æœºç½‘è·¯ä½“ç³»ç»“æ„å‘å±•çš„äº§ç‰©ï¼›å…¶ç›®çš„æ˜¯ä¸ºå¼‚ç§è®¡ç®—æœºäº’è¿æä¾› <strong>ä¸€ä¸ªå…±åŒçš„åŸºç¡€å’Œæ ‡å‡†æ¡†æ¶</strong> ï¼Œå¹¶ä¸ºä¿æŒç›¸å…³æ ‡å‡†çš„ä¸€è‡´æ€§å’Œå…¼å®¹æ€§æä¾›å…±åŒçš„å‚è€ƒã€‚</p><h2 id="WHAT"><a href="#WHAT" class="headerlink" title="WHAT"></a>WHAT</h2><p>å®ç°ã€Œå¼€æ”¾ç³»ç»Ÿäº’è¿ã€æ‰€å»ºç«‹çš„ã€Œé€šä¿¡åŠŸèƒ½ã€çš„ã€Œåˆ†å±‚æ¨¡å‹ã€ï¼›åˆ†ä¸ƒå±‚ï¼šç‰©ç†å±‚ã€æ•°æ®é“¾è·¯å±‚ã€ç½‘ç»œå±‚ã€ä¼ è¾“å±‚ã€ä¼šè¯å±‚ã€è¡¨ç¤ºå±‚ã€åº”ç”¨å±‚ã€‚</p><h2 id="HOW"><a href="#HOW" class="headerlink" title="HOW"></a>HOW</h2><ul><li>æ¯ä¸€å±‚çš„åŠŸèƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œåˆ©ç”¨ä¸‹ä¸€å±‚ä¸ºä¸Šä¸€å±‚æä¾›<strong>æœåŠ¡</strong>ï¼›</li><li>åŒç­‰å±‚å®ä½“ä¹‹é—´é€šä¿¡ç”±è¯¥å±‚çš„<strong>åè®®</strong>ç®¡ç†ã€‚</li><li>é™¤ç‰©ç†å±‚ä¹‹å¤–ï¼Œæ¯å±‚éƒ½ä¼šåœ¨åŸå§‹æ•°æ®å‰æ·»åŠ ä¸€ä¸²å±äºè‡ªå·±çš„<strong>åè®®å¤´</strong>ï¼›æ¥æ”¶ç«¯å‘ä¸Šä¼ é€’è¿‡ç¨‹ä¸­ä¼šåˆ é™¤è‡ªå·±çš„åè®®å¤´<blockquote><p><strong>æœåŠ¡</strong>ï¼šä¸‹ä¸€å±‚å‘ä¸Šä¸€å±‚æä¾›çš„ã€Œé€šä¿¡åŠŸèƒ½ã€å’Œã€Œå±‚ä¹‹é—´çš„ä¼šè¯è§„å®šã€ã€‚<br><strong>åè®®</strong>ï¼šä¸¤ä¸ªå¼€æ”¾ç³»ç»Ÿä¸­çš„ <strong>åŒç­‰å±‚ä¹‹é—´çš„é€šä¿¡è§„åˆ™å’Œçº¦å®š</strong><br>  1ï½4å±‚åè®®ç§°ä¸º<strong>ä¸‹å±‚åè®®</strong><br>  5ï½7å±‚åè®®ç§°ä¸º<strong>ä¸Šå±‚åè®®</strong></p></blockquote></li></ul><h2 id="åˆ†å±‚è¯´æ˜"><a href="#åˆ†å±‚è¯´æ˜" class="headerlink" title="åˆ†å±‚è¯´æ˜"></a>åˆ†å±‚è¯´æ˜</h2><h3 id="åº”ç”¨å±‚-Application"><a href="#åº”ç”¨å±‚-Application" class="headerlink" title="åº”ç”¨å±‚ (Application)"></a>åº”ç”¨å±‚ (Application)</h3><p>ç½‘ç»œæœåŠ¡ä¸æœ€ç»ˆç”¨æˆ·çš„ä¸€ä¸ªæ¥å£ã€‚<br>åè®®æœ‰ï¼šHTTP FTP TFTP SMTP SNMP DNS TELNET HTTPS POP3 DHCP</p><h3 id="è¡¨ç¤ºå±‚ï¼ˆPresentation-Layerï¼‰"><a href="#è¡¨ç¤ºå±‚ï¼ˆPresentation-Layerï¼‰" class="headerlink" title="è¡¨ç¤ºå±‚ï¼ˆPresentation Layerï¼‰"></a>è¡¨ç¤ºå±‚ï¼ˆPresentation Layerï¼‰</h3><p>æ•°æ®çš„è¡¨ç¤ºã€å®‰å…¨ã€å‹ç¼©ã€‚ï¼ˆåœ¨äº”å±‚æ¨¡å‹é‡Œé¢å·²ç»åˆå¹¶åˆ°äº†åº”ç”¨å±‚ï¼‰<br>æ ¼å¼æœ‰ï¼ŒJPEGã€ASCllã€DECOICã€åŠ å¯†æ ¼å¼ç­‰</p><h3 id="ä¼šè¯å±‚ï¼ˆSession-Layerï¼‰"><a href="#ä¼šè¯å±‚ï¼ˆSession-Layerï¼‰" class="headerlink" title="ä¼šè¯å±‚ï¼ˆSession Layerï¼‰"></a>ä¼šè¯å±‚ï¼ˆSession Layerï¼‰</h3><p>å»ºç«‹ã€ç®¡ç†ã€ç»ˆæ­¢ä¼šè¯ã€‚ï¼ˆåœ¨äº”å±‚æ¨¡å‹é‡Œé¢å·²ç»åˆå¹¶åˆ°äº†åº”ç”¨å±‚ï¼‰<br>å¯¹åº”ä¸»æœºè¿›ç¨‹ï¼ŒæŒ‡æœ¬åœ°ä¸»æœºä¸è¿œç¨‹ä¸»æœºæ­£åœ¨è¿›è¡Œçš„ä¼šè¯</p><h3 id="ä¼ è¾“å±‚-Transport"><a href="#ä¼ è¾“å±‚-Transport" class="headerlink" title="ä¼ è¾“å±‚ (Transport)"></a>ä¼ è¾“å±‚ (Transport)</h3><p>å®šä¹‰ä¼ è¾“æ•°æ®çš„åè®®ç«¯å£å·ï¼Œä»¥åŠæµæ§å’Œå·®é”™æ ¡éªŒã€‚<br>åè®®æœ‰ï¼šTCP UDPï¼Œæ•°æ®åŒ…ä¸€æ—¦ç¦»å¼€ç½‘å¡å³è¿›å…¥ç½‘ç»œä¼ è¾“å±‚</p><h3 id="ç½‘ç»œå±‚-Network"><a href="#ç½‘ç»œå±‚-Network" class="headerlink" title="ç½‘ç»œå±‚ (Network)"></a>ç½‘ç»œå±‚ (Network)</h3><p>è¿›è¡Œé€»è¾‘åœ°å€å¯»å€ï¼Œå®ç°ä¸åŒç½‘ç»œä¹‹é—´çš„è·¯å¾„é€‰æ‹©ã€‚<br>åè®®æœ‰ï¼šICMP IGMP IPï¼ˆIPV4 IPV6ï¼‰ ARP RARP</p><h3 id="æ•°æ®é“¾è·¯å±‚-Link"><a href="#æ•°æ®é“¾è·¯å±‚-Link" class="headerlink" title="æ•°æ®é“¾è·¯å±‚ (Link)"></a>æ•°æ®é“¾è·¯å±‚ (Link)</h3><p>å»ºç«‹é€»è¾‘è¿æ¥ã€è¿›è¡Œç¡¬ä»¶åœ°å€å¯»å€ã€å·®é”™æ ¡éªŒç­‰åŠŸèƒ½ã€‚ï¼ˆç”±åº•å±‚ç½‘ç»œå®šä¹‰åè®®ï¼‰<br>å°†æ¯”ç‰¹ç»„åˆæˆå­—èŠ‚è¿›è€Œç»„åˆæˆå¸§ï¼Œç”¨MACåœ°å€è®¿é—®ä»‹è´¨ï¼Œé”™è¯¯å‘ç°ä½†ä¸èƒ½çº æ­£ã€‚</p><h3 id="ç‰©ç†å±‚ï¼ˆPhysical-Layerï¼‰"><a href="#ç‰©ç†å±‚ï¼ˆPhysical-Layerï¼‰" class="headerlink" title="ç‰©ç†å±‚ï¼ˆPhysical Layerï¼‰"></a>ç‰©ç†å±‚ï¼ˆPhysical Layerï¼‰</h3><p>å»ºç«‹ã€ç»´æŠ¤ã€æ–­å¼€ç‰©ç†è¿æ¥ã€‚ï¼ˆç”±åº•å±‚ç½‘ç»œå®šä¹‰åè®®ï¼‰</p><p><img src="/images/2017/11/osi.png" alt="OSI"></p><h1 id="TCP-IP-å‚è€ƒæ¨¡å‹"><a href="#TCP-IP-å‚è€ƒæ¨¡å‹" class="headerlink" title="TCP/IP å‚è€ƒæ¨¡å‹"></a>TCP/IP å‚è€ƒæ¨¡å‹</h1><blockquote><p>TCP/IPæ˜¯å…ˆæœ‰äº†åè®®ï¼Œæ‰åˆ¶å®šTCP/IPæ¨¡å‹ã€‚ç›®å‰æ˜¯äº’è”ç½‘çš„äº‹å®æ ‡å‡†</p></blockquote><h2 id="WHY-1"><a href="#WHY-1" class="headerlink" title="WHY"></a>WHY</h2><p>ARPANETæ˜¯ç”±ç¾å›½å›½é˜²éƒ¨DoDï¼ˆU.S.Department of Defenseï¼‰èµåŠ©çš„ç ”ç©¶ç½‘ç»œã€‚é€æ¸åœ°å®ƒé€šè¿‡ç§Ÿç”¨çš„ç”µè¯çº¿è¿ç»“äº†æ•°ç™¾æ‰€å¤§å­¦å’Œæ”¿åºœéƒ¨é—¨ã€‚å½“æ— çº¿ç½‘ç»œå’Œå«æ˜Ÿå‡ºç°ä»¥åï¼Œç°æœ‰çš„åè®®åœ¨å’Œå®ƒä»¬ç›¸è¿çš„æ—¶å€™å‡ºç°äº†é—®é¢˜ï¼Œæ‰€ä»¥éœ€è¦ä¸€ç§æ–°çš„å‚è€ƒä½“ç³»ç»“æ„ã€‚</p><h2 id="WHAT-1"><a href="#WHAT-1" class="headerlink" title="WHAT"></a>WHAT</h2><p>ç”± TCPã€IP ä¸¤ä¸ªåè®®æ¼”è¿›è¿‡æ¥çš„ï¼Œå…±åˆ†ä¸ºå››å±‚ï¼šç½‘ç»œè®¿é—®å±‚ã€äº’è”ç½‘å±‚ã€ä¼ è¾“å±‚å’Œåº”ç”¨å±‚</p><h2 id="HOW-1"><a href="#HOW-1" class="headerlink" title="HOW"></a>HOW</h2><p><img src="/images/2017/11/osi-translate.png" alt="osi-translate"></p><h2 id="åˆ†å±‚è¯´æ˜-1"><a href="#åˆ†å±‚è¯´æ˜-1" class="headerlink" title="åˆ†å±‚è¯´æ˜"></a>åˆ†å±‚è¯´æ˜</h2><h3 id="åº”ç”¨å±‚"><a href="#åº”ç”¨å±‚" class="headerlink" title="åº”ç”¨å±‚"></a>åº”ç”¨å±‚</h3><p>ä¸ºç”¨æˆ·æä¾›æ‰€éœ€è¦çš„å„ç§æœåŠ¡<br>åè®®æœ‰ï¼šHTTPã€FTPã€Telnetã€DNSã€SMTPç­‰.</p><h3 id="ä¼ è¾“å±‚"><a href="#ä¼ è¾“å±‚" class="headerlink" title="ä¼ è¾“å±‚"></a>ä¼ è¾“å±‚</h3><p>ä¸ºåº”ç”¨å±‚æä¾›ç«¯åˆ°ç«¯çš„é€šä¿¡åŠŸèƒ½<br>åè®®æœ‰ï¼šTCPã€UDP</p><h3 id="ç½‘ç»œäº’è”å±‚"><a href="#ç½‘ç»œäº’è”å±‚" class="headerlink" title="ç½‘ç»œäº’è”å±‚"></a>ç½‘ç»œäº’è”å±‚</h3><p>è´Ÿè´£åˆ†é…åœ°å€å’Œä¼ é€äºŒè¿›åˆ¶æ•°æ®ã€‚<br>åè®®æœ‰ï¼šIPã€IGMPã€ICMP<br><strong>IPåè®®</strong>æ˜¯ç½‘é™…äº’è”å±‚æœ€é‡è¦çš„åè®®ï¼Œå®ƒæä¾›çš„æ˜¯ä¸€ä¸ªå¯é ã€æ— è¿æ¥çš„æ•°æ®æŠ¥ä¼ é€’æœåŠ¡ã€‚</p><h3 id="ç½‘ç»œæ¥å£å±‚"><a href="#ç½‘ç»œæ¥å£å±‚" class="headerlink" title="ç½‘ç»œæ¥å£å±‚"></a>ç½‘ç»œæ¥å£å±‚</h3><p>è´Ÿè´£ç›‘è§†æ•°æ®åœ¨ä¸»æœºå’Œç½‘ç»œä¹‹é—´çš„äº¤æ¢ã€‚<strong>äº‹å®ä¸Šï¼ŒTCP/IPæœ¬èº«å¹¶æœªå®šä¹‰è¯¥å±‚çš„åè®®</strong>ï¼Œæ‰€ä»¥å…¶å…·ä½“å®ç°çš„æ–¹æ³•éšç€ç½‘ç»œç±»å‹çš„ä¸åŒè€Œä¸åŒã€‚</p><h1 id="OSI-æ¯”å¯¹-TCP-IP"><a href="#OSI-æ¯”å¯¹-TCP-IP" class="headerlink" title="OSI æ¯”å¯¹ TCP/IP"></a>OSI æ¯”å¯¹ TCP/IP</h1><p><img src="/images/2017/11/osi-tcp-ip.png" alt="OSI-TCP/IP"></p><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li><a href="http://www.colasoft.com.cn/download/protocols_map.php" rel="external nofollow noopener noreferrer" target="_blank">ç§‘æ¥åè®®å›¾</a></li><li><a href="https://baike.baidu.com/item/%E4%B8%83%E5%B1%82%E6%A8%A1%E5%9E%8B/1441391?fr=aladdin" rel="external nofollow noopener noreferrer" target="_blank">ç™¾ç§‘-ä¸ƒå±‚æ¨¡å‹</a></li><li><a href="https://baike.baidu.com/item/TCP%2FIP%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B" rel="external nofollow noopener noreferrer" target="_blank">ç™¾ç§‘-TCP/IPå‚è€ƒæ¨¡å‹</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;OSI-å‚è€ƒæ¨¡å‹&quot;&gt;&lt;a href=&quot;#OSI-å‚è€ƒæ¨¡å‹&quot; cla
      
    
    </summary>
    
      <category term="1-åŸºç¡€çŸ¥è¯†" scheme="http://yoursite.com/categories/1-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
      <category term="è®¡ç®—æœºç½‘ç»œ" scheme="http://yoursite.com/categories/1-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"/>
    
    
  </entry>
  
  <entry>
    <title>æ¬¢è¿æ¥åˆ°è´ºé¾™é£çš„çŸ¥è¯†åº“ï¼</title>
    <link href="http://yoursite.com/index/"/>
    <id>http://yoursite.com/index/</id>
    <published>2017-11-08T13:20:17.000Z</published>
    <updated>2017-11-16T13:19:29.818Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="ä½•ä¸ºã€ŒçŸ¥è¯†åº“ã€ï¼Ÿ"><a href="#ä½•ä¸ºã€ŒçŸ¥è¯†åº“ã€ï¼Ÿ" class="headerlink" title="ä½•ä¸ºã€ŒçŸ¥è¯†åº“ã€ï¼Ÿ"></a>ä½•ä¸ºã€ŒçŸ¥è¯†åº“ã€ï¼Ÿ</h1><p>åœ¨è¿™ä¸ªä¿¡æ¯çˆ†ç‚¸çš„å¹´ä»£ï¼Œè·å–ä¿¡æ¯çš„æˆæœ¬æ¥è¿‘äº0ï¼Œæ¯å¤©éƒ½æœ‰å¾ˆå¤šæ–°çš„ä¿¡æ¯èœ‚æ‹¥è€Œæ¥ï¼›è¿‡å¾€é’ˆå¯¹è¿™äº›ä¿¡æ¯ï¼Œæˆ‘éƒ½æ˜¯æ”¾åœ¨äº‘ç¬”è®°ä¸­ï¼ˆå°è¯•è¿‡æœ‰é“ã€å°è±¡ã€ä¸ºçŸ¥ã€èš‚èšç­‰ï¼‰ï¼Œä½†æ˜¯æ”¾åœ¨ç¬”è®°ä¸­ä¸ç­‰äºæŒæ¡ï¼Œæ‰€ä»¥éœ€è¦è¿›ä¸€æ­¥çš„è¿›è¡Œå½’çº³å’Œæ•´ç†ï¼Œæ‰€ä»¥æ‰æœ‰äº†ã€ŒçŸ¥è¯†åº“ã€ã€‚</p><h1 id="ä¸ºä»€ä¹ˆè¦ç”¨-github-page-ä½œä¸ºã€ŒçŸ¥è¯†åº“ã€"><a href="#ä¸ºä»€ä¹ˆè¦ç”¨-github-page-ä½œä¸ºã€ŒçŸ¥è¯†åº“ã€" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ç”¨ github page ä½œä¸ºã€ŒçŸ¥è¯†åº“ã€?"></a>ä¸ºä»€ä¹ˆè¦ç”¨ <code>github page</code> ä½œä¸ºã€ŒçŸ¥è¯†åº“ã€?</h1><p>ä¹‹å‰éƒ½æ˜¯æ”¾åœ¨äº‘ç¬”è®°ä¸­ï¼Œä½†æ˜¯ä¸åˆ©äºæŸ¥æ‰¾å’Œåˆ†äº«ï¼ŒåŒæ—¶æœ‰äº›éœ€æ±‚äº‘ç¬”è®°ä¸å¤ªèƒ½æ»¡è¶³æˆ‘ï¼›è¿™è¾¹æ•´ç†äº†ä¸‹è‡ªå·±å¯¹ã€ŒçŸ¥è¯†åº“ã€çš„éœ€æ±‚ï¼š</p><ol><li>æ— é™çº§åˆ†ç±»</li><li>å¯ä»¥å…¨æ–‡æœç´¢</li><li>å†…å®¹æœ‰ç›®å½•</li><li>å¯ä»¥æ–¹ä¾¿æŸ¥è¯¢</li><li>ä¾¿äºè¿›è¡ŒçŸ¥è¯†æ¢³ç†</li><li>ä¿è¯æ•°æ®ä¸ä¼šä¸¢å¤±</li><li>å†…å®¹æœ‰æ›´æ–°å†å²</li></ol><p>æ‰€ä»¥æœ€ç»ˆé€‰æ‹©äº†ä½¿ç”¨ <code>github page</code>ã€‚</p><h1 id="ã€ŒçŸ¥è¯†åº“ã€å’Œã€Œåšå®¢ã€æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#ã€ŒçŸ¥è¯†åº“ã€å’Œã€Œåšå®¢ã€æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="ã€ŒçŸ¥è¯†åº“ã€å’Œã€Œåšå®¢ã€æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>ã€ŒçŸ¥è¯†åº“ã€å’Œã€Œåšå®¢ã€æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h1><p>ä¸ªäººå­¦ä¹ çš„è¿‡ç¨‹æ˜¯ï¼š<code>æ”¶é›†-&gt;æ•´ç†-&gt;å¸æ”¶-&gt;è¾“å‡º</code></p><p><strong>æ”¶é›†</strong>ï¼šé‡‡ç”¨ã€Œevernoteã€è¿›è¡Œä¿¡æ¯çš„æ”¶é›†<br><strong>æ•´ç†</strong>ï¼šé‡‡ç”¨ã€ŒçŸ¥è¯†åº“ã€è¿›è¡Œä¿¡æ¯/çŸ¥è¯†çš„æ•´ç†<br><strong>å¸æ”¶</strong>ï¼šåœ¨å·¥ä½œ/å­¦ä¹ ä¸­ã€Œå®æˆ˜ã€<br><strong>è¾“å‡º</strong>ï¼šé‡‡ç”¨ã€Œåšå®¢ã€å¯¹çŸ¥è¯†è¿›è¡Œæ·±å…¥çš„å‰–æ/ä¸ªäººè§è§£</p><p>ç»¼ä¸Šæ‰€è¿°ï¼Œã€ŒçŸ¥è¯†åº“ã€æ˜¯å¯¹çŸ¥è¯†çš„æ•´ç†ï¼Œã€Œåšå®¢ã€æ˜¯å¯¹çŸ¥è¯†çš„å‰–æ</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;ä½•ä¸ºã€ŒçŸ¥è¯†åº“ã€ï¼Ÿ&quot;&gt;&lt;a href=&quot;#ä½•ä¸ºã€ŒçŸ¥è¯†åº“ã€ï¼Ÿ&quot; cla
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>YAR</title>
    <link href="http://yoursite.com/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E7%A8%8B%E5%BA%8F%E8%AF%AD%E8%A8%80/PHP/yar/"/>
    <id>http://yoursite.com/2-å¼€å‘æŠ€èƒ½/ç¨‹åºè¯­è¨€/PHP/yar/</id>
    <published>2017-11-07T14:35:00.000Z</published>
    <updated>2017-12-03T16:04:44.535Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="What"><a href="#What" class="headerlink" title="What"></a>What</h1><p>ä¸€ä¸ªè½»é‡çº§å¯å¹¶è¡Œçš„ RPC æ¡†æ¶ï¼Œæ”¯æŒä¸‰ç§æ‰“åŒ…åè®®ï¼ˆmsgpack,json,phpï¼‰,ä¼ è¾“åè®®æ”¯æŒ httpï¼ˆtcp/unixä»¥åä¼šæ”¯æŒï¼‰<br>â€‹</p><blockquote><p>github åœ°å€ï¼š<a href="https://github.com/laruence/yar" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/laruence/yar</a><br>php å®˜ç½‘ï¼š<a href="http://php.net/manual/zh/book.yar.php" rel="external nofollow noopener noreferrer" target="_blank">http://php.net/manual/zh/book.yar.php</a></p></blockquote><h1 id="Why"><a href="#Why" class="headerlink" title="Why"></a>Why</h1><p>é¸Ÿå“¥ä¸¾äº†ä¸¤ä¸ªåœºæ™¯(ä¼ ç»Ÿ web åº”ç”¨)ï¼š  </p><ol><li><p>ä¸€ä¸ªè¿›ç¨‹ï¼Œä¸€ä¸ªè¯·æ±‚ï¼Œä½†æ˜¯æ¶‰åŠåˆ°å¤šä¸ªæ²¡æœ‰ä¾èµ–æ€§çš„æ•°æ®æºï¼Œåªèƒ½ä¸²è¡Œå¤„ç†ï¼ˆä¾æ¬¡ç­‰å¾…æ‰€æœ‰æ•°æ®æºå¤„ç†ï¼‰å®Œæ¯•åæ‰èƒ½å“åº”ï¼›  </p><blockquote><p>yar å¯ä»¥å¹¶è¡Œå¤„ç†ï¼Œå‡å°‘æ—¶é—´å¼€é”€</p></blockquote></li><li><p>ä¸€ä¸ªåº”ç”¨ç³»ç»Ÿéšç€ä¸šåŠ¡çš„å¢åŠ ï¼Œäººå‘˜æµå¤±ï¼ŒåªåšåŠ æ³•ï¼Œç­‰åˆ°ä¸å¯ç»´æŠ¤æ€§çš„æ—¶å€™ï¼Œåªèƒ½é‡æ„</p><blockquote><p>yar å¯ä»¥ç»™ç³»ç»Ÿè¿›è¡Œè§£è€¦ï¼ˆå®é™…ä¸Šæ˜¯ soa æ€æƒ³ï¼‰</p></blockquote></li></ol><h1 id="How"><a href="#How" class="headerlink" title="How"></a>How</h1><h2 id="server"><a href="#server" class="headerlink" title="server"></a>server</h2><p>æ”¾ç½®åœ¨ web æœåŠ¡å™¨ä¸Šï¼Œé€šè¿‡ http è®¿é—®(é»˜è®¤getè®¿é—®ä¼šè¾“å‡º doc ä¿¡æ¯)</p><h2 id="client"><a href="#client" class="headerlink" title="client"></a>client</h2><ol><li>ä¸²è¡Œè°ƒç”¨</li><li>å¹¶è¡Œè°ƒç”¨ï¼ˆyar å†…éƒ¨ä½¿ç”¨ libcurl + epoll ï¼‰</li></ol><h1 id="é«˜çº§è¿›é˜¶"><a href="#é«˜çº§è¿›é˜¶" class="headerlink" title="é«˜çº§è¿›é˜¶"></a>é«˜çº§è¿›é˜¶</h1><h2 id="Yar-åè®®åˆ†æ"><a href="#Yar-åè®®åˆ†æ" class="headerlink" title="Yar åè®®åˆ†æ"></a>Yar åè®®åˆ†æ</h2><p>Yaræ•´ä¸ªåè®®ç”±82å­—èŠ‚é•¿åº¦çš„yar_header + 8å­—èŠ‚çš„æ•°æ®æ‰“åŒ…åè®®(MSGPACKã€JSONã€PHP)  + Nå­—èŠ‚çš„Bodyç»„æˆã€‚</p><h2 id="å®‰å…¨æ€§"><a href="#å®‰å…¨æ€§" class="headerlink" title="å®‰å…¨æ€§"></a>å®‰å…¨æ€§</h2><blockquote><p>æœªéªŒè¯</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">typedef struct _yar_header &#123;</span><br><span class="line">  unsigned int   id;            // transaction id</span><br><span class="line">  unsigned short version;       // protocl version</span><br><span class="line">  unsigned int   magic_num;     // default is: 0x80DFEC60</span><br><span class="line">  unsigned int   reserved;</span><br><span class="line">  unsigned char  provider[32];  // reqeust from who</span><br><span class="line">  unsigned char  token[32];     // request token, used for authentication</span><br><span class="line">  unsigned int   body_len;      // request body len</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>struct <code>_yar_header</code>ä¸­éœ€è¦æ³¨æ„çš„æ˜¯magic_numå€¼ã€‚è¯¥å€¼åœ¨Clientä¸Serveréƒ½åº”è¯¥ä¿æŒä¸€è‡´ã€‚å¦åˆ™è§†ä¸ºä¸åˆæ³•çš„æ•°æ®ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹è¿™ä¸ªå€¼ï¼Œå®šåˆ¶ä¸€ä¸ªyaræ¡†æ¶ï¼Œé˜²æ­¢å…¶ä»–äººæ¶æ„è¯·æ±‚ã€‚</p></blockquote><h2 id="è·¨è¯­è¨€"><a href="#è·¨è¯­è¨€" class="headerlink" title="è·¨è¯­è¨€"></a>è·¨è¯­è¨€</h2><blockquote><p>åˆ©ç”¨ yar å¯ä»¥æ¥æ”¶ struct å®ç°</p></blockquote><ul><li>client</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">array(</span><br><span class="line">  &quot;i&quot; =&gt; &apos;&apos;, // transaction id</span><br><span class="line">  &quot;m&quot; =&gt; &apos;&apos;,  // the method which being called</span><br><span class="line">  &quot;p&quot; =&gt; array(), // parameters</span><br><span class="line">)</span><br></pre></td></tr></table></figure><ul><li>server</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">array(</span><br><span class="line">   &quot;i&quot; =&gt; &apos;&apos;,</span><br><span class="line">   &quot;s&quot; =&gt; &apos;&apos;, //status</span><br><span class="line">   &quot;r&quot; =&gt; &apos;&apos;, //return value</span><br><span class="line">   &quot;o&quot; =&gt; &apos;&apos;, //output</span><br><span class="line">   &quot;e&quot; =&gt; &apos;&apos;, //error or exception</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ol><li><a href="http://www.laruence.com/2012/09/15/2779.html" rel="external nofollow noopener noreferrer" target="_blank">Yar â€“ å¹¶è¡Œçš„RPCæ¡†æ¶(Concurrent RPC framework)</a></li><li><a href="http://www.searchtb.com/2013/10/yar-%E5%B9%B6%E8%A1%8Crpc%E6%A1%86%E6%9E%B6%E7%A0%94%E7%A9%B6.html" rel="external nofollow noopener noreferrer" target="_blank">YAR å¹¶è¡ŒRPCæ¡†æ¶ç ”ç©¶</a></li><li><a href="http://blog.weixinhost.com/wei-ming-ming/" rel="external nofollow noopener noreferrer" target="_blank">Yaråè®®åˆ†æä¸è·¨è¯­è¨€å®ç°</a></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;What&quot;&gt;&lt;a href=&quot;#What&quot; class=&quot;head
      
    
    </summary>
    
      <category term="2-å¼€å‘æŠ€èƒ½" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/"/>
    
      <category term="ç¨‹åºè¯­è¨€" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E7%A8%8B%E5%BA%8F%E8%AF%AD%E8%A8%80/"/>
    
      <category term="PHP" scheme="http://yoursite.com/categories/2-%E5%BC%80%E5%8F%91%E6%8A%80%E8%83%BD/%E7%A8%8B%E5%BA%8F%E8%AF%AD%E8%A8%80/PHP/"/>
    
    
      <category term="php" scheme="http://yoursite.com/tags/php/"/>
    
      <category term="yar" scheme="http://yoursite.com/tags/yar/"/>
    
      <category term="php_ext" scheme="http://yoursite.com/tags/php-ext/"/>
    
  </entry>
  
  <entry>
    <title>MAC å¿…å¤‡è½¯ä»¶</title>
    <link href="http://yoursite.com/5-%E6%95%88%E7%8E%87%E5%B7%A5%E5%85%B7/mac/"/>
    <id>http://yoursite.com/5-æ•ˆç‡å·¥å…·/mac/</id>
    <published>2017-11-06T15:25:00.000Z</published>
    <updated>2017-11-16T13:18:31.583Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="ç³»ç»Ÿ"><a href="#ç³»ç»Ÿ" class="headerlink" title="ç³»ç»Ÿ"></a>ç³»ç»Ÿ</h1><ul><li><a href="http://matthewpalmer.net/vanilla/" rel="external nofollow noopener noreferrer" target="_blank">Vanilla</a>ï¼šéšè—èœå•æ </li><li><a href="https://www.spectacleapp.com/" rel="external nofollow noopener noreferrer" target="_blank">Spectacle</a>ï¼šçª—å£åˆ†å±</li><li><a href="https://coffitivity.com/" rel="external nofollow noopener noreferrer" target="_blank">Coffitivity</a>ï¼šç™½å™ªéŸ³</li><li><a href="https://www.enpass.io/" rel="external nofollow noopener noreferrer" target="_blank">Enpass</a>ï¼šå¯†ç ç®¡ç†å·¥å…·</li><li><a href="https://www.teamviewer.com/zhCN/" rel="external nofollow noopener noreferrer" target="_blank">TeamViewer</a>ï¼šè¿œç¨‹æ§åˆ¶</li><li><a href="http://www.yingdev.com/projects/tickeys" rel="external nofollow noopener noreferrer" target="_blank">Tickeys</a>ï¼šæ‰“å­—éŸ³æ•ˆ</li><li><a href="https://getlantern.org/" rel="external nofollow noopener noreferrer" target="_blank">Lantern</a>ï¼šå‡ºå›½å·¥å…·</li><li>Irvueï¼šè‡ªåŠ¨åˆ‡æ¢å£çº¸</li><li>OmniDiskSweeper: æŸ¥çœ‹ç£ç›˜å ç”¨å·¥å…·</li></ul><h1 id="å­¦ä¹ "><a href="#å­¦ä¹ " class="headerlink" title="å­¦ä¹ "></a>å­¦ä¹ </h1><ul><li><a href="https://apps.ankiweb.net/" rel="external nofollow noopener noreferrer" target="_blank">Anki</a>ï¼šå¤ä¹ å·¥å…·</li><li><a href="https://www.yinxiang.com/" rel="external nofollow noopener noreferrer" target="_blank">Evernote</a>ï¼šæ”¶é›†èµ„æ–™</li><li><a href="https://leanote.com/" rel="external nofollow noopener noreferrer" target="_blank">Leanote</a>ï¼šç¬”è®°</li><li><a href="https://marginnote.com/" rel="external nofollow noopener noreferrer" target="_blank">MarginNote Pro</a>ï¼šå­¦ä¹  pdf ç¥å™¨ï¼ˆæ”¶è´¹ï¼‰</li><li><a href="https://mindnode.com/" rel="external nofollow noopener noreferrer" target="_blank">MindNode</a>ï¼šæ€ç»´å¯¼å›¾ï¼ˆæ”¶è´¹ï¼‰</li><li><a href="http://wiki.kiwix.org/wiki/Main_Page/zh-cn" rel="external nofollow noopener noreferrer" target="_blank">kiwix</a>ï¼šç¦»çº¿ç»´åŸºç™¾ç§‘</li></ul><h1 id="å·¥ä½œ"><a href="#å·¥ä½œ" class="headerlink" title="å·¥ä½œ"></a>å·¥ä½œ</h1><ul><li><a href="https://atom.io/" rel="external nofollow noopener noreferrer" target="_blank">Atom</a>ï¼šç¼–è¾‘å™¨</li><li><a href="https://www.charlesproxy.com/" rel="external nofollow noopener noreferrer" target="_blank">Charles</a>ï¼šæŠ“åŒ…å·¥å…·ï¼ˆæ”¶è´¹ï¼‰</li><li><a href="https://kapeli.com/dash" rel="external nofollow noopener noreferrer" target="_blank">Dash</a>ï¼šæ–‡æ¡£ï¼ˆæ”¶è´¹ï¼‰</li><li><a href="http://www.iterm2.com/" rel="external nofollow noopener noreferrer" target="_blank">iTerm 2</a>ï¼šç»ˆç«¯</li><li><a href="https://www.jetbrains.com/phpstorm/" rel="external nofollow noopener noreferrer" target="_blank">PhpStorm</a>ï¼šPHP çš„ IDE</li><li><a href="http://www.sequelpro.com/" rel="external nofollow noopener noreferrer" target="_blank">Sequel Pro</a>ï¼šMysql å®¢æˆ·ç«¯</li><li><a href="https://www.sourcetreeapp.com/" rel="external nofollow noopener noreferrer" target="_blank">SourceTree</a>ï¼šGit å®¢æˆ·ç«¯</li><li><a href="http://www.sublimetext.com/" rel="external nofollow noopener noreferrer" target="_blank">Sublime Text</a>ï¼šè½»é‡å¯å®šåˆ¶ç¼–è¾‘å™¨</li><li><a href="https://www.typora.io/" rel="external nofollow noopener noreferrer" target="_blank">Typora</a>ï¼šMD ç¼–è¾‘å™¨</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;ç³»ç»Ÿ&quot;&gt;&lt;a href=&quot;#ç³»ç»Ÿ&quot; class=&quot;headerli
      
    
    </summary>
    
      <category term="5-æ•ˆç‡å·¥å…·" scheme="http://yoursite.com/categories/5-%E6%95%88%E7%8E%87%E5%B7%A5%E5%85%B7/"/>
    
    
  </entry>
  
  <entry>
    <title>Blog ç³»ç»Ÿä¹‹ Hexo</title>
    <link href="http://yoursite.com/4-%E5%BC%80%E6%BA%90%E8%BD%AF%E4%BB%B6/blog/"/>
    <id>http://yoursite.com/4-å¼€æºè½¯ä»¶/blog/</id>
    <published>2017-11-05T06:26:00.000Z</published>
    <updated>2017-11-08T15:59:00.335Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="Blog-ç³»ç»Ÿ"><a href="#Blog-ç³»ç»Ÿ" class="headerlink" title="Blog ç³»ç»Ÿ"></a>Blog ç³»ç»Ÿ</h1><p>ä¹‹å‰ç”¨çš„æ˜¯ Octopress ï¼Œç”±äºä¸æ›´æ–°äº†ï¼Œä¸”ä½¿ç”¨çš„æ˜¯ ruby å¼€å‘ï¼Œç”Ÿæˆ html æ¯”è¾ƒæ…¢ï¼Œæ‰€ä»¥è¿ç§»åˆ° hexoã€‚</p><h1 id="Hexo"><a href="#Hexo" class="headerlink" title="Hexo"></a>Hexo</h1><h2 id="å®‰è£…-hexo"><a href="#å®‰è£…-hexo" class="headerlink" title="å®‰è£… hexo"></a>å®‰è£… hexo</h2><p><a href="https://hexo.io/zh-cn/docs/" rel="external nofollow noopener noreferrer" target="_blank">hexo æ–‡æ¡£</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> npm install -g hexo-cli</span><br><span class="line"><span class="meta">$</span> hexo init &lt;folder&gt;</span><br><span class="line"><span class="meta">$</span> cd &lt;folder&gt;</span><br><span class="line"><span class="meta">$</span> npm install</span><br></pre></td></tr></table></figure><p>å®‰è£…å®Œæ¯•åï¼Œè¯·è‡ªè¡Œä¿®æ”¹ <code>/_config.yml</code></p><p><strong> æœ€ååˆ«å¿˜è®°æ·»åŠ  CNAME</strong></p><h2 id="ä¸»é¢˜"><a href="#ä¸»é¢˜" class="headerlink" title="ä¸»é¢˜"></a>ä¸»é¢˜</h2><p>é‡‡ç”¨ Hiker ä¸»é¢˜ï¼›<a href="https://github.com/iTimeTraveler/hexo-theme-hiker/blob/master/README.cn.md" rel="external nofollow noopener noreferrer" target="_blank">[ä¸­æ–‡è¯´æ˜]</a> <a href="https://github.com/iTimeTraveler/hexo-theme-hiker" rel="external nofollow noopener noreferrer" target="_blank">[Github]</a></p><p><strong>åˆ é™¤ä½œè€…è‡ªå·±çš„ cnzz ç»Ÿè®¡ä»£ç </strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># source/js/scripts.js ä¸­ï¼Œåˆ é™¤ä»¥ä¸‹ä»£ç </span><br><span class="line"><span class="keyword">var</span> s = [</span><br><span class="line">        <span class="string">'&lt;div style="display: none;"&gt;'</span>,</span><br><span class="line">          <span class="string">'&lt;script src="https://s11.cnzz.com/z_stat.php?id=1260716016&amp;web_id=1260716016" language="JavaScript"&gt;&lt;/script&gt;'</span>,</span><br><span class="line">        <span class="string">'&lt;/div&gt;'</span></span><br><span class="line">      ].join(<span class="string">''</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> di = $(s);</span><br><span class="line"></span><br><span class="line">  $(<span class="string">'#container'</span>).append(di);</span><br></pre></td></tr></table></figure><p><strong>ä¿®æ”¹ä¸»é¢˜çš„é…ç½®æ–‡ä»¶</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /themes/hiker/_config.yml</span></span><br><span class="line"><span class="comment"># æ¸…ç©ºä»¥ä¸‹ä¿¡æ¯ï¼Œéƒ½æ˜¯ä½œè€…æœ¬äººä¿¡æ¯</span></span><br><span class="line"><span class="attr">social:</span></span><br><span class="line"><span class="attr">donate:</span></span><br><span class="line"><span class="comment"># å…¶ä»–æ•°æ®è¯·è‡ªè¡Œå¡«å……</span></span><br></pre></td></tr></table></figure><h1 id="Atom-é…ç½®"><a href="#Atom-é…ç½®" class="headerlink" title="Atom é…ç½®"></a>Atom é…ç½®</h1><blockquote><p>é‡‡ç”¨ atom ä½œä¸º md çš„ç¼–è¾‘å™¨</p></blockquote><p>è¯¦ç»†é…ç½®è§ï¼š<a href="/intro/atom.html#hexo">atom-hexoé…ç½®</a></p><h1 id="Hexo-å‘½ä»¤"><a href="#Hexo-å‘½ä»¤" class="headerlink" title="Hexo å‘½ä»¤"></a>Hexo å‘½ä»¤</h1><blockquote><p>è¯¦ç»†å‘½ä»¤æ¸…å•è§ï¼š<kbd><a href="https://hexo.io/zh-cn/docs/commands.html" rel="external nofollow noopener noreferrer" target="_blank">hexo å‘½ä»¤</a></kbd></p></blockquote><h2 id="æ–°å¢æ–‡ç« "><a href="#æ–°å¢æ–‡ç« " class="headerlink" title="æ–°å¢æ–‡ç« "></a>æ–°å¢æ–‡ç« </h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new [layout] &lt;title&gt;</span><br></pre></td></tr></table></figure><h2 id="é¢„è§ˆ"><a href="#é¢„è§ˆ" class="headerlink" title="é¢„è§ˆ"></a>é¢„è§ˆ</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo g</span><br></pre></td></tr></table></figure><h2 id="å®æ—¶æ›´æ–°é¢„è§ˆ"><a href="#å®æ—¶æ›´æ–°é¢„è§ˆ" class="headerlink" title="å®æ—¶æ›´æ–°é¢„è§ˆ"></a>å®æ—¶æ›´æ–°é¢„è§ˆ</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo g -w</span><br></pre></td></tr></table></figure><h2 id="å‘å¸ƒ"><a href="#å‘å¸ƒ" class="headerlink" title="å‘å¸ƒ"></a>å‘å¸ƒ</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo d -g</span><br></pre></td></tr></table></figure><h1 id="è‡ªå®šä¹‰å‘½ä»¤"><a href="#è‡ªå®šä¹‰å‘½ä»¤" class="headerlink" title="è‡ªå®šä¹‰å‘½ä»¤"></a>è‡ªå®šä¹‰å‘½ä»¤</h1><p><strong>é…ç½®</strong></p><p>bash/zsh çš„é…ç½®æ–‡ä»¶ .basrc/.zshrc  å¢åŠ å¦‚ä¸‹å‘½ä»¤</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> BLOG_PATH=<span class="string">"blogçš„ç›®å½•"</span></span><br><span class="line"><span class="built_in">alias</span> blog_root=<span class="string">"cd <span class="variable">$BLOG_PATH</span>/"</span></span><br><span class="line">PATH=<span class="string">"...:<span class="variable">$BLOG_PATH</span>/shell"</span></span><br></pre></td></tr></table></figure><h2 id="è¿›å…¥-Hexo-æ ¹ç›®å½•"><a href="#è¿›å…¥-Hexo-æ ¹ç›®å½•" class="headerlink" title="è¿›å…¥ Hexo æ ¹ç›®å½•"></a>è¿›å…¥ Hexo æ ¹ç›®å½•</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">blog_root</span><br></pre></td></tr></table></figure><h2 id="é¢„è§ˆ-1"><a href="#é¢„è§ˆ-1" class="headerlink" title="é¢„è§ˆ"></a>é¢„è§ˆ</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">blog_preview</span><br></pre></td></tr></table></figure><h2 id="ç”Ÿæˆ-html"><a href="#ç”Ÿæˆ-html" class="headerlink" title="ç”Ÿæˆ html"></a>ç”Ÿæˆ html</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">blog_generate</span><br></pre></td></tr></table></figure><h2 id="å‘å¸ƒ-1"><a href="#å‘å¸ƒ-1" class="headerlink" title="å‘å¸ƒ"></a>å‘å¸ƒ</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">blog_deploy</span><br></pre></td></tr></table></figure><h2 id="æ‰“å¼€-atom"><a href="#æ‰“å¼€-atom" class="headerlink" title="æ‰“å¼€ atom"></a>æ‰“å¼€ atom</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">blog_atom</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css&quot;&gt;&lt;h1 id=&quot;Blog-ç³»ç»Ÿ&quot;&gt;&lt;a href=&quot;#Blog-ç³»ç»Ÿ&quot; class
      
    
    </summary>
    
      <category term="4-å¼€æºè½¯ä»¶" scheme="http://yoursite.com/categories/4-%E5%BC%80%E6%BA%90%E8%BD%AF%E4%BB%B6/"/>
    
    
      <category term="atom" scheme="http://yoursite.com/tags/atom/"/>
    
  </entry>
  
</feed>
